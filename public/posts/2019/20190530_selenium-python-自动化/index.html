<!DOCTYPE html>
<html lang="zh-CN">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Selenium Python 自动化 - 辰深-技术与生活</title><meta name="Description" content=""><meta property="og:url" content="http://localhost:1313/posts/2019/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96/">
  <meta property="og:site_name" content="辰深-技术与生活">
  <meta property="og:title" content="Selenium Python 自动化">
  <meta property="og:description" content="准备工作 安装seleniumm pip install selenium 下载浏览器驱动 Firefox浏览器驱动：geckodriver Chrome浏览器驱动：chromedri">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-05-30T00:00:00+00:00">
    <meta property="article:modified_time" content="2019-05-30T00:00:00+00:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="工具">
<meta name="twitter:card" content="summary"><meta name="twitter:title" content="Selenium Python 自动化">
<meta name="twitter:description" content="准备工作 安装seleniumm pip install selenium 下载浏览器驱动 Firefox浏览器驱动：geckodriver Chrome浏览器驱动：chromedri">
<meta name="application-name" content="Chan">
<meta name="apple-mobile-web-app-title" content="Chan"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js"></script>


<script src="https://kit.fontawesome.com/3682f75126.js" crossorigin="anonymous"></script>

<link rel="icon" href="https://qn.chenzqi.cn/blog/img/logo.png"><link rel="apple-touch-icon" sizes="180x180" href="https://qn.chenzqi.cn/blog/img/apple-touch-icon.png">
    <meta name="apple-mobile-web-app-title" content="Chan的博客">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/posts/2019/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96/" /><link rel="prev" href="http://localhost:1313/posts/2019/20190530_selenium%E5%90%AF%E5%8A%A8chrome%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0/" /><link rel="next" href="http://localhost:1313/posts/2019/20190605_dockerfile-%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Selenium Python 自动化",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/posts\/2019\/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96\/"
        },"genre": "posts","keywords": "python, 工具","wordcount":  2428 ,
        "url": "http:\/\/localhost:1313\/posts\/2019\/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96\/","datePublished": "2019-05-30T00:00:00+00:00","dateModified": "2019-05-30T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "辰深"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="辰深-技术与生活">辰深·<span class="header-title-post"><i class="fa-solid fa-c"></i><i class="fa-solid fa-s" style="color: #B197FC;"></i></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner">
                    <div class="dropdown">
                        <a href="/posts/" class="menu-item menu-more dropbtn" title="归档" ><i class='fas fa-fw fa-archive'></i> 归档 
                        </a>
                        <div class="menu-more-content dropdown-content"><a href="/categories/" title="分类" ><i class='fas fa-fw fa-th'></i> 分类 </a><a href="/tags/" title="标签" ><i class='fas fa-fw fa-tag'></i> 标签 </a></div>
                    </div>
                <a class="menu-item" href="/about/friends/" title="友链"><i class='fas fa-fw fa-fan fa-spin'></i> 友链 
                    </a><a class="menu-item" href="/search/" title="搜索"><i class='fas fa-fw fa-search'></i> 搜索 
                    </a><a class="menu-item" href="/about/photo/" title="相册"><i class='fas fa-fw fa-at'></i> 相册 
                    </a><a class="menu-item" href="/about-me/" title="关于"><i class='fas fa-address-card fa-fw'></i> 关于 
                    </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="辰深-技术与生活">辰深·<span class="header-title-post"><i class="fa-solid fa-c"></i><i class="fa-solid fa-s" style="color: #B197FC;"></i></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="归档"><i class='fas fa-fw fa-archive'></i>归档</a><a class="menu-item" href="/about/friends/" title="友链"><i class='fas fa-fw fa-fan fa-spin'></i>友链</a><a class="menu-item" href="/search/" title="搜索"><i class='fas fa-fw fa-search'></i>搜索</a><a class="menu-item" href="/about/photo/" title="相册"><i class='fas fa-fw fa-at'></i>相册</a><a class="menu-item" href="/about-me/" title="关于"><i class='fas fa-address-card fa-fw'></i>关于</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container">
                    <div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Selenium Python 自动化</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>辰深</a></span>&nbsp;<span class="post-category">included in <a href="/categories/2019/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>2019</a>&nbsp;<a href="/categories/%E6%8A%80%E6%9C%AF/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>技术</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2019-05-30">2019-05-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2428 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#准备工作">准备工作</a></li>
    <li><a href="#元素定位">元素定位</a></li>
    <li><a href="#控制浏览器操作">控制浏览器操作</a></li>
    <li><a href="#webelement常用方法">Webelement常用方法</a></li>
    <li><a href="#鼠标操作">鼠标操作</a></li>
    <li><a href="#键盘事件">键盘事件</a></li>
    <li><a href="#获取断言信息">获取断言信息</a></li>
    <li><a href="#等待页面加载完成">等待页面加载完成</a>
      <ul>
        <li><a href="#显性等待">显性等待</a></li>
        <li><a href="#隐式等待">隐式等待</a></li>
      </ul>
    </li>
    <li><a href="#在不同的窗口和框架之间移动">在不同的窗口和框架之间移动</a></li>
    <li><a href="#警告框处理">警告框处理</a></li>
    <li><a href="#下拉框选择">下拉框选择</a></li>
    <li><a href="#文件上传">文件上传</a></li>
    <li><a href="#cookie操作">cookie操作</a></li>
    <li><a href="#调用javascript代码">调用JavaScript代码</a></li>
    <li><a href="#窗口截图">窗口截图</a></li>
    <li><a href="#关闭浏览器">关闭浏览器</a></li>
    <li><a href="#直接用cookie登录方法">直接用cookie登录方法</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="准备工作">准备工作</h2>
<ol>
<li>安装seleniumm</li>
</ol>
<p><code>pip install selenium</code></p>
<ol start="2">
<li>下载浏览器驱动</li>
</ol>
<p>Firefox浏览器驱动：<a href="https://github.com/mozilla/geckodriver/releases" target="_blank" rel="noopener noreffer ">geckodriver</a></p>
<p>Chrome浏览器驱动：<a href="https://sites.google.com/a/chromium.org/chromedriver/downloads" target="_blank" rel="noopener noreffer ">chromedriver</a> , <a href="https://npm.taobao.org/mirrors/chromedriver" target="_blank" rel="noopener noreffer ">taobao备用地址</a></p>
<p>IE浏览器驱动：<a href="http://selenium-release.storage.googleapis.com/index.html" target="_blank" rel="noopener noreffer ">IEDriverServer</a></p>
<p>Edge浏览器驱动：<a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/" target="_blank" rel="noopener noreffer ">MicrosoftWebDriver</a></p>
<p>Opera浏览器驱动：<a href="https://github.com/operasoftware/operachromiumdriver/releases" target="_blank" rel="noopener noreffer ">operadriver</a></p>
<p>PhantomJS浏览器驱动：<a href="https://phantomjs.org/" target="_blank" rel="noopener noreffer ">phantomjs</a></p>
<p>需要把浏览器驱动放入系统路径中，或者直接告知selenuim的驱动路径</p>
<p>启动浏览器，可以设置一些参数，比如无界面之类的，详细参考：<a href="http://xshanshan.cn/blogs/2019/20190530_selenium%E5%90%AF%E5%8A%A8Chrome%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0.html#%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0" target="_blank" rel="noopener noreffer ">配置参数</a></p>
<p>可以测试是否正常使用:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>   <span class="c1"># Firefox浏览器</span>
</span></span><span class="line"><span class="cl"><span class="c1"># driver = webdriver.Firefox(&#34;驱动路径&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>    <span class="c1"># Chrome浏览器</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Ie</span><span class="p">()</span>        <span class="c1"># Internet Explorer浏览器</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Edge</span><span class="p">()</span>      <span class="c1"># Edge浏览器</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Opera</span><span class="p">()</span>     <span class="c1"># Opera浏览器</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">PhantomJS</span><span class="p">()</span>   <span class="c1"># PhantomJS</span>
</span></span></code></pre></div><h2 id="元素定位">元素定位</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">find_element_by_id</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">find_element_by_name</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">find_element_by_class_name</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">find_element_by_tag_name</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">find_element_by_link_text</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">find_element_by_partial_link_text</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">find_element_by_xpath</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">find_element_by_css_selector</span><span class="p">()</span>
</span></span></code></pre></div><p><strong>在element变成elements就是找所有满足的条件，返回数组。</strong></p>
<h2 id="控制浏览器操作">控制浏览器操作</h2>
<ul>
<li>控制浏览器窗口大小</li>
</ul>
<p><code>driver.set_window_size(480, 800)</code></p>
<ul>
<li>后退</li>
</ul>
<p><code>driver.back()</code></p>
<ul>
<li>前进</li>
</ul>
<p><code>driver.forward()</code></p>
<ul>
<li>刷新
<code>driver.refresh()</code></li>
</ul>
<h2 id="webelement常用方法">Webelement常用方法</h2>
<ul>
<li>点击和输入</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&#34;kw&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span> <span class="c1"># 清除文本 </span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&#34;kw&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&#34;selenium&#34;</span><span class="p">)</span> <span class="c1"># 模拟按键输入 </span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&#34;su&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span> <span class="c1"># 单机元素</span>
</span></span></code></pre></div><ul>
<li>提交
可以在搜索框模拟回车操作</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">search_text</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;kw&#39;</span><span class="p">)</span> <span class="n">search_text</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;selenium&#39;</span><span class="p">)</span> <span class="n">search_text</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</span></span></code></pre></div><ul>
<li>其他</li>
</ul>
<p><strong>size</strong>: 返回元素的尺寸。</p>
<p><strong>text</strong>: 获取元素的文本。</p>
<p><strong>get_attribute(name)</strong>: 获得属性值。</p>
<p><strong>is_displayed()</strong>: 设置该元素是否用户可见。</p>
<h2 id="鼠标操作">鼠标操作</h2>
<p>在 WebDriver 中， 将这些关于鼠标操作的方法封装在 ActionChains 类提供。</p>
<p>ActionChains 类提供了鼠标操作的常用方法：</p>
<p><strong>perform()</strong>： 执行所有 ActionChains 中存储的行为；</p>
<p><strong>context_click()</strong>：  右击；</p>
<p><strong>double_click()</strong>：   双击；</p>
<p><strong>drag_and_drop()</strong>：  拖动；</p>
<p><strong>move_to_element()</strong>：鼠标悬停。</p>
<p>举个例子：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 引入 ActionChains 类</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;https://www.baidu.cn&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 定位到要悬停的元素</span>
</span></span><span class="line"><span class="cl"><span class="n">above</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s2">&#34;设置&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 对定位到的元素执行鼠标悬停操作</span>
</span></span><span class="line"><span class="cl"><span class="n">ActionChains</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span><span class="o">.</span><span class="n">move_to_element</span><span class="p">(</span><span class="n">above</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="键盘事件">键盘事件</h2>
<p>以下为常用的键盘操作：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">BACK_SPACE</span><span class="p">)</span>  <span class="n">删除键</span><span class="err">（</span><span class="n">BackSpace</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">SPACE</span><span class="p">)</span>       <span class="n">空格键</span><span class="p">(</span><span class="n">Space</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">TAB</span><span class="p">)</span>         <span class="n">制表键</span><span class="p">(</span><span class="n">Tab</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ESCAPE</span><span class="p">)</span>      <span class="n">回退键</span><span class="err">（</span><span class="n">Esc</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ENTER</span><span class="p">)</span>       <span class="n">回车键</span><span class="err">（</span><span class="n">Enter</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="n">全选</span><span class="err">（</span><span class="n">Ctrl</span><span class="o">+</span><span class="n">A</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span> <span class="n">复制</span><span class="err">（</span><span class="n">Ctrl</span><span class="o">+</span><span class="n">C</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="n">剪切</span><span class="err">（</span><span class="n">Ctrl</span><span class="o">+</span><span class="n">X</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">)</span> <span class="n">粘贴</span><span class="err">（</span><span class="n">Ctrl</span><span class="o">+</span><span class="n">V</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">F1</span><span class="p">)</span>          <span class="n">键盘</span> <span class="n">F1</span>
</span></span><span class="line"><span class="cl"><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">F12</span><span class="p">)</span>         <span class="n">键盘</span> <span class="n">F12</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 输入框输入内容</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&#34;kw&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&#34;seleniumm&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 删除多输入的一个 m</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&#34;kw&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">BACK_SPACE</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="获取断言信息">获取断言信息</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">title</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>         <span class="c1"># 打印当前页面title</span>
</span></span><span class="line"><span class="cl"><span class="n">now_url</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">current_url</span> <span class="c1"># 打印当前页面URL</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_class_name</span><span class="p">(</span><span class="s1">&#39;nums&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="c1"># 获取结果数目</span>
</span></span></code></pre></div><h2 id="等待页面加载完成">等待页面加载完成</h2>
<h3 id="显性等待">显性等待</h3>
<p>显式等待使WebdDriver等待某个条件成立时继续执行，否则在达到最大时长时抛出超时异常（TimeoutException）。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;http://www.baidu.com&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">element</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                      <span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s2">&#34;kw&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                      <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;selenium&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span></span></code></pre></div><p>WebDriverWait类是由WebDirver 提供的等待方法。在设置时间内，默认每隔一段时间检测一次当前页面元素是否存在，如果超过设置时间检测不到则抛出异常。具体格式如下：</p>
<p><strong><code>WebDriverWait(driver, timeout, poll_frequency=0.5, ignored_exceptions=None)</code></strong></p>
<p><strong>driver</strong>：浏览器驱动。</p>
<p><strong>timeout</strong>：最长超时时间，默认以秒为单位。</p>
<p><strong>poll_frequency</strong>：检测的间隔（步长）时间，默认为0.5S。</p>
<p><strong>ignored_exceptions</strong>：超时后的异常信息，默认情况下抛NoSuchElementException异常。</p>
<p><strong>WebDriverWait()</strong>：一般由until()或until_not()方法配合使用</p>
<p>下面是until()和until_not()方法的说明
<strong>until(method, message=‘’)</strong> 调用该方法提供的驱动程序作为一个参数，直到返回值为True。</p>
<p><strong>until_not(method, message=‘’)</strong> 调用该方法提供的驱动程序作为一个参数，直到返回值为False。</p>
<p>在本例中，通过as关键字将expected_conditions 重命名为EC，并调用**presence_of_element_located()**方法判断元素是否存在。</p>
<h3 id="隐式等待">隐式等待</h3>
<p>如果某些元素不是立即可用的，隐式等待是告诉WebDriver去等待一定的时间后去查找元素。 默认等待时间是0秒，一旦设置该值，隐式等待是设置该WebDriver的实例的生命周期。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>    
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># seconds    </span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;http://somedomain/url_that_delays_loading&#34;</span><span class="p">)</span>    
</span></span><span class="line"><span class="cl"><span class="n">myDynamicElement</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&#34;myDynamicElement&#34;</span><span class="p">)</span> 
</span></span></code></pre></div><h2 id="在不同的窗口和框架之间移动">在不同的窗口和框架之间移动</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">switch_to_window</span><span class="p">(</span><span class="s2">&#34;windowName&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">switch_to_frame</span><span class="p">(</span><span class="s2">&#34;frameName&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>以直接取表单的id 或name属性。如果iframe没有可用的id和name属性，则可以通过下面的方式进行定位。</p>
<pre tabindex="0"><code>#先通过xpth定位到iframe
xf = driver.find_element_by_xpath(&#39;//*[@id=&#34;x-URS-iframe&#34;]&#39;)

#再将定位对象传给switch_to_frame()方法
driver.switch_to_frame(xf)
</code></pre><p>一旦我们完成了frame中的工作，我们可以这样返回父frame:</p>
<pre tabindex="0"><code>driver.switch_to_default_content()
</code></pre><h2 id="警告框处理">警告框处理</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">alert</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">switch_to_alert</span><span class="p">()</span>
</span></span></code></pre></div><p><strong>text</strong>：返回 alert/confirm/prompt 中的文字信息。
<strong>accept()</strong>：接受现有警告框。
<strong>dismiss()</strong>：解散现有警告框。
<strong>send_keys(keysToSend)</strong>：发送文本至警告框。keysToSend：将文本发送至警告框。</p>
<h2 id="下拉框选择">下拉框选择</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">selenium.webdriver.support.select</span> <span class="kn">import</span> <span class="n">Select</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.baidu.com&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sel</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&#34;//select[@id=&#39;nr&#39;]&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Select</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_value</span><span class="p">(</span><span class="s1">&#39;50&#39;</span><span class="p">)</span>  <span class="c1"># 显示50条</span>
</span></span></code></pre></div><h2 id="文件上传">文件上传</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 定位上传按钮，添加本地文件</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s2">&#34;file&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;D:</span><span class="se">\\</span><span class="s1">upload_file.txt&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="cookie操作">cookie操作</h2>
<p>WebDriver操作cookie的方法：</p>
<p><strong>get_cookies()</strong>： 获得所有cookie信息。</p>
<p><strong>get_cookie(name)</strong>： 返回字典的key为“name”的cookie信息。</p>
<p><strong>add_cookie(cookie_dict)</strong> ： 添加cookie。“cookie_dict”指字典对象，必须有name 和value 值。</p>
<p><strong>delete_cookie(name,optionsString)</strong>：删除cookie信息。“name”是要删除的cookie的名称，“optionsString”是该cookie的选项，目前支持的选项包括“路径”，“域”。</p>
<p><strong>delete_all_cookies()</strong>： 删除所有cookie信息</p>
<h2 id="调用javascript代码">调用JavaScript代码</h2>
<p>通过**execute_script()**方法执行JavaScripts代码来移动滚动条的位置。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">js</span><span class="o">=</span><span class="s2">&#34;window.scrollTo(100,450);&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="c1"># 通过javascript设置浏览器窗口的滚动条位置</span>
</span></span></code></pre></div><h2 id="窗口截图">窗口截图</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">driver</span><span class="o">.</span><span class="n">get_screenshot_as_file</span><span class="p">(</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">baidu_img.jpg&#34;</span><span class="p">)</span> <span class="c1"># 截取当前窗口，并指定截图图片的保存位置</span>
</span></span></code></pre></div><h2 id="关闭浏览器">关闭浏览器</h2>
<p><strong>close()</strong> 关闭单个窗口</p>
<p><strong>quit()</strong> 关闭所有窗口</p>
<h2 id="直接用cookie登录方法">直接用cookie登录方法</h2>
<ol>
<li>手动获取网页的cookie，将其序列化并存储在本地</li>
<li>写入代码</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">cookies</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">driver</span><span class="o">.</span><span class="n">add_cookie</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span></span></code></pre></div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2019-05-30</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://localhost:1313/posts/2019/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96/" data-title="Selenium Python 自动化" data-hashtags="python,工具"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/2019/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96/" data-hashtag="python"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/posts/2019/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96/" data-title="Selenium Python 自动化"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://localhost:1313/posts/2019/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96/" data-title="Selenium Python 自动化"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://localhost:1313/posts/2019/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96/" data-title="Selenium Python 自动化"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/python/">Python</a>,&nbsp;<a href="/tags/%E5%B7%A5%E5%85%B7/">工具</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2019/20190530_selenium%E5%90%AF%E5%8A%A8chrome%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0/" class="prev" rel="prev" title="selenium启动Chrome配置参数"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>selenium启动Chrome配置参数</a>
            <a href="/posts/2019/20190605_dockerfile-%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/" class="next" rel="next" title="Dockerfile 命令记录">Dockerfile 命令记录<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container">
            
            <div class="footer-line">
                <span id="run-time"></span>
            </div><div class="footer-line"><a target='_blank'><img style='width: 70px; height: 20px;' src='https://gohugo.io/images/hugo-logo-wide.svg'></a></div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2018 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">辰深</a></span>&nbsp;|&nbsp;<span class="license"><a rel='license external nofollow noopener noreffer' href='https://creativecommons.org/licenses/by-nc/4.0/' target='_blank'>CC BY-NC 4.0</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><a target='_blank' href='https://beian.mps.gov.cn/' style='font-weight:500'>豫ICP备2021019462</a></span></div>
        </div>
    </footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript" src="/js/custom.js"></script></body>
</html>
