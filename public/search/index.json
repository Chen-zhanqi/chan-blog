[{"categories":null,"contents":"\r\u0026#x1f6e0;\u0026#xfe0f; æŠ€æœ¯ è¯­è¨€ æŠ€æœ¯æ ˆ å¼€å‘ç¯å¢ƒ \u0026#x1f5a5;\u0026#xfe0f; è®¾å¤‡ PC ç¡¬ä»¶ è®¾å¤‡ CPU 12th Gen Intel core i5-12490F GPU NVIDIA GeForce RTX 3060Ti é¼ æ ‡ Logitech G304 Lightspeed æ˜¾ç¤ºå™¨ AOCB205 Q24G2 ğŸ§© æŠ€æœ¯é€‰å‹ Blog é¡¹ç›® æ–¹æ¡ˆ æ¡†æ¶ Hugo ä¸»é¢˜ LoveIt - @Dillon VPS é˜¿é‡Œäº‘ ECS CDN ä¸ƒç‰›äº‘ ","permalink":"https://www.chenzqi.cn/about-me/","tags":null,"title":"å…³äºæˆ‘"},{"categories":[2023,"æŠ€æœ¯"],"contents":"æŸ¥çœ‹PHP_VERSION php -v | head -n1 | cut -d\u0026#39; \u0026#39; -f2 | cut -d. -f1-2 å®‰è£… mkdir -p /tmp/sourceguardian \u0026amp;\u0026amp; cd /tmp/sourceguardian curl -Os https://www.sourceguardian.com/loaders/download/loaders.linux-x86_64.tar.gz tar xzf loaders.linux-x86_64.tar.gz cp ixed.${PHP_VERSION}.lin \u0026#34;$(php -i | grep \u0026#39;^extension_dir =\u0026#39; | cut -d\u0026#39; \u0026#39; -f3)/sourceguardian.so\u0026#34; echo \u0026#34;extension=sourceguardian.so\u0026#34; \u0026gt; /usr/local/etc/php/conf.d/15-sourceguardian.ini rm -rf /tmp/sourceguardian é‡å¯å®¹å™¨\u0026amp;éªŒè¯ \u0026lt;?php echo phpinfo(); ","permalink":"https://www.chenzqi.cn/posts/2023/install-the-sg-11-extension-in-the-php-container/","tags":["Docker"],"title":"phpå®¹å™¨å†…å®‰è£…SG11æ‰©å±•"},{"categories":[2023,"æŠ€æœ¯"],"contents":"å¦‚æœæœåŠ¡å™¨ä¸Šæ²¡æœ‰ /etc/timezone æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•æ¥æ›´æ”¹æ—¶åŒºä¸ºä¸Šæµ·ï¼š ä½¿ç”¨ root æˆ–å…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ç™»å½•åˆ°æœåŠ¡å™¨ä¸Šã€‚ è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥æŸ¥çœ‹å½“å‰æ—¶åŒºè®¾ç½®ï¼š timedatectl åœ¨è¾“å‡ºä¸­ï¼Œæ‰¾åˆ° \u0026ldquo;Time zone\u0026rdquo; è¡Œï¼Œè¯¥è¡Œæ˜¾ç¤ºäº†å½“å‰çš„æ—¶åŒºè®¾ç½®ã€‚ è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„æ—¶åŒºï¼š timedatectl list-timezones è¿™å°†æ˜¾ç¤ºä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯ç”¨æ—¶åŒºçš„åˆ—è¡¨ã€‚ æ‰¾åˆ°ä¸Šæµ·æ—¶åŒºçš„åç§°ï¼Œé€šå¸¸ä¸º \u0026ldquo;Asia/Shanghai\u0026rdquo;ã€‚ è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥å°†æœåŠ¡å™¨çš„æ—¶åŒºæ›´æ”¹ä¸ºä¸Šæµ·ï¼š timedatectl set-timezone Asia/Shanghai è¿™å°†æ›´æ”¹æœåŠ¡å™¨çš„æ—¶åŒºè®¾ç½®ä¸ºä¸Šæµ·ã€‚ æœ€åï¼Œæ‚¨å¯ä»¥å†æ¬¡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥éªŒè¯æ—¶åŒºæ˜¯å¦å·²æˆåŠŸæ›´æ”¹ï¼š timedatectl åœ¨è¾“å‡ºä¸­ï¼Œç¡®ä¿ \u0026ldquo;Time zone\u0026rdquo; è¡Œæ˜¾ç¤ºäº†æ–°çš„ä¸Šæµ·æ—¶åŒºè®¾ç½®ã€‚ è¿™äº›å‘½ä»¤å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½æ‰§è¡Œã€‚ ","permalink":"https://www.chenzqi.cn/posts/2023/centos7_changes_the_server_time_zone/","tags":["linux"],"title":"centos7ä¿®æ”¹æœåŠ¡å™¨æ—¶åŒº"},{"categories":[2023,"æŠ€æœ¯"],"contents":"å°†ä¸€ä¸ª MySQL å®¹å™¨ä¸­çš„æ•°æ®åº“æ‹·è´åˆ°å¦ä¸€ä¸ª MySQL å®¹å™¨æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°è¡¨ä¸¢å¤±çš„æƒ…å†µã€‚å¯èƒ½æ˜¯å› ä¸ºæœªæ­£ç¡®åœ°å¯¼å‡ºå’Œå¯¼å…¥è¡¨æ•°æ®ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¯èƒ½çš„åŸå› å’Œè§£å†³æ–¹æ³• æ£€æŸ¥å¯¼å‡ºçš„ SQL æ–‡ä»¶æ˜¯å¦åŒ…å«æ‰€æœ‰è¡¨çš„æ•°æ®ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†æ•°æ®å¯¼å‡ºåˆ° SQL æ–‡ä»¶ä¸­ï¼š mysqldump -u username -p database_name \u0026gt; database_name.sql ç¡®ä¿è¯¥å‘½ä»¤å·²æˆåŠŸå®Œæˆï¼Œå¹¶ä¸”å¯¼å‡ºçš„ SQL æ–‡ä»¶åŒ…å«æ‰€æœ‰è¡¨çš„æ•°æ®ã€‚ æ£€æŸ¥å¯¼å…¥çš„ SQL æ–‡ä»¶æ˜¯å¦æ­£ç¡®ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°† SQL æ–‡ä»¶å¯¼å…¥åˆ°æ–°çš„ MySQL å®¹å™¨ä¸­ï¼š mysql -u username -p database_name \u0026lt; database_name.sql ç¡®ä¿è¯¥å‘½ä»¤å·²æˆåŠŸå®Œæˆï¼Œå¹¶ä¸”æ²¡æœ‰å‡ºç°ä»»ä½•é”™è¯¯ã€‚ æ£€æŸ¥æ–°çš„ MySQL å®¹å™¨ä¸­çš„æ•°æ®åº“æ˜¯å¦ä¸åŸå§‹ MySQL å®¹å™¨ä¸­çš„æ•°æ®åº“å…·æœ‰ç›¸åŒçš„åç§°ã€‚å¦‚æœåç§°ä¸åŒï¼Œåˆ™è¡¨å¯èƒ½æ— æ³•åœ¨æ–°çš„å®¹å™¨ä¸­æ‰¾åˆ°ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ MySQL å®¹å™¨ä¸­æŸ¥çœ‹æ•°æ®åº“åˆ—è¡¨ï¼š mysql -u username -p -e \u0026quot;SHOW DATABASES;\u0026quot; ç¡®ä¿æ–°çš„ MySQL å®¹å™¨ä¸­å­˜åœ¨ä¸åŸå§‹ MySQL å®¹å™¨ä¸­ç›¸åŒåç§°çš„æ•°æ®åº“ã€‚ æ£€æŸ¥æ–°çš„ MySQL å®¹å™¨ä¸­çš„ç”¨æˆ·æƒé™æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœæ–°çš„å®¹å™¨ä¸­çš„ç”¨æˆ·æ²¡æœ‰è®¿é—®æ‰€æœ‰è¡¨çš„æƒé™ï¼Œåˆ™å¯èƒ½æ— æ³•çœ‹åˆ°æ‰€æœ‰è¡¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ MySQL å®¹å™¨ä¸­æŸ¥çœ‹ç”¨æˆ·æƒé™ï¼š mysql -u username -p -e \u0026quot;SHOW GRANTS FOR 'user';\u0026quot; ç¡®ä¿æ–°çš„ MySQL å®¹å™¨ä¸­çš„ç”¨æˆ·å…·æœ‰è®¿é—®æ‰€æœ‰è¡¨çš„æƒé™ã€‚ ","permalink":"https://www.chenzqi.cn/posts/2023/database-migration-between-mysql_docker-containers/","tags":["Docker"],"title":"mysql_dockerå®¹å™¨ä¹‹é—´æ•°æ®åº“è¿ç§»"},{"categories":[2023,"æŠ€æœ¯"],"contents":"sudo rm -Rf /Applications/Navicat\\ Premium.app sudo rm -Rf /private/var/db/BootCaches/CB6F12B3-2C14-461E-B5A7-A8621B7FF130/app.com.prect.NavicatPremium.playlist sudo rm -Rf ~/Library/Caches/com.apple.helpd/SDMHelpData/Other/English/HelpSDMIndexFile/com.prect.NavicatPremium.help sudo rm -Rf ~/Library/Caches/com.apple.helpd/SDMHelpData/Other/zh_CN/HelpSDMIndexFile/com.prect.NavicatPremium.help sudo rm -Rf ~/Library/Preferences/com.prect.NavicatPremium.plist sudo rm -Rf ~/Library/Application\\ Support/CrashReporter/Navicat\\ Premium_54EDA2E9-528D-5778-A528-BBF9A4CE8BDC.plist sudo rm -Rf ~/Library/Application\\ Support/PremiumSoft\\ CyberTech ","permalink":"https://www.chenzqi.cn/posts/2023/macdeletes-residual-navicat-configuration-file/","tags":["Docker"],"title":"macæ¸…é™¤navicatæ®‹ç•™é…ç½®æ–‡ä»¶"},{"categories":[2023,"æŠ€æœ¯"],"contents":"treeç»“æ„ docker\râ”œâ”€â”€ compose\râ”‚Â â”œâ”€â”€ db\râ”‚Â â””â”€â”€ nginx\râ”œâ”€â”€ mysql\râ”‚Â â”œâ”€â”€ data\râ”‚Â â””â”€â”€ my.cnf\râ”œâ”€â”€ nginx\râ”‚Â â”œâ”€â”€ conf.d\râ”‚Â â”œâ”€â”€ etc\râ”‚Â â”œâ”€â”€ html\râ”‚Â â”œâ”€â”€ logs\râ”‚Â â”œâ”€â”€ nginx.conf\râ”‚Â â””â”€â”€ www\râ””â”€â”€ redis\râ”‚Â â”œâ”€â”€ data\râ”‚Â â””â”€â”€ redis.conf\râ”œâ”€â”€ postgresql\râ”‚Â â””â”€â”€ data docker-compose.yml services: nginx: restart: always container_name: nginx image: nginx ports: - 80:80 - 443:443 volumes: - /opt/docker/nginx/html:/usr/share/nginx/html - /opt/docker/nginx/www:/var/www - /opt/docker/nginx/logs:/var/log/nginx - /opt/docker/nginx/nginx.conf/:/etc/nginx/nginx.conf - /opt/docker/nginx/etc/cert:/etc/nginx/cert - /opt/docker/nginx/conf.d:/etc/nginx/conf.d environment: - NGINX_PORT=80 - TZ=Asia/Shanghai privileged: true mysql: hostname: mysql image: mysql:5.7.16 container_name: mysql restart: always environment: - TZ=Asia/Shanghai - MYSQL_ROOT_PASSWORD=123456 - MYSQL_USER=root - MYSQL_PASSWORD=123456 volumes: - /etc/localtime:/etc/localtime:ro - /opt/docker/mysql/data:/var/lib/mysql - /opt/docker/mysql/my.cnf:/etc/mysql/my.cnf ports: - \u0026#34;3306:3306\u0026#34; privileged: true redis: hostname: redis image: redis container_name: redis restart: always command: redis-server /etc/redis.conf --appendonly yes environment: - TZ=Asia/Shanghai volumes: - /etc/localtime:/etc/localtime:ro - /opt/docker/redis/data:/data - /opt/docker/redis/redis.conf:/etc/redis.conf ports: - \u0026#34;6379:6379\u0026#34; privileged: true postgres: image: postgres:12-alpine container_name: postgres restart: always environment: - POSTGRES_USER=root - POSTGRES_PASSWORD=123456 ports: - \u0026#34;5432:5432\u0026#34; volumes: - /opt/docker/postgresql/data:/var/lib/postgresql/data privileged: true nginx \u0026gt; nginx.conf user nginx; worker_processes auto; error_log /var/log/nginx/error.log notice; pid /var/run/nginx.pid; events { worker_connections 1024; } http { include /etc/nginx/mime.types; default_type application/octet-stream; log_format main \u0026#39;$remote_addr - $remote_user [$time_local] \u0026#34;$request\u0026#34; \u0026#39; \u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39; \u0026#39;\u0026#34;$http_user_agent\u0026#34; \u0026#34;$http_x_forwarded_for\u0026#34;\u0026#39;; access_log /var/log/nginx/access.log main; sendfile on; #tcp_nopush on; keepalive_timeout 65; #gzip on; include /etc/nginx/conf.d/*.conf; } mysql \u0026gt; my.cnf [mysqld] user=mysql default-storage-engine=INNODB character-set-server=utf8 explicit_defaults_for_timestamp=1 [client] default-character-set=utf8 [mysql] default-character-set=utf8 redis \u0026gt; redis.conf å„ç‰ˆæœ¬é…ç½®æ–‡ä»¶ cd /opt/docker/redis/ wget https://raw.githubusercontent.com/redis/redis/6.0/redis.conf # å°†å¦‚ä¸‹ä¿®æ”¹ä¸º0.0.0.0ï¼Œå¦åˆ™åªèƒ½æœ¬åœ°è®¿é—® # bind 127.0.0.1 -::1 bind 0.0.0.0 # å°†å¦‚ä¸‹é…ç½®ä¿®æ”¹ä¸ºnoï¼Œå…è®¸æ¥è‡ªä»»æ„ä¸»æœºçš„è¿æ¥ # protected-mode yes protected-mode no # è®¾ç½®å¯†ç  # requirepass foobared requirepass xxxxxxxx # æŒä¹…åŒ– appendonly yes # ä½¿ç”¨docker -d æ—¶è®¾ç½®ä¸ºnoï¼Œå¦åˆ™å†²çª daemonize no ","permalink":"https://www.chenzqi.cn/posts/2023/docker-installs-nginx-redis-mysql-postgres/","tags":["Docker"],"title":"docker-composeå®‰è£…nginx,mysql,redis,postgres"},{"categories":[2023,"æŠ€æœ¯"],"contents":"ç½‘é¡µç‰ˆä½“éªŒ å¾®ä¿¡å°ç¨‹åºä½“éªŒ å¦‚æœæ²¡æœ‰ç¼–ç¨‹åŸºç¡€ï¼Œå¯ä»¥ç›´æ¥WXæ‰«ç ä½¿ç”¨å°è£…å¥½ChatGPTçš„å°ç¨‹åºä½“éªŒ 1. OpenAIè´¦å·æ³¨å†Œ OpenAIæ³¨å†Œåœ°å€éœ€è¦ä¼šç¿»å¢™ï¼Œè™šæ‹Ÿæ‰‹æœºå·æ¥ç ã€‚åˆ›å»ºå®Œè´¦å·åˆ™å‰å¾€ APIç®¡ç†é¡µé¢åˆ›å»ºä¸€ä¸ª API Key å¹¶ä¿å­˜ä¸‹æ¥ï¼Œåé¢éœ€è¦åœ¨é¡¹ç›®ä¸­é…ç½®è¿™ä¸ªkey 2.è¿åŠ¨ç¯å¢ƒ æ”¯æŒLinuxã€MacOSã€Windowsç³»ç»Ÿï¼ˆå¯åœ¨LinuxæœåŠ¡å™¨ä¸Šé•¿æœŸè¿è¡Œï¼‰ï¼ŒåŒæ—¶éœ€è¦å®‰è£…Pythonã€‚ 1.å…‹éš†é¡¹ç›®ä»£ç ï¼š git clone https://github.com/Chen-zhanqi/chatgpt-on-wechat.git cd chatgpt-on-wechat/ 2.å®‰è£…æ‰€éœ€æ ¸å¿ƒä¾èµ–ï¼š pip3 install itchat-uos==1.5.0.dev0 pip3 install --upgrade openai æ³¨ï¼šitchat-uosä½¿ç”¨æŒ‡å®šç‰ˆæœ¬1.5.0.dev0ï¼Œopenaiä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼Œéœ€é«˜äº0.25.0ã€‚ 3. é…ç½® é…ç½®æ–‡ä»¶çš„æ¨¡æ¿åœ¨æ ¹ç›®å½•çš„config-template.jsonä¸­ï¼Œéœ€å¤åˆ¶è¯¥æ¨¡æ¿åˆ›å»ºæœ€ç»ˆç”Ÿæ•ˆçš„ config.json æ–‡ä»¶ï¼š cp config-template.json config.json ç„¶ååœ¨config.jsonä¸­å¡«å…¥é…ç½®ï¼Œä»¥ä¸‹æ˜¯å¯¹é»˜è®¤é…ç½®çš„è¯´æ˜ï¼Œå¯æ ¹æ®éœ€è¦è¿›è¡Œè‡ªå®šä¹‰ä¿®æ”¹ï¼š # config.jsonæ–‡ä»¶å†…å®¹ç¤ºä¾‹ { \u0026#34;open_ai_api_key\u0026#34;: \u0026#34;YOUR API KEY\u0026#34;, # å¡«å…¥ä¸Šé¢åˆ›å»ºçš„ OpenAI API KEY \u0026#34;single_chat_prefix\u0026#34;: [\u0026#34;bot\u0026#34;, \u0026#34;@bot\u0026#34;], # ç§èŠæ—¶æ–‡æœ¬éœ€è¦åŒ…å«è¯¥å‰ç¼€æ‰èƒ½è§¦å‘æœºå™¨äººå›å¤ \u0026#34;single_chat_reply_prefix\u0026#34;: \u0026#34;[bot] \u0026#34;, # ç§èŠæ—¶è‡ªåŠ¨å›å¤çš„å‰ç¼€ï¼Œç”¨äºåŒºåˆ†çœŸäºº \u0026#34;group_chat_prefix\u0026#34;: [\u0026#34;@bot\u0026#34;], # ç¾¤èŠæ—¶åŒ…å«è¯¥å‰ç¼€åˆ™ä¼šè§¦å‘æœºå™¨äººå›å¤ \u0026#34;group_name_white_list\u0026#34;: [\u0026#34;ChatGPTæµ‹è¯•ç¾¤\u0026#34;, \u0026#34;ChatGPTæµ‹è¯•ç¾¤2\u0026#34;], # å¼€å¯è‡ªåŠ¨å›å¤çš„ç¾¤åç§°åˆ—è¡¨ \u0026#34;image_create_prefix\u0026#34;: [\u0026#34;ç”»\u0026#34;, \u0026#34;çœ‹\u0026#34;, \u0026#34;æ‰¾\u0026#34;], # å¼€å¯å›¾ç‰‡å›å¤çš„å‰ç¼€ \u0026#34;conversation_max_tokens\u0026#34;: 1000, # æ”¯æŒä¸Šä¸‹æ–‡è®°å¿†çš„æœ€å¤šå­—ç¬¦æ•° \u0026#34;character_desc\u0026#34;: \u0026#34;ä½ æ˜¯ChatGPT, ä¸€ä¸ªç”±OpenAIè®­ç»ƒçš„å¤§å‹è¯­è¨€æ¨¡å‹, ä½ æ—¨åœ¨å›ç­”å¹¶è§£å†³äººä»¬çš„ä»»ä½•é—®é¢˜ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å¤šç§è¯­è¨€ä¸äººäº¤æµã€‚\u0026#34; # äººæ ¼æè¿° } é…ç½®è¯´æ˜ï¼š 1.ä¸ªäººèŠå¤© ä¸ªäººèŠå¤©ä¸­ï¼Œéœ€è¦ä»¥ \u0026ldquo;bot\u0026quot;æˆ–\u0026rdquo;@bot\u0026quot; ä¸ºå¼€å¤´çš„å†…å®¹è§¦å‘æœºå™¨äººï¼Œå¯¹åº”é…ç½®é¡¹ single_chat_prefix (å¦‚æœä¸éœ€è¦ä»¥å‰ç¼€è§¦å‘å¯ä»¥å¡«å†™ \u0026quot;single_chat_prefix\u0026quot;: [\u0026quot;\u0026quot;]) æœºå™¨äººå›å¤çš„å†…å®¹ä¼šä»¥ \u0026ldquo;[bot] \u0026quot; ä½œä¸ºå‰ç¼€ï¼Œ ä»¥åŒºåˆ†çœŸäººï¼Œå¯¹åº”çš„é…ç½®é¡¹ä¸º single_chat_reply_prefix (å¦‚æœä¸éœ€è¦å‰ç¼€å¯ä»¥å¡«å†™ \u0026quot;single_chat_reply_prefix\u0026quot;: \u0026quot;\u0026quot;) 2.ç¾¤ç»„èŠå¤© ç¾¤ç»„èŠå¤©ä¸­ï¼Œç¾¤åç§°éœ€é…ç½®åœ¨ group_name_white_list ä¸­æ‰èƒ½å¼€å¯ç¾¤èŠè‡ªåŠ¨å›å¤ã€‚å¦‚æœæƒ³å¯¹æ‰€æœ‰ç¾¤èŠç”Ÿæ•ˆï¼Œå¯ä»¥ç›´æ¥å¡«å†™ \u0026quot;group_name_white_list\u0026quot;: [\u0026quot;ALL_GROUP\u0026quot;] é»˜è®¤åªè¦è¢«äºº @ å°±ä¼šè§¦å‘æœºå™¨äººè‡ªåŠ¨å›å¤ï¼›å¦å¤–ç¾¤èŠå¤©ä¸­åªè¦æ£€æµ‹åˆ°ä»¥ \u0026ldquo;@bot\u0026rdquo; å¼€å¤´çš„å†…å®¹ï¼ŒåŒæ ·ä¼šè‡ªåŠ¨å›å¤ï¼ˆæ–¹ä¾¿è‡ªå·±è§¦å‘ï¼‰ï¼Œè¿™å¯¹åº”é…ç½®é¡¹ group_chat_prefix å¯é€‰é…ç½®: group_name_keyword_white_listé…ç½®é¡¹æ”¯æŒæ¨¡ç³ŠåŒ¹é…ç¾¤åç§°ï¼Œgroup_chat_keywordé…ç½®é¡¹åˆ™æ”¯æŒæ¨¡ç³ŠåŒ¹é…ç¾¤æ¶ˆæ¯å†…å®¹ï¼Œç”¨æ³•ä¸ä¸Šè¿°ä¸¤ä¸ªé…ç½®é¡¹ç›¸åŒã€‚ 3.å…¶ä»–é…ç½® å¯¹äºå›¾åƒç”Ÿæˆï¼Œåœ¨æ»¡è¶³ä¸ªäººæˆ–ç¾¤ç»„è§¦å‘æ¡ä»¶å¤–ï¼Œè¿˜éœ€è¦é¢å¤–çš„å…³é”®è¯å‰ç¼€æ¥è§¦å‘ï¼Œå¯¹åº”é…ç½® image_create_prefix å…³äºOpenAIå¯¹è¯åŠå›¾ç‰‡æ¥å£çš„å‚æ•°é…ç½®ï¼ˆå†…å®¹è‡ªç”±åº¦ã€å›å¤å­—æ•°é™åˆ¶ã€å›¾ç‰‡å¤§å°ç­‰ï¼‰ï¼Œå¯ä»¥å‚è€ƒ å¯¹è¯æ¥å£ å’Œ å›¾åƒæ¥å£ æ–‡æ¡£ç›´æ¥åœ¨bot/openai/open_ai_bot.py ä¸­è¿›è¡Œè°ƒæ•´ã€‚ conversation_max_tokensï¼šè¡¨ç¤ºèƒ½å¤Ÿè®°å¿†çš„ä¸Šä¸‹æ–‡æœ€å¤§å­—æ•°ï¼ˆä¸€é—®ä¸€ç­”ä¸ºä¸€ç»„å¯¹è¯ï¼Œå¦‚æœç´¯ç§¯çš„å¯¹è¯å­—æ•°è¶…å‡ºé™åˆ¶ï¼Œå°±ä¼šä¼˜å…ˆç§»é™¤æœ€æ—©çš„ä¸€ç»„å¯¹è¯ï¼‰ character_desc é…ç½®ä¸­ä¿å­˜ç€ä½ å¯¹æœºå™¨äººè¯´çš„ä¸€æ®µè¯ï¼Œä»–ä¼šè®°ä½è¿™æ®µè¯å¹¶ä½œä¸ºä»–çš„è®¾å®šï¼Œä½ å¯ä»¥ä¸ºä»–å®šåˆ¶ä»»ä½•äººæ ¼ 4.è¿è¡Œ 1.æœ¬åœ°è¿è¡Œï¼Œç›´æ¥åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼š python3 app.py ç»ˆç«¯è¾“å‡ºäºŒç»´ç åï¼Œä½¿ç”¨å¾®ä¿¡è¿›è¡Œæ‰«ç ï¼Œå½“è¾“å‡º \u0026ldquo;Start auto replying\u0026rdquo; æ—¶è¡¨ç¤ºè‡ªåŠ¨å›å¤ç¨‹åºå·²ç»æˆåŠŸè¿è¡Œäº†ï¼ˆæ³¨æ„ï¼šç”¨äºç™»å½•çš„å¾®ä¿¡éœ€è¦åœ¨æ”¯ä»˜å¤„å·²å®Œæˆå®åè®¤è¯ï¼‰ã€‚æ‰«ç ç™»å½•åä½ çš„è´¦å·å°±æˆä¸ºæœºå™¨äººäº†ï¼Œå¯ä»¥åœ¨å¾®ä¿¡æ‰‹æœºç«¯é€šè¿‡é…ç½®çš„å…³é”®è¯è§¦å‘è‡ªåŠ¨å›å¤ (ä»»æ„å¥½å‹å‘é€æ¶ˆæ¯ç»™ä½ ï¼Œæˆ–æ˜¯è‡ªå·±å‘æ¶ˆæ¯ç»™å¥½å‹)ï¼Œä¸‹å›¾è¡¨ç¤ºç™»å½•æˆåŠŸã€‚ æ›´æ–° 2023.3.15 æœ¬åœ°æ­£å¸¸è¿è¡Œï¼Œå›½å†…ä¸Šä¸ªæœˆå¼€å§‹æ— æ³•è®¿é—®openaiåŸŸåäº†ï¼Œæ‰€ä»¥éœ€è¦å¼€ä»£ç†ï¼Œä¸ç„¶ä¼šæœ‰ æˆ‘æ— æ³•è®¿é—®ä½ çš„ç½‘ç»œ ç­‰é”™è¯¯æç¤ºã€‚ å¾®ä¿¡å›¾ï¼š åç«¯è¿è¡Œï¼š ","permalink":"https://www.chenzqi.cn/posts/2023/chatgpt%E6%8E%A5%E5%85%A5%E5%BE%AE%E4%BF%A1%E6%9C%BA%E5%99%A8%E4%BA%BA/","tags":["chatgpt","ai"],"title":"ChatGPTæ¥å…¥å¾®ä¿¡æœºå™¨äºº"},{"categories":[2022,"æŠ€æœ¯"],"contents":" åœºæ™¯ macbookå‡çº§åˆ°macos big sur 11.7.6ï¼Œgit cloneã€pushç›¸å…³å‘½ä»¤çªç„¶æŠ¥é”™:kex_exchange_identification: Connection closed by remote host è§£å†³ï¼š æŸ¥çœ‹sshæœåŠ¡æ˜¯å¦å¯åŠ¨ sudo systemsetup -getremotelogin å¯åŠ¨çŠ¶æ€ï¼šè¾“å‡ºåº”ä¸ºâ€œRemote Login: Onâ€ æœªå¯ç”¨çŠ¶æ€ï¼Œåˆ™è¾“å‡ºåº”ä¸ºâ€œRemote Login: Offâ€ å¯åŠ¨ sudo systemsetup -setremotelogin on ~/.ssh/config æ–‡ä»¶ä¸­åŠ å…¥ï¼š Host monster HostName github.com PreferredAuthentications publickey IdentityFile ~/.ssh/id_rsa # å…¶ä¸­Host åçš„åå­—å¯ä»¥éšæ„æ–¹ä¾¿è‡ªå·±è®°å¿†ï¼Œä½†HostNameå¿…é¡»ä¸ºgithub.comã€‚ ç›¸å…³å‘½ä»¤ #è°ƒè¯•ï¼Œçœ‹æ‰“å°è¾“å‡ºçš„ä»€ä¹ˆï¼Œå†æ¥è§£å†³å…·ä½“é—®é¢˜ ssh -v git@github.com #æµ‹è¯•ï¼Œè¿æ¥å°±æ­£å¸¸äº† ssh -T git@github.com ","permalink":"https://www.chenzqi.cn/posts/2022/macos%E5%8D%87%E7%BA%A7%E5%90%8Egit%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E9%94%99%E8%AF%AF/","tags":["è®°å½•","é—®é¢˜"],"title":"macoså‡çº§ågitç›¸å…³å‘½ä»¤é”™è¯¯"},{"categories":[2022,"æŠ€æœ¯"],"contents":"cs gocron web\u0026amp;node gocron-web nohup ./gocron-linux-amd64/gocron web \u0026gt; /opt/server/gocron/log/gocron_web.log 2\u0026gt;\u0026amp;1 \u0026amp; gocron-node nohup sudo -u gocron ./gocron-node-linux-amd64/gocron-node \u0026gt; /opt/server/gocron/log/gocron_node.log 2\u0026gt;\u0026amp;1 \u0026amp; cs web vue cd /opt/docker/nginx/html/gin-web/ git pull docker restart nginx cs server gin cd /opt/server/gin-server git pull ps -ax | grep go kill *** nohup go run . \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp; cs cccf-spider cd /opt/server/cccf-spider git pull ","permalink":"https://www.chenzqi.cn/posts/2022/cs%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/","tags":["golang","è®°å½•"],"title":"CSç³»ç»Ÿç›¸å…³"},{"categories":[2022,"æŠ€æœ¯"],"contents":"å¤‡ä»½è„šæœ¬ #!/bin/sh # å¤‡ä»½å­˜æ”¾ä½ç½® BACKUP_DIR=/data/backup/pg/ file=$BACKUP_DIR\u0026#34;gin_server_$(date +\u0026#34;%Y%m%d\u0026#34;).sql\u0026#34; docker exec -t postgres pg_dump -U pq_user -d db_name \u0026gt; \u0026#34;${file}\u0026#34; # åˆ é™¤7å¤©ä¹‹å‰çš„å¤‡ä»½ deleteDIR=$BACKUP_DIR\u0026#34;gin_server_$(date --date=\u0026#39;7 day ago\u0026#39; +%Y%m%d).sql\u0026#34; rm -rf $deleteDIR æ¢å¤æ•°æ® æ­£å¼æ•°æ®åº“ cat gin_server_20190801.sql| docker exec -i postgres psql -U pq_user å…¶ä»–æ•°æ®åº“ åˆ›å»ºæ•°æ®åº“ create database dbname_prod_bak_20190722 owner username; grant all privileges on database dbname_prod_bak_20190722 to username; æ¢å¤æ•°æ® cat gin_server_20190801.sql| docker exec -i postgres psql -U username -d dbname_prod_bak_20190722 ","permalink":"https://www.chenzqi.cn/posts/2022/docker-postgresql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/","tags":["docker","æ•°æ®åº“"],"title":"docker-postgresqlæ•°æ®åº“å¤‡ä»½ä¸æ¢å¤"},{"categories":[2022,"æŠ€æœ¯"],"contents":"å¸¸ç”¨æ“ä½œ dockerå®¹å™¨ä¸‹çš„PHPæœ‰è‡ªå·±ç‰¹æœ‰çš„å®‰è£…æ‰©å±•æ–¹æ³•ï¼š è¿›å…¥phpå®¹å™¨$ï¼šdocker exec -it php /bin/bash docker-php-sourceï¼š //åœ¨å®¹å™¨ä¸­åˆ›å»º/usr/src/phpæ–‡ä»¶å¤¹ docker-php-ext-installï¼š //å®‰è£…å¹¶å¯åŠ¨æ‰©å±•ï¼ˆå¸¸ç”¨ï¼‰ docker-php-ext-enableï¼š //å¯åŠ¨PHPæ‰©å±• docker-php-ext-configureï¼š //æ·»åŠ æ‰©å±•è‡ªå®šä¹‰é…ç½®ï¼Œå’Œenableæ­é…ä½¿ç”¨ zip å®‰è£…zipæ‰©å±•æ‰€éœ€çš„ä¾èµ–æ‰©å±• apt-get update \u0026amp;\u0026amp; apt-get install -y zlib1g-dev \u0026amp;\u0026amp; apt-get install -y libzip-dev å®‰è£…å¹¶å¯åŠ¨zipæ‰©å±• docker-php-ext-install zip pdo_mysql docker-php-ext-install pdo pdo_mysql å¦‚æœå®‰è£…å¤±è´¥å‡ºç°ä¸‹é¢æƒ…å†µ /usr/local/bin/docker-php-ext-enable: cannot create /usr/local/etc/php/conf.d/docker-php-ext-pdo_mysql.ini: Directory nonexistentÂ è§£å†³æ–¹æ¡ˆï¼š åœ¨/usr/local/etc/phpç›®å½•ä¸‹é¢æ–°å»º conf.d ä¹Ÿå¯ä»¥æŠŠ docker-php-ext-pdo_mysql.ini æ–‡ä»¶ä¹Ÿåˆ›å»ºäº†ï¼Œæ–‡ä»¶å†…å®¹ï¼š extension=pdo_mysql.so ä¿®æ”¹å®Œé‡æ–°å®‰è£…ã€‚ gd ç›¸å…³æŠ¥é”™ Call to undefined function think\\captcha\\imagecreate() è¯´æ˜ç¼ºå°‘gdæ‰©å±• å®‰è£…ä¾èµ–åº“ apt install -y libwebp-dev libjpeg-dev libpng-dev libfreetype6-dev è§£å‹æºç  docker-php-source extract é…ç½®ç¼–è¯‘ç¯å¢ƒ docker-php-ext-configure gd --with-webp-dir=/usr/include/webp --with-jpeg-dir=/usr/include --with-png-dir=/usr/include --with-freetype-dir=/usr/include/freetype2 ç¼–è¯‘å®‰è£… docker-php-ext-install gd æŸ¥çœ‹ç»“æœ php -m | grep gd redis pecl seach redis #æ£€ç´¢redisæ‰©å±• pecl install redis #å®‰è£… docker-php-ext-enable redis.so #å®‰è£…å®Œæˆå°†redis.so æ–‡ä»¶åŠ å…¥åˆ°é…ç½®æ–‡ä»¶ php -m #æŸ¥çœ‹redisæ‰©å±•å°±æœ‰äº† ","permalink":"https://www.chenzqi.cn/posts/2022/docker%E5%AE%B9%E5%99%A8%E4%B8%8Bphp%E6%89%A9%E5%B1%95%E6%93%8D%E4%BD%9C/","tags":["docker"],"title":"Dockerå®¹å™¨ä¸‹PHPæ‰©å±•æ“ä½œ"},{"categories":[2022,"æŠ€æœ¯"],"contents":" é‡‡ç”¨ä¸¤çº§ channelï¼Œä¸€çº§æ˜¯å°†ç”¨æˆ·è¯·æ±‚æ•°æ®æ”¾å…¥åˆ° chan Job ä¸­ï¼Œè¿™ä¸ª channel job ç›¸å½“äºå¾…å¤„ç†çš„ä»»åŠ¡é˜Ÿåˆ—ã€‚ å¦ä¸€çº§ç”¨æ¥å­˜æ”¾å¯ä»¥å¤„ç†ä»»åŠ¡çš„ work ç¼“å­˜é˜Ÿåˆ—ï¼Œç±»å‹ä¸º chan chan Jobã€‚è°ƒåº¦å™¨æŠŠå¾…å¤„ç†çš„ä»»åŠ¡æ”¾å…¥ä¸€ä¸ªç©ºé—²çš„ç¼“å­˜é˜Ÿåˆ—å½“ä¸­ï¼Œwork ä¼šä¸€ç›´å¤„ç†å®ƒçš„ç¼“å­˜é˜Ÿåˆ—ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå®ç°äº†ä¸€ä¸ª worker æ± ã€‚ è¯·æ±‚: æŠŠä»»åŠ¡æ”¾å…¥JobQueue package main import ( \u0026#34;fmt\u0026#34; \u0026#34;log\u0026#34; \u0026#34;net/http\u0026#34; \u0026#34;time\u0026#34; ) const ( MaxWorker = 100 // éšä¾¿è®¾ç½®å€¼ MaxQueue = 200 // éšä¾¿è®¾ç½®å€¼ ) // ä¸€ä¸ªå¯ä»¥å‘é€å·¥ä½œè¯·æ±‚çš„ç¼“å†² channel var JobQueue chan Job func init() { JobQueue = make(chan Job, MaxQueue) } type Payload struct{} type Job struct { PayLoad Payload } // æ¥æ”¶è¯·æ±‚ï¼ŒæŠŠä»»åŠ¡ç­›å…¥JobQueueã€‚ func payloadHandler(w http.ResponseWriter, r *http.Request) { work := Job{PayLoad: Payload{}} JobQueue \u0026lt;- work _, _ = w.Write([]byte(\u0026#34;æ“ä½œæˆåŠŸ\u0026#34;)) } func main() { // é€šè¿‡è°ƒåº¦å™¨åˆ›å»ºworkerï¼Œç›‘å¬æ¥è‡ª JobQueueçš„ä»»åŠ¡ d := NewDispatcher() d.Run() http.HandleFunc(\u0026#34;/payload\u0026#34;, payloadHandler) log.Fatal(http.ListenAndServe(\u0026#34;:8099\u0026#34;, nil)) } Dispatcherè°ƒåº¦å™¨ï¼šå¾ªç¯è¯»å–JobQueue ä¸€ä¸ªDispatcher ç®¡ç† å¤šä¸ªWorker package main // åˆå§‹åŒ–æ“ä½œ type Dispatcher struct { WorkerPool chan chan Job } func NewDispatcher() *Dispatcher { pool := make(chan chan Job, MaxWorker) return \u0026amp;Dispatcher{WorkerPool: pool} } func (d *Dispatcher) Run() { // 1. å¼€å§‹è¿è¡Œ n ä¸ª worker for i := 0; i \u0026lt; MaxWorker; i++ { worker := NewWorker(d.WorkerPool) worker.Start() } // 2. å¾ªç¯è¯»å–JobQueueï¼Œéšæœºé€‰å–ä¸€ä¸ªWorkeræ‰§è¡Œä»»åŠ¡ go d.dispatch() } func (d *Dispatcher) dispatch() { for { select { case job := \u0026lt;-JobQueue: go func(job Job) { // é˜»å¡ç›´åˆ°è·å–ä¸€ä¸ªå¯ç”¨çš„worker job channel jobChannel := \u0026lt;-d.WorkerPool // åˆ†å‘ä»»åŠ¡åˆ° worker job channel ä¸­ jobChannel \u0026lt;- job }(job) } } } Worker: ä»Dispatcherè·å–ä»»åŠ¡ type Worker struct { WorkerPool chan chan Job JobChannel chan Job quit chan bool } func NewWorker(workerPool chan chan Job) Worker { return Worker{ WorkerPool: workerPool, JobChannel: make(chan Job), quit: make(chan bool), } } // å¼€å¯ä¸€ä¸ª worker å¾ªç¯ç›‘å¬æˆ–é€€å‡ºchannel func (w Worker) Start() { go func() { for { // å°†å½“å‰çš„ worker æ³¨å†Œåˆ° worker é˜Ÿåˆ—ä¸­ w.WorkerPool \u0026lt;- w.JobChannel select { case job := \u0026lt;-w.JobChannel: // çœŸæ­£ä¸šåŠ¡çš„åœ°æ–¹,æ¨¡æ‹Ÿæ“ä½œè€—æ—¶ time.Sleep(500 * time.Millisecond) fmt.Printf(\u0026#34;ä¸Šä¼ æˆåŠŸ:%v\\n\u0026#34;, job) case \u0026lt;-w.quit: return } } }() } func (w Worker) stop() { go func() { w.quit \u0026lt;- true }() } æ¥æº ","permalink":"https://www.chenzqi.cn/posts/2022/golang-%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%E9%AB%98%E5%B9%B6%E5%8F%91/","tags":["golang"],"title":"Golang æ¥å£è¯·æ±‚é«˜å¹¶å‘"},{"categories":[2022,"æŠ€æœ¯"],"contents":"Nginx å¯¹äºå¤„ç†é™æ€æ–‡ä»¶çš„æ•ˆç‡è¦è¿œé«˜äº Web æ¡†æ¶ï¼Œå› ä¸ºå¯ä»¥ä½¿ç”¨ gzip å‹ç¼©åè®®ï¼Œå‡å°é™æ€æ–‡ä»¶çš„ä½“ç§¯åŠ å¿«é™æ€æ–‡ä»¶çš„åŠ è½½é€Ÿåº¦ã€å¼€å¯ç¼“å­˜å’Œè¶…æ—¶æ—¶é—´å‡å°‘è¯·æ±‚é™æ€æ–‡ä»¶æ¬¡æ•°ã€‚ ä¸€ å¼€å¯ gzip gzip on; #è¯¥æŒ‡ä»¤ç”¨äºå¼€å¯æˆ–å…³é—­gzipæ¨¡å—(on/off) gzip_buffers 16 8k; #è®¾ç½®ç³»ç»Ÿè·å–å‡ ä¸ªå•ä½çš„ç¼“å­˜ç”¨äºå­˜å‚¨gzipçš„å‹ç¼©ç»“æœæ•°æ®æµã€‚16 8kä»£è¡¨ä»¥8kä¸ºå•ä½ï¼Œå®‰è£…åŸå§‹æ•°æ®å¤§å°ä»¥8kä¸ºå•ä½çš„16å€ç”³è¯·å†…å­˜ gzip_comp_level 6; #gzipå‹ç¼©æ¯”ï¼Œæ•°å€¼èŒƒå›´æ˜¯1-9ï¼Œ1å‹ç¼©æ¯”æœ€å°ä½†å¤„ç†é€Ÿåº¦æœ€å¿«ï¼Œ9å‹ç¼©æ¯”æœ€å¤§ä½†å¤„ç†é€Ÿåº¦æœ€æ…¢ gzip_http_version 1.1; #è¯†åˆ«httpçš„åè®®ç‰ˆæœ¬ gzip_min_length 256; #è®¾ç½®å…è®¸å‹ç¼©çš„é¡µé¢æœ€å°å­—èŠ‚æ•°ï¼Œé¡µé¢å­—èŠ‚æ•°ä»headerå¤´å¾—content-lengthä¸­è¿›è¡Œè·å–ã€‚é»˜è®¤å€¼æ˜¯0ï¼Œä¸ç®¡é¡µé¢å¤šå¤§éƒ½å‹ç¼©ã€‚è¿™é‡Œæˆ‘è®¾ç½®äº†ä¸º256 gzip_proxied any; #è¿™é‡Œè®¾ç½®æ— è®ºheaderå¤´æ˜¯æ€ä¹ˆæ ·ï¼Œéƒ½æ˜¯æ— æ¡ä»¶å¯ç”¨å‹ç¼© gzip_vary on; #åœ¨http headerä¸­æ·»åŠ Vary: Accept-Encoding ,ç»™ä»£ç†æœåŠ¡å™¨ç”¨çš„ gzip_types text/xml application/xml application/atom+xml application/rss+xml application/xhtml+xml image/svg+xml text/javascript application/javascript application/x-javascript text/x-json application/json application/x-web-app-manifest+json text/css text/plain text/x-component font/opentype font/ttf application/x-font-ttf application/vnd.ms-fontobject image/x-icon; #è¿›è¡Œå‹ç¼©çš„æ–‡ä»¶ç±»å‹,è¿™é‡Œç‰¹åˆ«æ·»åŠ äº†å¯¹å­—ä½“çš„æ–‡ä»¶ç±»å‹ gzip_disable \u0026#34;MSIE [1-6]\\.(?!.*SV1)\u0026#34;; #ç¦ç”¨IE 6 gzip äºŒ å¼€å¯è¶…æ—¶æ—¶é—´ é€šè¿‡è®¾ç½®Expiresï¼Œå¼€å¯ç¼“å­˜ã€‚ location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf|flv|ico)$ { expires 30d; access_log off; } location ~ .*\\.(eot|ttf|otf|woff|svg)$ { expires 30d; access_log off; } location ~ .*\\.(js|css)?$ { expires 7d; access_log off; } ","permalink":"https://www.chenzqi.cn/posts/2022/nginx-%E4%BC%98%E5%8C%96%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE-/","tags":["nginx"],"title":"Nginx ä¼˜åŒ–é™æ€æ–‡ä»¶è®¿é—®"},{"categories":[2022,"æŠ€æœ¯"],"contents":"æ–¹æ³•ä¸€ï¼š CREATE TABLE test_a ( id serial, name character varying(128), constraint pk_test_a_id primary key( id) ); æ–¹æ³•äºŒï¼š CREATE TABLE test_b( id serial PRIMARY KEY, name character varying(128) ); è¿™ä¸¤ç§æ–¹æ³•ç”¨çš„æ˜¯pgçš„serialç±»å‹å®ç°è‡ªå¢ï¼Œdropè¡¨çš„æ—¶å€™æŒ‡å®šçš„åºåˆ—ä¹Ÿä¼šdropæ‰ æ–¹æ³•ä¸‰ï¼šå…ˆåˆ›å»ºä¸»é”®è¡¨ CREATE TABLE test_c ( id integer PRIMARY KEY, name character varying(128) ); å†æ‰‹åŠ¨åˆ›å»ºåºåˆ— CREATE SEQUENCE test_c_id_seq START WITH 1 INCREMENT BY 1 NO MINVALUE NO MAXVALUE CACHE 1; å°†åºåˆ—èµ‹å€¼ç»™ä¸»é”® ALTER TABLE test_c alter column id set default nextval(\u0026#39;test_c_id_seq\u0026#39;); è¿™ç§æ–¹æ³•åœ¨dropè¡¨çš„æ—¶å€™åºåˆ—ä¸ä¼šéšç€dropæ‰ ","permalink":"https://www.chenzqi.cn/posts/2022/postgresql-%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%94%AE%E8%87%AA%E5%A2%9E%E7%9A%84%E8%A1%A8/","tags":["æ•°æ®åº“"],"title":"postgresql-åˆ›å»ºä¸»é”®è‡ªå¢çš„è¡¨"},{"categories":[2022,"æŠ€æœ¯"],"contents":"ç»ˆç«¯ï¼ˆç®¡ç†å‘˜ï¼‰è¾“å…¥ï¼š slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX slmgr /skms kms.03k.org slmgr /ato ","permalink":"https://www.chenzqi.cn/posts/2022/win10%E7%B3%BB%E7%BB%9F%E6%BF%80%E6%B4%BB%E6%8F%90%E7%A4%BA%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E5%88%B0%E4%BD%A0%E7%BB%84%E7%BB%87%E7%9A%84%E6%BF%80%E6%B4%BB%E6%9C%8D%E5%8A%A1%E5%99%A8-/","tags":["è®°å½•"],"title":"win10ç³»ç»Ÿæ¿€æ´»æç¤ºæ— æ³•è¿æ¥åˆ°ä½ ç»„ç»‡çš„æ¿€æ´»æœåŠ¡å™¨"},{"categories":[2022,"æŠ€æœ¯"],"contents":"é‡‡é›†æ•°æ®æ ·ä¾‹ ","permalink":"https://www.chenzqi.cn/posts/2022/%E6%95%B0%E6%8D%AE%E6%A0%B7%E4%BE%8B/","tags":["è®°å½•"],"title":"æ•°æ®æ ·ä¾‹"},{"categories":[2022,"æ•™ç¨‹"],"contents":"ğŸºçœ‹å®Œæœ¬æ•™ç¨‹ä½ æœ‰ä»»ä½•é—®é¢˜å¯ä»¥é€šè¿‡å³ä¸‹è§’è”ç³»æˆ‘ ä¸ºä»€ä¹ˆè®¢é˜…åœŸè€³å…¶åŒºçš„iCloud+ å› ä¸ºå¾ˆä¾¿å®œã€‚ iCloud+ å›½åŒºä¸åœŸåŒºå®šä»·å¯¹æ¯”å¦‚ä¸‹ï¼š 50GB å›½åŒºÂ¥6/æœˆï¼ŒåœŸåŒºâ‚º6.49(çº¦ï¿¥2.37)/æœˆ 200GB å›½åŒºÂ¥21/æœˆï¼ŒåœŸåŒºâ‚º19.99(çº¦ï¿¥7.29)/æœˆ 2TB å›½åŒºÂ¥68/æœˆï¼ŒåœŸåŒºâ‚º64.99(çº¦ï¿¥23.70)/æœˆ 1. æ³¨å†ŒåœŸåŒºçš„Apple ID éœ€è¦ä½¿ç”¨åœŸè€³å…¶åŒºçš„ Apple ID æ‰èƒ½è®¢é˜…åœŸè€³å…¶åŒºçš„ 1.1 åˆ›å»ºè´¦å· è¿›å…¥å®˜ç½‘: ç‚¹å‡»â€œåˆ›å»ºä½ çš„Apple IDâ€, å¡«å†™è´¦å·ä¿¡æ¯ å®Œæˆåæäº¤ï¼Œè¦æ¥æ”¶ä¸€ä¸ªéªŒè¯ç ã€‚ 1.2 ç™»å½•è´¦å·ï¼Œä¿®æ”¹è´¦å•ä¿¡æ¯ è¿›å…¥å®˜ç½‘: ç™»å½• ä½¿ç”¨è¿™ä¸ª åœ°å€ç”Ÿæˆå™¨ï¼Œç”Ÿæˆä¸€ä¸ªåœ°å€ï¼Œè´¦å•å¯„é€åœ°å€å’Œé…é€åœ°å€å†™ä¸€æ · å®Œæˆ 2. è´­ä¹°åœŸåŒºAppleç¤¼å“å¡ ç‚¹å‡» ChanKa è´­ä¹°åœŸåŒºç¤¼å“å¡ï¼Œç¤¼å“å¡ä»·æ ¼ä¼šéšæ±‡ç‡æµ®åŠ¨ ä»˜æ¬¾å®Œæˆä¼šè·³åˆ°ä¸€ä¸ªç¤¼å“å¡å·é¡µé¢ï¼ŒåŒæ—¶ä¼šå‘ä½ å‘ä¸€ä»½ç¤¼å“å¡çš„é‚®ä»¶ 3. ä½¿ç”¨ç¤¼å“å¡ç»™åœŸåŒºAppleIDå……å€¼ æ‰‹æœºä¸Šå¯ä»¥å‚è€ƒ ï¼šæ‰‹æœºç«¯å……å€¼æ–¹æ³•ã€‚ åœ¨è‡ªå·±çš„è‹¹æœè®¾å¤‡ä¸­ç™»å½•åœŸè€³å…¶åŒºçš„ Apple IDï¼Œç„¶åæ‰“å¼€ App Storeï¼Œç‚¹å‡»å³ä¸Šè§’çš„è´¦æˆ·å¤´åƒï¼Œåœ¨å¼¹å‡ºçš„è´¦æˆ·é¡µé¢é€‰æ‹© Redeem Gift Card or Code**ã€‚ åœ¨å¼¹å‡ºçš„çª—å£ï¼Œé€‰æ‹© Enter Code Manuallyï¼Œç„¶åè¾“å…¥åˆšåˆšè´­ä¹°çš„ç¤¼å“å¡å…‘æ¢ç ï¼Œç‚¹å‡»å…‘æ¢æŒ‰é’®å³å¯ã€‚ çœ‹åˆ°ä¸‹é¢è¿™ä¸ªé¡µé¢ï¼Œåˆ™è¯´æ˜å…‘æ¢æˆåŠŸã€‚ 4. è®¢é˜…åœŸåŒºiCloud+ å®ŒæˆåœŸè€³å…¶åŒº Apple ID ä½™é¢å……å€¼åï¼Œæ‰“å¼€è®¾ç½® Appï¼Œç‚¹å‡» Apple ID è´¦å·å¤´åƒ \u0026gt; iCloudï¼Œå‡çº§ iCloud å‚¨å­˜ç©ºé—´ã€‚è¿™é‡Œåªæä¾›å·²å‡çº§æˆ 2TB iCloud+å‚¨å­˜æ–¹æ¡ˆçš„æˆªå›¾ã€‚ 5. ä¸å›½åŒºAppleIDå…±äº«åœŸåŒº2TB iCloud+å‚¨å­˜æ–¹æ¡ˆ æœ€åä¸€æ­¥ï¼Œå°±æ˜¯ä½¿ç”¨å›½åŒº Apple ID é‚€è¯·å·²è®¢é˜… 2TB iCloud+ å‚¨å­˜æ–¹æ¡ˆçš„åœŸè€³å…¶åŒº Apple ID è¿›å…¥å®¶åº­ï¼Œç„¶åä½¿ç”¨å®¶äººå…±äº«åŠŸèƒ½å°†åœŸè€³å…¶åŒº 2TB iCloud+ å‚¨å­˜æ–¹æ¡ˆå…±äº«ç»™å›½åŒº Apple IDã€‚å¦‚æœåŸæœ‰çš„å›½åŒº iCloud+ å‚¨å­˜æ–¹æ¡ˆæœ‰å…±äº«ç»™å…¶ä»–å®¶åº­æˆå‘˜ï¼Œåˆ™éœ€è¦å…ˆå–æ¶ˆå…±äº«ç„¶åå†è®©åœŸè€³å…¶åŒº Apple ID å‘å‡º iCloud+ å‚¨å­˜å…±äº«é‚€è¯·ã€‚ Ps: é€šè¿‡æ‰‹æœºå·å‘é€ iMessage é‚€è¯·é“¾æ¥çš„æ–¹å¼åŠ å…¥å®¶åº­ã€‚é‚®ç®±å¯èƒ½ä¸è¡Œï¼Œå¦‚æœä¸è¡Œï¼Œåˆ™ä½¿ç”¨ AirDrop çš„æ–¹å¼å†è¯•è¯•ã€‚ æˆåŠŸåŠ å…¥å›½åŒº Apple ID çš„å®¶åº­åï¼Œåœ¨å·²ç™»å½•åœŸè€³å…¶åŒº Apple ID çš„è®¾å¤‡ä¸Šï¼Œæ‰“å¼€è®¾ç½® Appï¼Œç‚¹å‡» Apple ID è´¦å·å¤´åƒ \u0026gt; ** iCloud** \u0026gt; ç®¡ç†å¸æˆ·å‚¨å­˜ç©ºé—´ \u0026gt; ä¸å®¶äººå…±äº«ã€‚åœ¨å¼¹å‡ºçš„çª—å£ä¸­ç‚¹å‡» ä¸å®¶äººå…±äº«æŒ‰é’® ç»§ç»­ã€‚ åœ¨ä¸‹ä¸€ä¸ªå¼¹çª—ï¼Œé€‰æ‹© å‘é€é‚€è¯·ã€‚ å‘é€é‚€è¯·åï¼Œåœ¨ç™»å½•äº†å›½åŒº Apple ID çš„è®¾å¤‡ä¸Šï¼Œæ‰“å¼€ä¿¡æ¯ Appï¼Œç„¶åç‚¹å‡»åœŸè€³å…¶åŒº Apple ID å‘æ¥çš„é‚€è¯·é“¾æ¥æ¥å— 2TB iCloud+å‚¨å­˜æ–¹æ¡ˆå…±äº«å³å¯ã€‚ ä»¥ä¸Šå°±æ˜¯å›½å†…è®¢é˜…åœŸè€³å…¶åŒº iCloud+ çš„å®Œæ•´æ”»ç•¥ã€‚ ","permalink":"https://www.chenzqi.cn/posts/2022/subscribe-turkey-icloud/","tags":["è®°å½•"],"title":"å›½å†…ç”¨æˆ·è®¢é˜…åœŸè€³å…¶iCloudæ”»ç•¥"},{"categories":[2022,"æ•™ç¨‹"],"contents":"App Store ç¤¼å“å¡å…‘ç° iPhone æ‰‹æœºæˆ– iPad æˆ–å…¶å®ƒå¯ç™»å½• Apple Store ç»ˆç«¯ ç™»å½•åœŸåŒºè´¦å·ã€‚ç‚¹å‡»ä¸ªäººå¤´åƒ è¿›å…¥Redeem Gift Card or Code è¾“å…¥ç¤¼å“å¡å¡å¯†å…‘ç°å³å¯ã€‚ ","permalink":"https://www.chenzqi.cn/posts/2022/app-store-gift-card-redemption/","tags":["è®°å½•"],"title":"App Store ç¤¼å“å¡å…‘æ¢"},{"categories":[2021],"contents":"package utils import ( \u0026#34;bytes\u0026#34; \u0026#34;encoding/json\u0026#34; \u0026#34;io/ioutil\u0026#34; \u0026#34;net/http\u0026#34; \u0026#34;time\u0026#34; ) func HttpRequest(method string, url string, data interface{}, result interface{}, header map[string]interface{}, queryParams map[string]interface{}) (response *http.Response, resMap interface{}, err error) { var client = http.Client{ Timeout: 3 * time.Second, } buf := bytes.NewBuffer(nil) encoder := json.NewEncoder(buf) if err = encoder.Encode(data); err != nil { return nil, nil, err } request, err := http.NewRequest(method, url, buf) if err != nil { return nil, nil, err } //request.Header.Add(\u0026#34;Content-Type\u0026#34;, \u0026#34;application/json\u0026#34;) if header != nil { for k, v := range header { request.Header.Add(k, v.(string)) } } if queryParams != nil { q := request.URL.Query() for k, v := range queryParams { q.Add(k, v.(string)) request.URL.RawQuery = q.Encode() } } response, err = client.Do(request) if err != nil { return nil, nil, err } if result != nil { defer response.Body.Close() res, err := ioutil.ReadAll(response.Body) if err != nil { return nil, nil, err } if err = json.Unmarshal(res, \u0026amp;result); err != nil { return nil, nil, err } //err = json.NewDecoder(response.Body).Decode(result) return response, result, err } return } ","permalink":"https://www.chenzqi.cn/posts/2021/20210620_go%E5%B0%81%E8%A3%85httprequest%E6%96%B9%E6%B3%95/","tags":["golang"],"title":"Goå®ç°å°è£…HttpRequestæ–¹æ³•"},{"categories":[2021,"æŠ€æœ¯"],"contents":" é¢˜å· é¢˜ç›® 1 Golangä¸­é™¤äº†åŠ Mutexé”ä»¥å¤–è¿˜æœ‰å“ªäº›æ–¹å¼å®‰å…¨è¯»å†™å…±äº«å˜é‡ 2 æ— ç¼“å†²Chançš„å‘é€å’Œæ¥æ”¶æ˜¯å¦åŒæ­¥ 3 Golangå¹¶å‘æœºåˆ¶ä»¥åŠå®ƒæ‰€ä½¿ç”¨çš„CSPå¹¶å‘æ¨¡å‹ 4 Golangä¸­å¸¸ç”¨çš„å¹¶å‘æ¨¡å‹ 5 Goä¸­å¯¹nilçš„Sliceå’Œç©ºSliceçš„å¤„ç†æ˜¯ä¸€è‡´çš„å— 6 åç¨‹å’Œçº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ« 7 Golangçš„å†…å­˜æ¨¡å‹ä¸­ä¸ºä»€ä¹ˆå°å¯¹è±¡å¤šäº†ä¼šé€ æˆGCå‹åŠ› 8 Goä¸­æ•°æ®ç«äº‰é—®é¢˜æ€ä¹ˆè§£å†³ 9 ä»€ä¹ˆæ˜¯channelï¼Œä¸ºä»€ä¹ˆå®ƒå¯ä»¥åšåˆ°çº¿ç¨‹å®‰å…¨ 10 Golangåƒåœ¾å›æ”¶ç®—æ³• 11 GCçš„è§¦å‘æ¡ä»¶ 12 Goçš„GPMå¦‚ä½•è°ƒåº¦ 13 å¹¶å‘ç¼–ç¨‹æ¦‚å¿µæ˜¯ä»€ä¹ˆ 14 Goè¯­è¨€çš„æ ˆç©ºé—´ç®¡ç†æ˜¯æ€ä¹ˆæ ·çš„ 15 Goroutineå’ŒChannelçš„ä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆ 16 æ€ä¹ˆæŸ¥çœ‹Goroutineçš„æ•°é‡ 17 Goä¸­çš„é”æœ‰å“ªäº› 18 æ€ä¹ˆé™åˆ¶Goroutineçš„æ•°é‡ 19 Channelæ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥çš„ 20 Goroutineå’Œçº¿ç¨‹çš„åŒºåˆ« 21 Goçš„Structèƒ½ä¸èƒ½æ¯”è¾ƒ 22 Goçš„deferåŸç†æ˜¯ä»€ä¹ˆ 23 Goçš„selectå¯ä»¥ç”¨äºä»€ä¹ˆ 24 Goçš„ContextåŒ…çš„ç”¨é€”æ˜¯ä»€ä¹ˆ 25 Goä¸»åç¨‹å¦‚ä½•ç­‰å…¶ä½™åç¨‹å®Œå†æ“ä½œ 26 Goçš„Sliceå¦‚ä½•æ‰©å®¹ 27 Goä¸­çš„mapå¦‚ä½•å®ç°é¡ºåºè¯»å– 28 Goä¸­CASæ˜¯æ€ä¹ˆå›äº‹ 29 Goä¸­çš„é€ƒé€¸åˆ†ææ˜¯ä»€ä¹ˆ 30 Goå€¼æ¥æ”¶è€…å’ŒæŒ‡é’ˆæ¥æ”¶è€…çš„åŒºåˆ« 31 Goçš„å¯¹è±¡åœ¨å†…å­˜ä¸­æ˜¯æ€æ ·åˆ†é…çš„ 32 æ ˆçš„å†…å­˜æ˜¯æ€ä¹ˆåˆ†é…çš„ 33 å †å†…å­˜ç®¡ç†æ€ä¹ˆåˆ†é…çš„ 34 Goä¸­çš„deferå‡½æ•°ä½¿ç”¨ä¸‹é¢çš„ä¸¤ç§æƒ…å†µä¸‹ç»“æœæ˜¯ä»€ä¹ˆ 35 åœ¨Goå‡½æ•°ä¸­ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿå†…å­˜æ³„éœ² 36 Goä¸­newå’Œmakeçš„åŒºåˆ« 37 G0çš„ä½œç”¨ 38 Goä¸­çš„é”å¦‚ä½•å®ç° 39 Goä¸­çš„channelçš„å®ç° 40 Goä¸­çš„mapçš„å®ç° 41 Goä¸­çš„httpåŒ…çš„å®ç°åŸç† 42 Goroutineå‘ç”Ÿäº†æ³„æ¼å¦‚ä½•æ£€æµ‹ 43 Goå‡½æ•°è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ˜¯å¦å®‰å…¨ 44 Goä¸­ä¸¤ä¸ªNilå¯èƒ½ä¸ç›¸ç­‰å— 45 Goroutineå’ŒKernelThreadä¹‹é—´æ˜¯ä»€ä¹ˆå…³ç³» 46 ä¸ºä½•GPMè°ƒåº¦è¦æœ‰P 1 Golangä¸­é™¤äº†åŠ Mutexé”ä»¥å¤–è¿˜æœ‰å“ªäº›æ–¹å¼å®‰å…¨è¯»å†™å…±äº«å˜é‡ Golangä¸­Goroutine å¯ä»¥é€šè¿‡ Channel è¿›è¡Œå®‰å…¨è¯»å†™å…±äº«å˜é‡,è¿˜å¯ä»¥é€šè¿‡åŸå­æ€§æ“ä½œè¿›è¡Œ. ","permalink":"https://www.chenzqi.cn/posts/2021/20210609_golang%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/","tags":["golang"],"title":"Golangé—®é¢˜æ±‡æ€» - (æŒç»­æ›´æ–°...)"},{"categories":[2021,"æŠ€æœ¯"],"contents":"å‚æ•°ä¼ é€’ Goåœ¨ä¼ é€’å‚æ•°æ—¶æ˜¯ä¼ å€¼è¿˜æ˜¯ä¼ å¼•ç”¨ï¼Œä¸åŒçš„é€‰æ‹©ä¼šå½±å“æˆ‘ä»¬åœ¨å‡½æ•°ä¸­ä¿®æ”¹å…¥å‚æ—¶æ˜¯å¦ä¼šå½±å“è°ƒç”¨æ–¹çœ‹åˆ°çš„æ•°æ®ã€‚ ::: tip ä¼ å€¼å’Œä¼ å¼•ç”¨ä¸¤è€…çš„åŒºåˆ« ä¼ å€¼ï¼šå‡½æ•°è°ƒç”¨æ—¶ä¼šå¯¹å‚æ•°è¿›è¡Œæ‹·è´ï¼Œè¢«è°ƒç”¨æ–¹å’Œè°ƒç”¨æ–¹ä¸¤è€…æŒæœ‰ä¸ç›¸å…³çš„ä¸¤ä»½æ•°æ®ï¼› ä¼ å¼•ç”¨ï¼šå‡½æ•°è°ƒç”¨æ—¶ä¼šä¼ é€’å‚æ•°çš„æŒ‡é’ˆï¼Œè¢«è°ƒç”¨æ–¹å’Œè°ƒç”¨æ–¹ä¸¤è€…æŒæœ‰ç›¸åŒçš„æ•°æ®ï¼Œä»»æ„ä¸€æ–¹åšå‡ºçš„ä¿®æ”¹éƒ½ä¼šå½±å“å¦ä¸€æ–¹ï¼› ::: ä¸åŒè¯­è¨€ä¼šé€‰æ‹©ä¸åŒçš„æ–¹å¼ä¼ é€’å‚æ•°ï¼ŒGo é€‰æ‹©äº†ä¼ å€¼çš„æ–¹å¼ï¼Œæ— è®ºæ˜¯ä¼ é€’åŸºæœ¬ç±»å‹ã€ç»“æ„ä½“è¿˜æ˜¯æŒ‡é’ˆï¼Œéƒ½ä¼šå¯¹ä¼ é€’çš„å‚æ•°è¿›è¡Œæ‹·è´ã€‚ æ•´å‹å’Œæ•°ç»„ å‡½æ•° myFunction æ¥æ”¶äº†ä¸¤ä¸ªå‚æ•°ï¼Œæ•´å‹å˜é‡ i å’Œæ•°ç»„ arrï¼Œè¿™ä¸ªå‡½æ•°ä¼šå°†ä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°çš„åœ°å€æ‰“å°å‡ºæ¥ï¼Œåœ¨æœ€å¤–å±‚çš„ä¸»å‡½æ•°ä¹Ÿä¼šåœ¨ myFunction å‡½æ•°è°ƒç”¨å‰ååˆ†åˆ«æ‰“å°ä¸¤ä¸ªå‚æ•°çš„åœ°å€ï¼š func myFunction(i int, arr [2]int) { fmt.Printf(\u0026#34;in my_funciton - i=(%d, %p) arr=(%v, %p)\\n\u0026#34;, i, \u0026amp;i, arr, \u0026amp;arr) } func main() { i := 30 arr := [2]int{66, 77} fmt.Printf(\u0026#34;before calling - i=(%d, %p) arr=(%v, %p)\\n\u0026#34;, i, \u0026amp;i, arr, \u0026amp;arr) myFunction(i, arr) fmt.Printf(\u0026#34;after calling - i=(%d, %p) arr=(%v, %p)\\n\u0026#34;, i, \u0026amp;i, arr, \u0026amp;arr) } $ go run main.go before calling - i=(30, 0xc00009a000) arr=([66 77], 0xc00009a010) in my_funciton - i=(30, 0xc00009a008) arr=([66 77], 0xc00009a020) after calling - i=(30, 0xc00009a000) arr=([66 77], 0xc00009a010) main å‡½æ•°å’Œè¢«è°ƒç”¨è€… myFunction ä¸­å‚æ•°çš„åœ°å€å®Œå…¨ä¸åŒã€‚ main å‡½æ•°çš„è§’åº¦æ¥çœ‹ï¼Œåœ¨è°ƒç”¨ myFunction å‰åï¼Œæ•´æ•° i å’Œæ•°ç»„ arr ä¸¤ä¸ªå‚æ•°çš„åœ°å€éƒ½æ²¡æœ‰å˜åŒ–ã€‚ å¦‚æœåœ¨ myFunction å‡½æ•°å†…éƒ¨å¯¹å‚æ•°è¿›è¡Œä¿®æ”¹, ä¹Ÿä»…ä»…å½±å“äº†å½“å‰å‡½æ•°, å¹¶æ²¡æœ‰å½±å“è°ƒç”¨æ–¹ main å‡½æ•°ã€‚ ::: tip ç»“è®º Go è¯­è¨€çš„æ•´å‹å’Œæ•°ç»„ç±»å‹éƒ½æ˜¯å€¼ä¼ é€’çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨è°ƒç”¨å‡½æ•°æ—¶ä¼šå¯¹å†…å®¹è¿›è¡Œæ‹·è´ã€‚ ::: ::: warning éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœå½“å‰æ•°ç»„çš„å¤§å°éå¸¸çš„å¤§ï¼Œè¿™ç§ä¼ å€¼çš„æ–¹å¼ä¼šå¯¹æ€§èƒ½é€ æˆæ¯”è¾ƒå¤§çš„å½±å“ã€‚ ::: ç»“æ„ä½“å’ŒæŒ‡é’ˆ å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“ MyStruct ä»¥åŠæ¥å—ä¸¤ä¸ªå‚æ•°çš„ myFunction æ–¹æ³•ï¼š type MyStruct struct { i int } func myFunction(a MyStruct, b *MyStruct) { a.i = 31 b.i = 41 fmt.Printf(\u0026#34;in my_function - a=(%d, %p) b=(%v, %p)\\n\u0026#34;, a, \u0026amp;a, b, \u0026amp;b) } func main() { a := MyStruct{i: 30} b := \u0026amp;MyStruct{i: 40} fmt.Printf(\u0026#34;before calling - a=(%d, %p) b=(%v, %p)\\n\u0026#34;, a, \u0026amp;a, b, \u0026amp;b) myFunction(a, b) fmt.Printf(\u0026#34;after calling - a=(%d, %p) b=(%v, %p)\\n\u0026#34;, a, \u0026amp;a, b, \u0026amp;b) } $ go run main.go before calling - a=({30}, 0xc000018178) b=(\u0026amp;{40}, 0xc00000c028) in my_function - a=({31}, 0xc000018198) b=(\u0026amp;{41}, 0xc00000c038) after calling - a=({30}, 0xc000018178) b=(\u0026amp;{41}, 0xc00000c028) ::: tip ç»“è®º ä¼ é€’ç»“æ„ä½“æ—¶ï¼šä¼šæ‹·è´ç»“æ„ä½“ä¸­çš„å…¨éƒ¨å†…å®¹ï¼› ä¼ é€’ç»“æ„ä½“æŒ‡é’ˆæ—¶ï¼šä¼šæ‹·è´ç»“æ„ä½“æŒ‡é’ˆï¼› ::: ä¿®æ”¹ç»“æ„ä½“æŒ‡é’ˆæ˜¯æ”¹å˜äº†æŒ‡é’ˆæŒ‡å‘çš„ç»“æ„ä½“ï¼Œb.i å¯ä»¥è¢«ç†è§£æˆ (*b).iï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å…ˆè·å–æŒ‡é’ˆ b èƒŒåçš„ç»“æ„ä½“ï¼Œå†ä¿®æ”¹ç»“æ„ä½“çš„æˆå‘˜å˜é‡ã€‚ ä¼ å€¼ Go è¯­è¨€åœ¨ä¼ é€’å‚æ•°æ—¶ä½¿ç”¨äº†ä¼ å€¼çš„æ–¹å¼ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°å‚æ•°æ—¶ä¼šå¯¹è¿™äº›å‚æ•°è¿›è¡Œå¤åˆ¶ï¼›åœ¨ä¼ é€’æ•°ç»„æˆ–è€…å†…å­˜å ç”¨éå¸¸å¤§çš„ç»“æ„ä½“æ—¶ï¼Œå°½é‡ä½¿ç”¨æŒ‡é’ˆä½œä¸ºå‚æ•°ç±»å‹æ¥é¿å…å‘ç”Ÿæ•°æ®æ‹·è´è¿›è€Œå½±å“æ€§èƒ½ã€‚ ","permalink":"https://www.chenzqi.cn/posts/2021/20210519_go%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8-%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92/","tags":["golang"],"title":"GOå‚æ•°ä¼ é€’"},{"categories":[2021],"contents":"ä¸€ã€ç›¸å…³å·¥å…· navicat15-premium-cs.AppImageï¼šNavicat 15 premium å®˜æ–¹ç®€ä½“ä¸­æ–‡è¯•ç”¨ç‰ˆ navicat-patcherï¼šè¡¥ä¸ navicat-keygen ï¼šæ³¨å†Œæœº 4.appimagetool-x86_64.AppImageï¼šLinux ç‹¬ç«‹è¿è¡Œè½¯ä»¶æ‰“åŒ…å·¥å…· ç›¸å…³å·¥å…·ä¸‹è½½åœ°å€ æå–ç ï¼š v587 äºŒã€ç³»ç»Ÿç¯å¢ƒé…ç½® 1.å®‰è£… capstone sudo apt-get install libcapstone-dev 2.å®‰è£… keystone sudo apt-get install cmake git clone https://github.com/keystone-engine/keystone.git cd keystone mkdir build cd build ../make-share.sh sudo make install sudo ldconfig 3.å®‰è£… rapidjson sudo apt-get install rapidjson-dev ä¸‰ã€æ“ä½œæ­¥éª¤ 1.èµ‹äºˆæ‰§è¡Œæƒé™ chmod +x appimagetool-x86_64.AppImage chmod +x navicat-patcher chmod +x navicat-keygen 2.è§£å‹å®˜æ–¹è½¯ä»¶ mkdir navicat15 mount -o loop navicat15-premium-cs.AppImage navicat15 cp -r navicat15 navicat15-patched 3.è¿è¡Œè¡¥ä¸ (ç”ŸæˆRegPrivateKey.pemæ–‡ä»¶) ./navicat-patcher navicat15-patched 4.æ‰“åŒ…æˆç‹¬ç«‹è¿è¡Œè½¯ä»¶ ./appimagetool-x86_64.AppImage navicat15-patched navicat15-premium-cs-pathed.AppImage 5. è¿è¡Œè¡¥ä¸åè½¯ä»¶åŒ… chmod +x navicat15-premium-cs-pathed.AppImage ./navicat15-premium-cs-pathed.AppImage 6.è¿è¡Œæ³¨å†Œæœº (æ‰“å¼€æ–°ç»ˆç«¯) ./navicat-keygen --text ./RegPrivateKey.pem @chenshen:~/apps/navicat/Navicat15$ ./navicat-keygen --text ./RegPrivateKey.pem ********************************************************** * Navicat Keygen (Linux) by @DoubleLabyrinth * * Version: 1.0 * ********************************************************** [*] Select Navicat product: 0. DataModeler 1. Premium 2. MySQL 3. PostgreSQL 4. Oracle 5. SQLServer 6. SQLite 7. MariaDB 8. MongoDB 9. ReportViewer (Input index)\u0026gt; 1 [*] Select product language: 0. English 1. Simplified Chinese 2. Traditional Chinese 3. Japanese 4. Polish 5. Spanish 6. French 7. German 8. Korean 9. Russian 10. Portuguese (Input index)\u0026gt; 1 [*] Input major version number: (range: 0 ~ 15, default: 12)\u0026gt; 15 [*] Serial number: NAVB-B5EA-NXXV-EFVY 7.ç”Ÿæˆåºåˆ—å· (æ–­ç½‘æ“ä½œ) æ³¨å†Œé¡µé¢å¡«å…¥ç”Ÿæˆçš„æ³¨å†Œç ï¼Œè¶…æ—¶åé€‰æ‹©æ‰‹åŠ¨æ¿€æ´»ï¼Œè¾“å…¥è¯·æ±‚ç ï¼Œä¸¤æ¬¡å›è½¦ç”Ÿæˆæ¿€æ´»ç ï¼Œå¡«å…¥åå³å¯æ¿€æ´»æˆåŠŸ ","permalink":"https://www.chenzqi.cn/posts/2021/20210506_liunx-navicat-premium-15-%E6%BF%80%E6%B4%BB/","tags":["å·¥å…·","æ•°æ®åº“"],"title":"Liunx Navicat premium 15 æ¿€æ´»"},{"categories":[2021,"æŠ€æœ¯"],"contents":"ç®€ä»‹ pyinstaller -F xxx.py æ‰“åŒ…åä¼šç”Ÿæˆxxx.specæ–‡ä»¶ï¼Œï¼Œspecæ–‡ä»¶å…¶å®å°±ç›¸å½“äºä¸€ä¸ªæ‰“åŒ…çš„æ¶æ„æ–‡ä»¶ï¼Œé‡Œé¢å†™äº†è¦æ€ä¹ˆæ‰“åŒ…ï¼Œç±»ä¼¼äºdockerä¸­çš„DockerFileã€‚åœ¨ç”¨pyinstaller -F xxx.pyè¿™ç§æ–¹å¼æ‰“åŒ…çš„æ—¶å€™ï¼Œç¨‹åºä¹Ÿæ˜¯å…ˆç”Ÿæˆspecæ–‡ä»¶ï¼Œå†æ¬¡æ‰“åŒ…çš„æ—¶å€™å¯ä»¥ç›´æ¥pyinstaller test.specå°±å¯ä»¥ã€‚ æ­¥éª¤ æ–°å»ºcrawl.py åœ¨scrapy.cfgæ–‡ä»¶åŒä¸€å±‚ï¼Œæ–°å»ºä¸€ä¸ªpyæ–‡ä»¶ï¼Œèµ·åä¸º crawl.py # -*- coding: utf-8 -*- from scrapy.crawler import CrawlerProcess from scrapy.utils.project import get_project_settings # è¿™é‡Œæ˜¯å¿…é¡»å¼•å…¥çš„ #import robotparser import scrapy.spiderloader import scrapy.statscollectors import scrapy.logformatter import scrapy.dupefilters import scrapy.squeues import scrapy.extensions.spiderstate import scrapy.extensions.corestats import scrapy.extensions.telnet import scrapy.extensions.logstats import scrapy.extensions.memusage import scrapy.extensions.memdebug import scrapy.extensions.feedexport import scrapy.extensions.closespider import scrapy.extensions.debug import scrapy.extensions.httpcache import scrapy.extensions.statsmailer import scrapy.extensions.throttle import scrapy.core.scheduler import scrapy.core.engine import scrapy.core.scraper import scrapy.core.spidermw import scrapy.core.downloader import scrapy.downloadermiddlewares.stats import scrapy.downloadermiddlewares.httpcache import scrapy.downloadermiddlewares.cookies import scrapy.downloadermiddlewares.useragent import scrapy.downloadermiddlewares.httpproxy import scrapy.downloadermiddlewares.ajaxcrawl #import scrapy.downloadermiddlewares.chunked import scrapy.downloadermiddlewares.decompression import scrapy.downloadermiddlewares.defaultheaders import scrapy.downloadermiddlewares.downloadtimeout import scrapy.downloadermiddlewares.httpauth import scrapy.downloadermiddlewares.httpcompression import scrapy.downloadermiddlewares.redirect import scrapy.downloadermiddlewares.retry import scrapy.downloadermiddlewares.robotstxt import scrapy.spidermiddlewares.depth import scrapy.spidermiddlewares.httperror import scrapy.spidermiddlewares.offsite import scrapy.spidermiddlewares.referer import scrapy.spidermiddlewares.urllength import scrapy.pipelines import scrapy.core.downloader.handlers.http import scrapy.core.downloader.contextfactory # è‡ªå·±é¡¹ç›®ç”¨åˆ°çš„åŒ… import openpyxl import json import time import os process = CrawlerProcess(get_project_settings()) # \u0026#39;spider_name\u0026#39;æ›¿æ¢æˆè‡ªå·±çš„çˆ¬è™«å process.crawl(\u0026#39;spider_name\u0026#39;) process.start() # the script will block here until the crawling is finished æ‰“åŒ…crawl.py pyinstaller -F crawl.py -F è¡¨ç¤ºæ‰“åŒ…æˆå•ç‹¬çš„ .exe æ–‡ä»¶ å…¶ä»–å‚æ•°åœ¨æœ¬é¡µé¢æœç´¢æ¡†è¾“å…¥ ç¨‹åºæ‰“åŒ… è¿è¡Œcrawl.exe 1.åŒå‡»è¿è¡Œï¼ŒæŠ¥é”™ä¼šé—ªé€€ 2.æ‰“å¼€æ–°ç»ˆç«¯ï¼Œå°†crawl.exe æ‰˜è¿›å»è¿è¡Œï¼Œå¯çœ‹è§æŠ¥é”™ä¿¡æ¯ é—®é¢˜ ç¼ºå°‘æ–‡ä»¶ FileNotFoundError: [Errno 2] No such file or directory: \u0026#39;C:\\\\Users\\\\ADMINI~1\\\\Ap pData\\\\Local\\\\Temp\\\\_MEI77122\\\\scrapy\\\\VERSION\u0026#39; å°‘VERSIONæ–‡ä»¶ï¼Œè¿™ä¸ªVERSIONæ–‡ä»¶å®‰è£…çš„scrapyæ¨¡å—ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨å®‰è£…ç›®å½•ï¼Œæ¯”å¦‚scrapyæ–‡ä»¶éƒ½å®‰è£…åœ¨è¿™ä¸ªç›®å½•ä¸‹D:\\Program Files\\python374\\Lib\\site-packages\\scrapyã€‚ å¯ä»¥åœ¨specæ–‡ä»¶ä¸­ç›´æ¥é…ç½® # -*- mode: python ; coding: utf-8 -*- block_cipher = None a = Analysis([\u0026#39;crawl.py\u0026#39;], pathex=[\u0026#39;C:\\\\Users\\\\Administrator\\\\Desktop\\\\qiaofenqi\u0026#39;], binaries=[], datas=[(\u0026#39;D:\\\\Program Files\\\\python374\\\\Lib\\\\site-packages\\\\scrapy\\\\mime.types\u0026#39;,\u0026#39;scrapy\u0026#39;), (\u0026#39;D:\\\\Program Files\\\\python374\\\\Lib\\\\site-packages\\\\scrapy\\\\VERSION\u0026#39;,\u0026#39;scrapy\u0026#39;), (\u0026#39;.\u0026#39;,\u0026#39;.\u0026#39; )], hiddenimports=[], hookspath=[], runtime_hooks=[], excludes=[], win_no_prefer_redirects=False, win_private_assemblies=False, cipher=block_cipher, noarchive=False) pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher) exe = EXE(pyz, a.scripts, a.binaries, a.zipfiles, a.datas, [], name=\u0026#39;crawl\u0026#39;, debug=False, bootloader_ignore_signals=False, strip=False, upx=True, upx_exclude=[], runtime_tmpdir=None, console=True ) ä¸»è¦æ”¹çš„åœ°æ–¹å°±æ˜¯dataså‚æ•°ï¼Œè¦åŠ å…¥æ‰“åŒ…çš„èµ„æºæ–‡ä»¶ï¼Œmime.typesæ”¾åˆ°scrapyæ–‡ä»¶å¤¹ä¸‹ï¼ŒVERSIONæ”¾åˆ°scrapyæ–‡ä»¶å¤¹ä¸‹ï¼Œ(â€™.â€™,â€™.â€™ )æŠŠå½“å‰ç›®å½•æ”¾åˆ°æ‰“åŒ…åçš„æ ¹è·¯å¾„ä¸‹ï¼Œå°±æ˜¯æŠŠæ•´ä¸ªçˆ¬è™«æ–‡ä»¶æ‰“åŒ…è¿›å»ã€‚ é‡æ–°æ‰“åŒ…ï¼Œæ‰“åŒ…ä¹‹å‰æŠŠä¸Šæ¬¡äº§ç”Ÿçš„buildå’Œdistæ–‡ä»¶å¤¹åˆ æ‰ï¼Œå› ä¸ºè¿™é‡Œç›´æ¥ç”¨çš„(â€™.â€™,â€™.â€™ )æŠŠæ•´ä¸ªæ–‡ä»¶éƒ½åŠ äº†æ‰“åŒ…æ–‡ä»¶é‡Œäº†ï¼ˆä¹æ„çš„è¯å¯ä»¥åªæŠŠpyæ–‡ä»¶åŠ å…¥datasï¼Œä½†ç›®å½•ç»“æ„ä¸èƒ½å˜ï¼‰ï¼Œä¼šæŠŠbuildå’Œdistä¹Ÿæ‰“è¿›å»ï¼Œé€ æˆexeæ–‡ä»¶å¾ˆå¤§ã€‚ é‡æ–°æ‰“åŒ…å‘½ä»¤ pyinstaller crawl.spec æŠŠxxx.exeæ–‡ä»¶æ‹·è´åˆ°å…¶ä»–åœ°æ–¹è¿è¡ŒæŠ¥é”™ KeyError: \u0026#39;Spider not found: credit\u0026#39; çˆ¬è™«è¿è¡Œæ˜¯è¦ä¾èµ–scrapy.cfgè¿™ä¸ªé…ç½®æ–‡ä»¶ï¼ŒæŠŠåŸæ¥çˆ¬è™«æ–‡ä»¶å¤¹é‡Œçš„scrapy.cfgå¤åˆ¶ä¸€ä¸‹ï¼Œå’Œexeæ–‡ä»¶æ”¾åˆ°åŒç›®å½•ä¸‹å°±å¯ä»¥ ","permalink":"https://www.chenzqi.cn/posts/2021/20210410_pyinstaller%E6%89%93%E5%8C%85scrapy%E9%A1%B9%E7%9B%AE/","tags":["python","pyinstaller"],"title":"pyinstalleræ‰“åŒ…scrapyé¡¹ç›®"},{"categories":[2021,"æŠ€æœ¯"],"contents":"å°†æœ¬æœºæ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Š # scp /home/administrator/news.txt root@127.0.0.1:/etc/squid /home/administrator/ æœ¬åœ°æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ news.txt è¦å¤åˆ¶åˆ°æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°æ–‡ä»¶ root é€šè¿‡rootç”¨æˆ·ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ‹¥æœ‰åŒç­‰æƒé™çš„ç”¨æˆ·ï¼‰ 127.0.0.1 è¿œç¨‹æœåŠ¡å™¨çš„ipåœ°å€ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨åŸŸåæˆ–æœºå™¨åï¼‰ /etc/squid å°†æœ¬åœ°æ–‡ä»¶å¤åˆ¶åˆ°ä½äºè¿œç¨‹æœåŠ¡å™¨ä¸Šçš„è·¯å¾„ å°†è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¤åˆ¶åˆ°æœ¬æœº # scp remote@www.abc.com:/usr/local/sin.sh /home/administrator remote é€šè¿‡remoteç”¨æˆ·ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ‹¥æœ‰åŒç­‰æƒé™çš„ç”¨æˆ·ï¼‰ 127.0.0.1 è¿œç¨‹æœåŠ¡å™¨ipåœ°å€ /usr/local/sin.sh å¤åˆ¶åˆ°æœ¬æœºçš„ä½äºè¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ /home/administrator å°†è¿œç¨‹æ–‡ä»¶å¤åˆ¶åˆ°æœ¬åœ°çš„ç»å¯¹è·¯å¾„ æ–‡ä»¶å¤¹ä¼ è¾“ æ–‡ä»¶å¤¹æ“ä½œåŠ  -r å‚æ•° ","permalink":"https://www.chenzqi.cn/posts/2021/20210326_scp%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","tags":["nginx"],"title":"SCP-æ–‡ä»¶ä¼ è¾“"},{"categories":[2021,"æŠ€æœ¯"],"contents":"ç”Ÿæˆä¸éªŒè¯ data: è‡ªå®šä¹‰æ•°æ®, å¦‚ {'username':user_name, 'user_id': user_info.id} éªŒè¯é€šè¿‡ååœ¨payloadä¸­è·å– import jwt from datetime import datetime,timedelta SECRECT_KEY = b\u0026#39;\\x92R!\\x8e\\xc6\\x9c\\xb3\\x89#\\xa6\\x0c\\xcb\\xf6\\xcb\\xd7\\xc\u0026#39; def genToken(data): expInt = datetime.utcnow() + timedelta(days=1) iat = datetime.utcnow() payload = { \u0026#39;exp\u0026#39;: expInt, \u0026#39;iat\u0026#39;: iat, \u0026#39;data\u0026#39;: data } token = jwt.encode(payload, key = SECRECT_KEY, algorithm=\u0026#39;HS256\u0026#39;) return bytes.decode(token) def verfiyToken(tokenStr): try: if tokenStr is not None: tokenBytes = tokenStr.encode(\u0026#39;utf-8\u0026#39;) payload = jwt.decode(tokenBytes,SECRECT_KEY) return payload return None except jwt.PyJWTError as e: print(\u0026#34;jwtéªŒè¯å¤±è´¥: %s\u0026#34; % e) return None ","permalink":"https://www.chenzqi.cn/posts/2021/20210320_jwt%E7%94%9F%E6%88%90%E4%B8%8E%E9%AA%8C%E8%AF%81/","tags":["web","python"],"title":"jwt ç”Ÿæˆä¸éªŒè¯ - Python"},{"categories":[2021,"æŠ€æœ¯"],"contents":"VSCodeç©ºæ ¼ é—®é¢˜ï¼š ç©ºæ ¼å¤ªå°ï¼Œåªå åŠä¸ªå­—ç¬¦å®½åº¦ æ–¹æ³•ï¼š å·¦ä¸Šè§’ æ–‡ä»¶-\u0026gt;é¦–é€‰é¡¹-\u0026gt;è®¾ç½®,åœ¨æœç´¢æ é‡Œæœfont æŠŠEditor:Font Familyä¸­é»˜è®¤çš„éƒ½åˆ æ‰ï¼Œåªç•™ä¸‹ä¸å¸¦å¼•å·çš„monospaceå³å¯ã€‚ ç•Œé¢å’Œç¼–è¾‘é¢æ¿å­—ä½“ é—®é¢˜ï¼š æ–°å®‰è£…çš„VS Codeå­—ä½“å¾ˆå°ï¼ŒåŒ…æ‹¬ç³»ç»Ÿå­—ä½“ï¼ˆæ ‡é¢˜æ ï¼Œå·¥å…·æ ã€çŠ¶æ€æ ï¼‰å’Œç¼–è¾‘é¢æ¿çš„å­—ä½“å¾ˆå° æ–¹æ³•ï¼š Ctrl + Shitf + pï¼Œè¾“å…¥ settingsï¼Œé€‰æ‹©æ‰“å¼€é‚£ä¸ªJSONçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ã€‚ { \u0026#34;editor.fontSize\u0026#34;: 15, \u0026#34;window.zoomLevel\u0026#34;: 1.5 } æ–‡ä»¶å¤¹ç¼©è¿› é—®é¢˜ï¼š å·¦ä¾§æ–‡ä»¶æ ‘ç¼©è¿›å¤ªå° è§£å†³ï¼š è®¾ç½® \u0026gt; æœç´¢ \u0026ldquo;tree\u0026rdquo; \u0026gt; ä¿®æ”¹ \u0026ldquo;Workbench â€º Tree: Indent\u0026rdquo; å€¼ ","permalink":"https://www.chenzqi.cn/posts/2021/20210312_vscode%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95/","tags":["VSCode"],"title":"VSCodeé…ç½®è®°å½•"},{"categories":[2021,"æŠ€æœ¯"],"contents":"ç¦æ­¢ipè®¿é—® server { listen 80 default; server_name _; return 500; } or server { listen 80 dufault; server_name _; rewrite ^(.*) http://www.xxx.cn permanent; } or server { listen 80 default; server_name _; server_name xxx.cn return 500; } åŸŸåé‡å®šå‘ server { listen 80; server_name xxx.cn; if ($host = \u0026#39;xxx.cn\u0026#39; ) { rewrite ^/(.*)$ http://xx.xxx.com/$1 permanent; } } ","permalink":"https://www.chenzqi.cn/posts/2021/20210305_nginx%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95/","tags":["nginx"],"title":"Nginxå¸¸è§é…ç½®è®°å½•"},{"categories":[2020,"æŠ€æœ¯"],"contents":"::: tip è®°å½•é‡‡é›† XXæ³•é™¢ç½‘ åçˆ¬è™«signéªŒè¯ç­¾å ::: ç­¾åéªŒè¯åçˆ¬è™« ç­¾åéªŒè¯çš„ç»“æœ ç­¾åæ˜¯æ ¹æ®æ•°æ®æºè¿›è¡Œè®¡ç®—æˆ–åŠ å¯†çš„è¿‡ç¨‹ï¼Œç­¾åçš„ç»“æœæ˜¯ä¸€ä¸ªå…·æœ‰å”¯ä¸€æ€§å’Œä¸€è‡´æ€§çš„å­—ç¬¦ä¸²ã€‚ç­¾åç»“æœçš„ç‰¹å¾ä½¿å¾—å®ƒæˆä¸ºéªŒè¯æ•°æ®æ¥æºå’Œæ•°æ®å®Œæ•´æ€§çš„æ¡ä»¶ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…æœåŠ¡å™¨ç«¯å°†ä¼ªé€ çš„æ•°æ®æˆ–ç¯¡æ”¹çš„æ•°æ®å½“æˆæ­£å¸¸æ•°æ®å¤„ç†ã€‚ ç­¾åéªŒè¯çš„ä½œç”¨ ç­¾åéªŒè¯æ—¶é˜²æ­¢æ¶æ„è¿æ¥å’Œæ•°æ®è¢«ç¯¡æ”¹çš„æœ‰æ•ˆæ–¹å¼ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯ç›®å‰åç«¯APIæœ€å¸¸è§çš„é˜²æŠ¤æ–¹å¼ä¹‹ä¸€ã€‚ä¸Cookieï¼ŒUser-Agetï¼ŒHostå’ŒRefererç­‰è¯·æ±‚å¤´åŸŸä¸åŒï¼Œç”¨äºç­¾åéªŒè¯çš„ä¿¡æ¯é€šå¸¸è¢«æ”¾åœ¨è¯·æ±‚æ­£æ–‡ä¸­å‘é€åˆ°æœåŠ¡å™¨ç«¯ã€‚ ç­¾åéªŒè¯çš„æ–¹å¼ ç­¾åéªŒè¯æœ‰å¾ˆå¤šç§å®ç°æ–¹å¼ï¼Œä½†æ˜¯åŸç†éƒ½æ˜¯ç›¸åŒçš„ï¼šç”±å®¢æœç«¯ç”Ÿæˆä¸€äº›éšæœºå€¼å’Œä¸å¯é€†çš„MD5åŠ å¯†å­—ç¬¦ä¸²ï¼Œå¹¶åœ¨å‘èµ·è¯·æ±‚æ—¶å°†è¿™äº›å€¼å‘é€ç»™æœåŠ¡å™¨ç«¯ã€‚æœåŠ¡å™¨ç«¯ä½¿ç”¨ç›¸åŒçš„æ–¹å¼å¯¹éšæœºå€¼è¿›è¡Œè®¡ç®—ä»¥åŠMD5åŠ å¯†ï¼Œå¦‚æœæœåŠ¡å™¨ç«¯å¾—åˆ°çš„MD5å€¼ä¸å‰ç«¯æäº¤çš„MD5å€¼ç›¸åŒï¼Œå°±ä»£è¡¨æ—¶æ­£å¸¸è¯·æ±‚ï¼Œå¦åˆ™è¿”å›erroræˆ–è€…403. def sign(value): sign_v = hashlib.md5(value.encode(encoding=\u0026#34;utf-8\u0026#34;)).hexdigest() return sign_v XXæ³•é™¢ç½‘ æµè§ˆå™¨å¼€å‘è€…æ¨¡å¼æ–­ç‚¹è°ƒè¯•, åˆ†æç”Ÿæˆç­¾åçš„jsç›¸å…³ä»£ç , æ¼«é•¿çš„åˆ†æ, åˆ†ææ­¥éª¤çœç•¥\u0026hellip; PYä»£ç  pythonè°ƒç”¨js, ç”Ÿæˆsignç­¾å import hashlib import execjs import time # 10ä½æ•°æ—¶é—´æˆ³ t = int(time.time()) with open(\u0026#39;./chinacourt_sign.js\u0026#39;, \u0026#39;r\u0026#39;, encoding=\u0026#39;UTF-8\u0026#39;) as f: js = f.read() params = { \u0026#34;page\u0026#34;: 1, \u0026#34;level\u0026#34;: 3, \u0026#34;limit\u0026#34;: 50, \u0026#34;startTime\u0026#34;: \u0026#34;2021-01-26\u0026#34;, \u0026#34;endTime\u0026#34;: \u0026#34;2021-02-25\u0026#34;, \u0026#34;versionNumber\u0026#34;: \u0026#34;wap-v1\u0026#34; } ctx = execjs.compile(js) data = ctx.call(\u0026#34;MD5\u0026#34;, params, t) print(data) è¾“å‡º 1614253292 {\u0026#39;page\u0026#39;: 1, \u0026#39;level\u0026#39;: 3, \u0026#39;limit\u0026#39;: 50, \u0026#39;startTime\u0026#39;: \u0026#39;2021-01-26\u0026#39;, \u0026#39;endTime\u0026#39;: \u0026#39;2021-02-25\u0026#39;, \u0026#39;versionNumber\u0026#39;: \u0026#39;wap-v1\u0026#39;, \u0026#39;signTime\u0026#39;: 1614253292, \u0026#39;sign\u0026#39;: \u0026#39;6EF27CEFAE958CE1B1244CBF39FC563B\u0026#39;} è¯·æ±‚æ¥å£æ—¶å¸¦ä¸Šsignç­¾åä¸ç›¸å…³å‚æ•° JSä»£ç  æµè§ˆå™¨åˆ†ææ•´ç†ååˆå¹¶çš„JSä»£ç , æ”¾åœ¨ä¸€ä¸ªjsæ–‡ä»¶, æ–¹ä¾¿è°ƒç”¨ function MD5(params, t) { var signParam = \u0026#34;\u0026#34;; // æœ€ç»ˆçš„sign var bandParam = \u0026#34;478226dd02d159fb0c6d7fc675629a12f8723ecd\u0026#34;; var versionNumber = \u0026#34;wap-v1\u0026#34;; // params[\u0026#34;bandParam\u0026#34;] = bandParam; params[\u0026#34;versionNumber\u0026#34;] = versionNumber; params[\u0026#34;signTime\u0026#34;] = t; var sign = bandParam; var newData = [] for (var item in params) { newData.push(item); } newData.sort() for (var i = 0; i \u0026lt; newData.length; i++) { if ( Object.prototype.toString.call(params[newData[i]]) !== \u0026#34;[object Array]\u0026#34; \u0026amp;\u0026amp; Object.prototype.toString.call(params[newData[i]]) !== \u0026#34;[object Object]\u0026#34; ) { if (newData[i] !== \u0026#34;sign\u0026#34;) { sign += newData[i] + params[newData[i]]; } } } sign += bandParam; signParam = md5(sign).toUpperCase(); params[\u0026#34;sign\u0026#34;] = signParam; return params; }; function safeAdd(x, y) { var lsw = (x \u0026amp; 0xffff) + (y \u0026amp; 0xffff); var msw = (x \u0026gt;\u0026gt; 16) + (y \u0026gt;\u0026gt; 16) + (lsw \u0026gt;\u0026gt; 16); return (msw \u0026lt;\u0026lt; 16) | (lsw \u0026amp; 0xffff); } /* * Bitwise rotate a 32-bit number to the left. */ function bitRotateLeft(num, cnt) { return (num \u0026lt;\u0026lt; cnt) | (num \u0026gt;\u0026gt;\u0026gt; (32 - cnt)); } /* * These functions implement the four basic operations the algorithm uses. */ function md5cmn(q, a, b, x, s, t) { return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b); } function md5ff(a, b, c, d, x, s, t) { return md5cmn((b \u0026amp; c) | (~b \u0026amp; d), a, b, x, s, t); } function md5gg(a, b, c, d, x, s, t) { return md5cmn((b \u0026amp; d) | (c \u0026amp; ~d), a, b, x, s, t); } function md5hh(a, b, c, d, x, s, t) { return md5cmn(b ^ c ^ d, a, b, x, s, t); } function md5ii(a, b, c, d, x, s, t) { return md5cmn(c ^ (b | ~d), a, b, x, s, t); } /* * Calculate the MD5 of an array of little-endian words, and a bit length. */ function binlMD5(x, len) { /* append padding */ x[len \u0026gt;\u0026gt; 5] |= 0x80 \u0026lt;\u0026lt; len % 32; x[(((len + 64) \u0026gt;\u0026gt;\u0026gt; 9) \u0026lt;\u0026lt; 4) + 14] = len; var i; var olda; var oldb; var oldc; var oldd; var a = 1732584193; var b = -271733879; var c = -1732584194; var d = 271733878; for (i = 0; i \u0026lt; x.length; i += 16) { olda = a; oldb = b; oldc = c; oldd = d; a = md5ff(a, b, c, d, x[i], 7, -680876936); d = md5ff(d, a, b, c, x[i + 1], 12, -389564586); c = md5ff(c, d, a, b, x[i + 2], 17, 606105819); b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330); a = md5ff(a, b, c, d, x[i + 4], 7, -176418897); d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426); c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341); b = md5ff(b, c, d, a, x[i + 7], 22, -45705983); a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416); d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417); c = md5ff(c, d, a, b, x[i + 10], 17, -42063); b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162); a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682); d = md5ff(d, a, b, c, x[i + 13], 12, -40341101); c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290); b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329); a = md5gg(a, b, c, d, x[i + 1], 5, -165796510); d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632); c = md5gg(c, d, a, b, x[i + 11], 14, 643717713); b = md5gg(b, c, d, a, x[i], 20, -373897302); a = md5gg(a, b, c, d, x[i + 5], 5, -701558691); d = md5gg(d, a, b, c, x[i + 10], 9, 38016083); c = md5gg(c, d, a, b, x[i + 15], 14, -660478335); b = md5gg(b, c, d, a, x[i + 4], 20, -405537848); a = md5gg(a, b, c, d, x[i + 9], 5, 568446438); d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690); c = md5gg(c, d, a, b, x[i + 3], 14, -187363961); b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501); a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467); d = md5gg(d, a, b, c, x[i + 2], 9, -51403784); c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473); b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734); a = md5hh(a, b, c, d, x[i + 5], 4, -378558); d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463); c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562); b = md5hh(b, c, d, a, x[i + 14], 23, -35309556); a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060); d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353); c = md5hh(c, d, a, b, x[i + 7], 16, -155497632); b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640); a = md5hh(a, b, c, d, x[i + 13], 4, 681279174); d = md5hh(d, a, b, c, x[i], 11, -358537222); c = md5hh(c, d, a, b, x[i + 3], 16, -722521979); b = md5hh(b, c, d, a, x[i + 6], 23, 76029189); a = md5hh(a, b, c, d, x[i + 9], 4, -640364487); d = md5hh(d, a, b, c, x[i + 12], 11, -421815835); c = md5hh(c, d, a, b, x[i + 15], 16, 530742520); b = md5hh(b, c, d, a, x[i + 2], 23, -995338651); a = md5ii(a, b, c, d, x[i], 6, -198630844); d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415); c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905); b = md5ii(b, c, d, a, x[i + 5], 21, -57434055); a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571); d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606); c = md5ii(c, d, a, b, x[i + 10], 15, -1051523); b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799); a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359); d = md5ii(d, a, b, c, x[i + 15], 10, -30611744); c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380); b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649); a = md5ii(a, b, c, d, x[i + 4], 6, -145523070); d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379); c = md5ii(c, d, a, b, x[i + 2], 15, 718787259); b = md5ii(b, c, d, a, x[i + 9], 21, -343485551); a = safeAdd(a, olda); b = safeAdd(b, oldb); c = safeAdd(c, oldc); d = safeAdd(d, oldd); } return [a, b, c, d]; } /* * Convert an array of little-endian words to a string */ function binl2rstr(input) { var i; var output = \u0026#34;\u0026#34;; var length32 = input.length * 32; for (i = 0; i \u0026lt; length32; i += 8) { output += String.fromCharCode((input[i \u0026gt;\u0026gt; 5] \u0026gt;\u0026gt;\u0026gt; i % 32) \u0026amp; 0xff); } return output; } /* * Convert a raw string to an array of little-endian words * Characters \u0026gt;255 have their high-byte silently ignored. */ function rstr2binl(input) { var i; var output = []; output[(input.length \u0026gt;\u0026gt; 2) - 1] = undefined; for (i = 0; i \u0026lt; output.length; i += 1) { output[i] = 0; } var length8 = input.length * 8; for (i = 0; i \u0026lt; length8; i += 8) { output[i \u0026gt;\u0026gt; 5] |= (input.charCodeAt(i / 8) \u0026amp; 0xff) \u0026lt;\u0026lt; i % 32; } return output; } /* * Calculate the MD5 of a raw string */ function rstrMD5(s) { return binl2rstr(binlMD5(rstr2binl(s), s.length * 8)); } /* * Calculate the HMAC-MD5, of a key and some data (raw strings) */ function rstrHMACMD5(key, data) { var i; var bkey = rstr2binl(key); var ipad = []; var opad = []; var hash; ipad[15] = opad[15] = undefined; if (bkey.length \u0026gt; 16) { bkey = binlMD5(bkey, key.length * 8); } for (i = 0; i \u0026lt; 16; i += 1) { ipad[i] = bkey[i] ^ 0x36363636; opad[i] = bkey[i] ^ 0x5c5c5c5c; } hash = binlMD5(ipad.concat(rstr2binl(data)), 512 + data.length * 8); return binl2rstr(binlMD5(opad.concat(hash), 512 + 128)); } /* * Convert a raw string to a hex string */ function rstr2hex(input) { var hexTab = \u0026#34;0123456789abcdef\u0026#34;; var output = \u0026#34;\u0026#34;; var x; var i; for (i = 0; i \u0026lt; input.length; i += 1) { x = input.charCodeAt(i); output += hexTab.charAt((x \u0026gt;\u0026gt;\u0026gt; 4) \u0026amp; 0x0f) + hexTab.charAt(x \u0026amp; 0x0f); } return output; } /* * Encode a string as utf-8 */ function str2rstrUTF8(input) { return unescape(encodeURIComponent(input)); } /* * Take string arguments and return either raw or hex encoded strings */ function rawMD5(s) { return rstrMD5(str2rstrUTF8(s)); } function hexMD5(s) { return rstr2hex(rawMD5(s)); } function rawHMACMD5(k, d) { return rstrHMACMD5(str2rstrUTF8(k), str2rstrUTF8(d)); } function hexHMACMD5(k, d) { return rstr2hex(rawHMACMD5(k, d)); } function md5(string, key, raw) { if (!key) { if (!raw) { return hexMD5(string); } return rawMD5(string); } if (!raw) { return hexHMACMD5(key, string); } return rawHMACMD5(key, string); } if (typeof define === \u0026#34;function\u0026#34; \u0026amp;\u0026amp; define.amd) { define(function () { return md5; }); } else if (typeof module === \u0026#34;object\u0026#34; \u0026amp;\u0026amp; module.exports) { module.exports = md5; } else { $.md5 = md5; } ","permalink":"https://www.chenzqi.cn/posts/2020/20200810_%E7%A0%B4%E8%A7%A3%E6%9F%90%E6%B3%95%E9%99%A2%E7%BD%91sign%E7%AD%BE%E5%90%8D/","tags":["çˆ¬è™«","è§£å¯†"],"title":"ç ´è§£æŸæ³•é™¢ç½‘signç­¾å"},{"categories":[2020,"æŠ€æœ¯"],"contents":"::: tip Qt designer å’Œ ä»£ç è¿›è¡Œ Qt å¼€å‘å®ç°é¡µé¢è·³è½¬ä¸åŒï¼Œæœ¬æ–‡è®°å½• designer å¼€å‘ ::: PyQt5 å¤šé¡µé¢è·³è½¬ å€ŸåŠ©ä¸€ä¸ª Controller æ§åˆ¶å™¨æ¥å®ç°ï¼Œå¤§ä½“æ€è·¯å¦‚ä¸‹ # åˆ©ç”¨ä¸€ä¸ªæ§åˆ¶å™¨æ¥æ§åˆ¶é¡µé¢çš„è·³è½¬ class Controller: def __init__(self): pass def show_A(self): # åˆ›å»º A çª—å£å¯¹è±¡å¹¶æ˜¾ç¤º # å…³é—­å…¶ä½™çª—å£å¯¹è±¡ def show_B(self): # åˆ›å»º B çª—å£å¯¹è±¡å¹¶æ˜¾ç¤º # å…³é—­å…¶ä½™çª—å£å¯¹è±¡ def show_C(self): # åˆ›å»º C çª—å£å¯¹è±¡å¹¶æ˜¾ç¤º # å…³é—­å…¶ä½™çª—å£å¯¹è±¡ æƒ…æ™¯: ç”¨ Qt designer è®¾è®¡ä¸‰ä¸ªé¡µé¢ï¼šhello.pyã€login.pyã€operate.py hello.py ä¸­æœ‰ä¸€ä¸ª Id ä¸º loginBuuton çš„æŒ‰é’®ï¼Œç”¨äºè·³è½¬åˆ° login.py çª—å£ hello.py ä¸­è¿˜æœ‰ä¸€ä¸ª Id ä¸º operateButton çš„æŒ‰é’®ï¼Œç”¨äºè·³è½¬åˆ° operate.py çª—å£ ä»£ç ç¼–å†™ å¯¼å…¥éœ€è¦çš„æ¨¡å—ï¼šç³»ç»Ÿæ¨¡å— å’Œ åˆ©ç”¨designerè®¾è®¡çš„é¡µé¢ import sys from PyQt5 import QtCore, QtWidgets, QtCore # å¯¼å…¥ Qt designer è®¾è®¡çš„é¡µé¢ from hello import Ui_MainWindow as Hello_Ui from login import Ui_MainWindow as Login_Ui from operate import Ui_MainWindow as Operate_Ui å†™é¡µé¢å¯¹åº”çš„çª—å£ç±»ï¼Œå®ç° ä¸€ä¸ªé¡µé¢å¾€å…¶ä»–é¡µé¢çš„è·³è½¬ï¼› å®ç°è·³è½¬çš„é€»è¾‘ä¸»è¦éƒ½åœ¨ HelloWindow ç±»ä¸­ï¼Œå…¶ä»–çª—å£ç±»ä»…ä»…åšäº†åˆå§‹åŒ–ï¼š # ä¸»çª—å£ class HelloWindow(QtWidgets.QMainWindow, Hello_Ui): switch_window1 = QtCore.pyqtSignal() # è·³è½¬ä¿¡å· switch_window2 = QtCore.pyqtSignal() # è·³è½¬ä¿¡å· def __init__(self): super(HelloWindow, self).__init__() self.setupUi(self) self.queryButton.clicked.connect(self.goOperate) self.manageButton.clicked.connect(self.goLogin) def goLogin(self): self.switch_window1.emit() def goOperate(self): self.switch_window2.emit() # ç™»å½•çª—å£ class LoginWindow(QtWidgets.QMainWindow, Login_Ui): def __init__(self): super(LoginWindow, self).__init__() self.setupUi(self) # æ“ä½œçª—å£ class OperateWindow(QtWidgets.QMainWindow, Operate_Ui): def __init__(self): super(OperateWindow, self).__init__() self.setupUi(self) æ§åˆ¶å™¨ç”¨æ¥æ§åˆ¶é¡µé¢çš„è·³è½¬ï¼š # åˆ©ç”¨ä¸€ä¸ªæ§åˆ¶å™¨æ¥æ§åˆ¶é¡µé¢çš„è·³è½¬ class Controller: def __init__(self): pass # è·³è½¬åˆ° hello çª—å£ def show_hello(self): self.hello = HelloWindow() self.hello.switch_window1.connect(self.show_login) self.hello.switch_window2.connect(self.show_operate) self.hello.show() # è·³è½¬åˆ° login çª—å£, æ³¨æ„å…³é—­åŸé¡µé¢ def show_login(self): self.login = LoginWindow() self.hello.close() self.login.show() # è·³è½¬åˆ° operate çª—å£, æ³¨æ„å…³é—­åŸé¡µé¢ def show_operate(self): self.operate = OperateWindow() self.hello.close() self.operate.show() å¯åŠ¨é¡¹ç›®: def main(): app = QtWidgets.QApplication(sys.argv) controller = Controller() # æ§åˆ¶å™¨å®ä¾‹ controller.show_hello() # é»˜è®¤å±•ç¤ºçš„æ˜¯ hello é¡µé¢ sys.exit(app.exec_()) if __name__ == \u0026#39;__main__\u0026#39;: main() ","permalink":"https://www.chenzqi.cn/posts/2020/20200720_pyqt5%E5%A4%9A%E9%A1%B5%E9%9D%A2%E8%B7%B3%E8%BD%AC/","tags":["python","mysql"],"title":"PyQt5å¤šé¡µé¢è·³è½¬"},{"categories":[2020,"æŠ€æœ¯"],"contents":"::: tip æ¯æ¬¡è¿æ¥mysqlæ•°æ®åº“è¯·æ±‚æ—¶ï¼Œéƒ½æ˜¯ç‹¬ç«‹çš„å»è¯·æ±‚è®¿é—®ï¼Œæµªè´¹èµ„æºï¼Œè®¿é—®æ•°é‡è¾¾åˆ°ä¸€å®šæ•°é‡æ—¶ï¼Œå¯¹mysqlçš„æ€§èƒ½ä¼šäº§ç”Ÿè¾ƒå¤§çš„å½±å“ã€‚å› æ­¤ï¼Œé€šå¸¸ä¼šä½¿ç”¨æ•°æ®åº“çš„è¿æ¥æ± æŠ€æœ¯ï¼Œæ¥è®¿é—®æ•°æ®åº“è¾¾åˆ°èµ„æºå¤ç”¨çš„ç›®çš„ã€‚ ::: DBUtils DBUtilsæ˜¯ä¸€å¥—Pythonæ•°æ®åº“è¿æ¥æ± åŒ…ï¼Œå¹¶å…è®¸å¯¹éçº¿ç¨‹å®‰å…¨çš„æ•°æ®åº“æ¥å£è¿›è¡Œçº¿ç¨‹å®‰å…¨åŒ…è£… DBUtilsæ¥å£ PersistentDB ï¼šæä¾›çº¿ç¨‹ä¸“ç”¨çš„æ•°æ®åº“è¿æ¥ï¼Œå¹¶è‡ªåŠ¨ç®¡ç†è¿æ¥ã€‚ PooledDB ï¼šæä¾›çº¿ç¨‹é—´å¯å…±äº«çš„æ•°æ®åº“è¿æ¥ï¼Œå¹¶è‡ªåŠ¨ç®¡ç†è¿æ¥ã€‚ ä¸‹è½½DBUtils DBUtils å®ç° MySqlConn #!/usr/bin/env python # -*- coding:utf-8 -*- \u0026#34;\u0026#34;\u0026#34; @file: MySqlConn.py @time: @desc: None @Author: Chenzq @Wechat: 15690833097 @contact: czq181020@gmail.com \u0026#34;\u0026#34;\u0026#34; \u0026#34;\u0026#34;\u0026#34; 1ã€æ‰§è¡Œå¸¦å‚æ•°çš„ï¼³ï¼±ï¼¬æ—¶ï¼Œè¯·å…ˆç”¨sqlè¯­å¥æŒ‡å®šéœ€è¦è¾“å…¥çš„æ¡ä»¶åˆ—è¡¨ï¼Œç„¶åå†ç”¨tuple/listè¿›è¡Œæ¡ä»¶æ‰¹é… ï¼’ã€åœ¨æ ¼å¼ï¼³ï¼±ï¼¬ä¸­ä¸éœ€è¦ä½¿ç”¨å¼•å·æŒ‡å®šæ•°æ®ç±»å‹ï¼Œç³»ç»Ÿä¼šæ ¹æ®è¾“å…¥å‚æ•°è‡ªåŠ¨è¯†åˆ« ï¼“ã€åœ¨è¾“å…¥çš„å€¼ä¸­ä¸éœ€è¦ä½¿ç”¨è½¬æ„å‡½æ•°ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç† \u0026#34;\u0026#34;\u0026#34; import pymysql from pymysql.cursors import DictCursor from DBUtils.PooledDB import PooledDB from . import Config class Mysql(object): \u0026#34;\u0026#34;\u0026#34; MYSQLæ•°æ®åº“å¯¹è±¡ï¼Œè´Ÿè´£äº§ç”Ÿæ•°æ®åº“è¿æ¥ , æ­¤ç±»ä¸­çš„è¿æ¥é‡‡ç”¨è¿æ¥æ± å®ç°è·å–è¿æ¥å¯¹è±¡ï¼šconn = Mysql.getConn() é‡Šæ”¾è¿æ¥å¯¹è±¡;conn.close()æˆ–del conn \u0026#34;\u0026#34;\u0026#34; # è¿æ¥æ± å¯¹è±¡ __pool = None def __init__(self): # æ•°æ®åº“æ„é€ å‡½æ•°ï¼Œä»è¿æ¥æ± ä¸­å–å‡ºè¿æ¥ï¼Œå¹¶ç”Ÿæˆæ“ä½œæ¸¸æ ‡ self._conn = Mysql.__getConn() self._cursor = self._conn.cursor() @staticmethod def __getConn(): \u0026#34;\u0026#34;\u0026#34; @summary: é™æ€æ–¹æ³•ï¼Œä»è¿æ¥æ± ä¸­å–å‡ºè¿æ¥ @return MySQLdb.connection \u0026#34;\u0026#34;\u0026#34; if Mysql.__pool is None: __pool = PooledDB(creator=pymysql, mincached=1, maxcached=20, host=Config.MYSQL_HOST, port=Config.MYSQL_PORT, user=Config.MYSQL_USER, passwd=Config.MYSQL_PASSWORD, db=\u0026#34;rongyipai\u0026#34;, use_unicode=False, charset=Config.MYSQL_CHARSET, cursorclass=DictCursor) return __pool.connection() def getAll(self, sql, param=None): \u0026#34;\u0026#34;\u0026#34; @summary: æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶å–å‡ºæ‰€æœ‰ç»“æœé›† @param sql:æŸ¥è¯¢ï¼³ï¼±ï¼¬ï¼Œå¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œè¯·åªæŒ‡å®šæ¡ä»¶åˆ—è¡¨ï¼Œå¹¶å°†æ¡ä»¶å€¼ä½¿ç”¨å‚æ•°[param]ä¼ é€’è¿›æ¥ @param param: å¯é€‰å‚æ•°ï¼Œæ¡ä»¶åˆ—è¡¨å€¼ï¼ˆå…ƒç»„/åˆ—è¡¨ï¼‰ @return: result list(å­—å…¸å¯¹è±¡)/boolean æŸ¥è¯¢åˆ°çš„ç»“æœé›† \u0026#34;\u0026#34;\u0026#34; if param is None: count = self._cursor.execute(sql) else: count = self._cursor.execute(sql, param) if count \u0026gt; 0: result = self._cursor.fetchall() else: result = False return result def getOne(self, sql, param=None): \u0026#34;\u0026#34;\u0026#34; @summary: æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶å–å‡ºç¬¬ä¸€æ¡ @param sql:æŸ¥è¯¢ï¼³ï¼±ï¼¬ï¼Œå¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œè¯·åªæŒ‡å®šæ¡ä»¶åˆ—è¡¨ï¼Œå¹¶å°†æ¡ä»¶å€¼ä½¿ç”¨å‚æ•°[param]ä¼ é€’è¿›æ¥ @param param: å¯é€‰å‚æ•°ï¼Œæ¡ä»¶åˆ—è¡¨å€¼ï¼ˆå…ƒç»„/åˆ—è¡¨ï¼‰ @return: result list/boolean æŸ¥è¯¢åˆ°çš„ç»“æœé›† \u0026#34;\u0026#34;\u0026#34; if param is None: count = self._cursor.execute(sql) else: count = self._cursor.execute(sql, param) if count \u0026gt; 0: result = self._cursor.fetchone() else: result = False return result def getMany(self, sql, num, param=None): \u0026#34;\u0026#34;\u0026#34; @summary: æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶å–å‡ºnumæ¡ç»“æœ @param sql:æŸ¥è¯¢ï¼³ï¼±ï¼¬ï¼Œå¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œè¯·åªæŒ‡å®šæ¡ä»¶åˆ—è¡¨ï¼Œå¹¶å°†æ¡ä»¶å€¼ä½¿ç”¨å‚æ•°[param]ä¼ é€’è¿›æ¥ @param num:å–å¾—çš„ç»“æœæ¡æ•° @param param: å¯é€‰å‚æ•°ï¼Œæ¡ä»¶åˆ—è¡¨å€¼ï¼ˆå…ƒç»„/åˆ—è¡¨ï¼‰ @return: result list/boolean æŸ¥è¯¢åˆ°çš„ç»“æœé›† \u0026#34;\u0026#34;\u0026#34; if param is None: count = self._cursor.execute(sql) else: count = self._cursor.execute(sql, param) if count \u0026gt; 0: result = self._cursor.fetchmany(num) else: result = False return result def insertOne(self, sql, value): \u0026#34;\u0026#34;\u0026#34; @summary: å‘æ•°æ®è¡¨æ’å…¥ä¸€æ¡è®°å½• @param sql:è¦æ’å…¥çš„ï¼³ï¼±ï¼¬æ ¼å¼ @param value:è¦æ’å…¥çš„è®°å½•æ•°æ®tuple/list @return: insertId å—å½±å“çš„è¡Œæ•° \u0026#34;\u0026#34;\u0026#34; self._cursor.execute(sql, value) return self.__getInsertId() def insertMany(self, sql, values): \u0026#34;\u0026#34;\u0026#34; @summary: å‘æ•°æ®è¡¨æ’å…¥å¤šæ¡è®°å½• @param sql:è¦æ’å…¥çš„ï¼³ï¼±ï¼¬æ ¼å¼ @param values:è¦æ’å…¥çš„è®°å½•æ•°æ®tuple(tuple)/list[list] @return: count å—å½±å“çš„è¡Œæ•° \u0026#34;\u0026#34;\u0026#34; count = self._cursor.executemany(sql, values) return count def __getInsertId(self): \u0026#34;\u0026#34;\u0026#34; è·å–å½“å‰è¿æ¥æœ€åä¸€æ¬¡æ’å…¥æ“ä½œç”Ÿæˆçš„id,å¦‚æœæ²¡æœ‰åˆ™ä¸ºï¼ \u0026#34;\u0026#34;\u0026#34; self._cursor.execute(\u0026#34;SELECT @@IDENTITY AS id\u0026#34;) result = self._cursor.fetchall() return result[0][\u0026#39;id\u0026#39;] def __query(self, sql, param=None): if param is None: count = self._cursor.execute(sql) else: count = self._cursor.execute(sql, param) return count def update(self, sql, param=None): \u0026#34;\u0026#34;\u0026#34; @summary: æ›´æ–°æ•°æ®è¡¨è®°å½• @param sql: ï¼³ï¼±ï¼¬æ ¼å¼åŠæ¡ä»¶ï¼Œä½¿ç”¨(%s,%s) @param param: è¦æ›´æ–°çš„ å€¼ tuple/list @return: count å—å½±å“çš„è¡Œæ•° \u0026#34;\u0026#34;\u0026#34; return self.__query(sql, param) def delete(self, sql, param=None): \u0026#34;\u0026#34;\u0026#34; @summary: åˆ é™¤æ•°æ®è¡¨è®°å½• @param sql: ï¼³ï¼±ï¼¬æ ¼å¼åŠæ¡ä»¶ï¼Œä½¿ç”¨(%s,%s) @param param: è¦åˆ é™¤çš„æ¡ä»¶ å€¼ tuple/list @return: count å—å½±å“çš„è¡Œæ•° \u0026#34;\u0026#34;\u0026#34; return self.__query(sql, param) def begin(self): \u0026#34;\u0026#34;\u0026#34; @summary: å¼€å¯äº‹åŠ¡ \u0026#34;\u0026#34;\u0026#34; self._conn.autocommit(0) def end(self, option=\u0026#39;commit\u0026#39;): \u0026#34;\u0026#34;\u0026#34; @summary: ç»“æŸäº‹åŠ¡ \u0026#34;\u0026#34;\u0026#34; if option == \u0026#39;commit\u0026#39;: self._conn.commit() else: self._conn.rollback() def dispose(self, isEnd=1): \u0026#34;\u0026#34;\u0026#34; @summary: é‡Šæ”¾è¿æ¥æ± èµ„æº \u0026#34;\u0026#34;\u0026#34; if isEnd == 1: self.end(\u0026#39;commit\u0026#39;) else: self.end(\u0026#39;rollback\u0026#39;); self._cursor.close() self._conn.close() if __name__==\u0026#34;__main__\u0026#34;: mysql = Mysql() Config #!/usr/bin/env python # -*- coding:utf-8 -*- \u0026#34;\u0026#34;\u0026#34; @file: Config.py @desc: None @Author: Chenzq @Wechat: 15690833097 @contact: czq181020@gmail.com \u0026#34;\u0026#34;\u0026#34; MYSQL_HOST = \u0026#39;127.0.0.1\u0026#39; MYSQL_USER = \u0026#39;root\u0026#39; MYSQL_PASSWORD = \u0026#39;123456\u0026#39; MYSQL_DATABASE = \u0026#39;database\u0026#39; MYSQL_PORT = 3306 MYSQL_CHARSET = \u0026#39;utf8\u0026#39; test #coding:utf-8 from MySqlConn import Mysql from _sqlite3 import Row #ç”³è¯·èµ„æº mysql = Mysql() sqlAll = \u0026#34;SELECT tb.uid as uid, group_concat(tb.goodsname) as goodsname FROM ( SELECT goods.uid AS uid, IF ( ISNULL(goodsrelation.goodsname), goods.goodsID, goodsrelation.goodsname ) AS goodsname FROM goods LEFT JOIN goodsrelation ON goods.goodsID = goodsrelation.goodsId ) tb GROUP BY tb.uid\u0026#34; result = mysql.getAll(sqlAll) if result : print \u0026#34;get all\u0026#34; for row in result : print \u0026#34;%s\\t%s\u0026#34;%(row[\u0026#34;uid\u0026#34;],row[\u0026#34;goodsname\u0026#34;]) sqlAll = \u0026#34;SELECT tb.uid as uid, group_concat(tb.goodsname) as goodsname FROM ( SELECT goods.uid AS uid, IF ( ISNULL(goodsrelation.goodsname), goods.goodsID, goodsrelation.goodsname ) AS goodsname FROM goods LEFT JOIN goodsrelation ON goods.goodsID = goodsrelation.goodsId ) tb GROUP BY tb.uid\u0026#34; result = mysql.getMany(sqlAll,2) if result : print \u0026#34;get many\u0026#34; for row in result : print \u0026#34;%s\\t%s\u0026#34;%(row[\u0026#34;uid\u0026#34;],row[\u0026#34;goodsname\u0026#34;]) result = mysql.getOne(sqlAll) print \u0026#34;get one\u0026#34; print \u0026#34;%s\\t%s\u0026#34;%(result[\u0026#34;uid\u0026#34;],result[\u0026#34;goodsname\u0026#34;]) #é‡Šæ”¾èµ„æº mysql.dispose() ","permalink":"https://www.chenzqi.cn/posts/2020/20200710_mysql%E8%BF%9E%E6%8E%A5%E6%B1%A0/","tags":["python","mysql"],"title":"MySQLè¿æ¥æ± "},{"categories":[2020,"æŠ€æœ¯"],"contents":"::: tip SQLå†™å…¥ä¸æ›´æ–°è¯­å¥ä¼˜åŒ–è®°å½• ::: æ•°æ® # è¦å†™å…¥çš„å­—å…¸æ•°æ® data_dict = dict( fzID=data.get(\u0026#39;fzID\u0026#39;), statusCode=data.get(\u0026#39;statusCode\u0026#39;), statusName=data.get(\u0026#39;statusName\u0026#39;), thumb=data.get(\u0026#34;thumb\u0026#34;), atArea=data.get(\u0026#34;atArea\u0026#34;), buildingName=data.get(\u0026#34;buildingName\u0026#34;), communityName=data.get(\u0026#34;communityName\u0026#34;), areaSize=data.get(\u0026#34;areaSize\u0026#34;), startPrice=data.get(\u0026#34;startPrice\u0026#34;), currentPrice=data.get(\u0026#34;currentPrice\u0026#34;), unitPrice=data.get(\u0026#34;unitPrice\u0026#34;), buildingType=data.get(\u0026#34;buildingType\u0026#34;), bTypeName=data.get(\u0026#34;bTypeName\u0026#34;), taxesBy=data.get(\u0026#34;taxesBy\u0026#34;), taxesName=data.get(\u0026#34;taxesName\u0026#34;), canLoan=data.get(\u0026#34;canLoan\u0026#34;), LoanText=data.get(\u0026#34;LoanText\u0026#34;), discountRate=data.get(\u0026#34;discountRate\u0026#34;), puchaseLimit=data.get(\u0026#34;puchaseLimit\u0026#34;), countyName=countyName, startTime=data.get(\u0026#34;startTime\u0026#34;), endTime=data.get(\u0026#34;endTime\u0026#34;), editDate=data.get(\u0026#34;editDate\u0026#34;), competePersons=data.get(\u0026#34;competePersons\u0026#34;), callTimes=data.get(\u0026#34;callTimes\u0026#34;), yijialv=data.get(\u0026#34;yijialv\u0026#34;), ccode=data.get(\u0026#34;ccode\u0026#34;), ajklink=data.get(\u0026#34;ajklink\u0026#34;), bemetro=data.get(\u0026#34;bemetro\u0026#34;), jiaofu=jiaofu ) # data_dict = { # \u0026#39;fzID\u0026#39;: \u0026#39;6342304417171\u0026#39;, # \u0026#39;statusCode\u0026#39;: 2, # \u0026#39;statusName\u0026#39;: \u0026#39;å³å°†å¼€å§‹\u0026#39;, # \u0026#39;thumb\u0026#39;: \u0026#39;https://img.51paimaifang.com/tb/202012/1810/tb6342304417171c00.jpg\u0026#39;, # \u0026#39;atArea\u0026#39;: \u0026#39;å¹¿ä¸œã€æ·±åœ³ã€é¾™å²—\u0026#39;, # \u0026#39;buildingName\u0026#39;: \u0026#39;æ·±åœ³å¸‚é¾™å²—é•‡ç››å¹³æ‘ä½³ç››å›­Då•å…ƒå¤å¼D803æˆ¿\u0026#39;, # \u0026#39;communityName\u0026#39;: \u0026#39;è‚²é¾™åº­\u0026#39;, # \u0026#39;areaSize\u0026#39;: 114.09, # \u0026#39;startPrice\u0026#39;: 252.9696, # \u0026#39;currentPrice\u0026#39;: 252.9696, # \u0026#39;unitPrice\u0026#39;: 2.2172810938733, # \u0026#39;buildingType\u0026#39;: 1, # \u0026#39;bTypeName\u0026#39;: \u0026#39;ä½å®…\u0026#39;, # \u0026#39;taxesBy\u0026#39;: 1, # \u0026#39;taxesName\u0026#39;: \u0026#39;ç¨è´¹å…¨åŒ…\u0026#39;, # \u0026#39;canLoan\u0026#39;: 1, # \u0026#39;LoanText\u0026#39;: \u0026#39;ä¸€é”®è´·æ¬¾\u0026#39;, # \u0026#39;discountRate\u0026#39;: 8, # \u0026#39;puchaseLimit\u0026#39;: 1, # \u0026#39;countyName\u0026#39;: \u0026#39;é¾™å²—\u0026#39;, # \u0026#39;startTime\u0026#39;: \u0026#39;2021/01/15 10:00:00\u0026#39;, # \u0026#39;endTime\u0026#39;: \u0026#39;2021/01/16 10:00:00\u0026#39;, # \u0026#39;editDate\u0026#39;: \u0026#39;2020/12/18 10:54\u0026#39;, # \u0026#39;competePersons\u0026#39;: 0, # \u0026#39;callTimes\u0026#39;: 0, # \u0026#39;yijialv\u0026#39;: -1, # \u0026#39;ccode\u0026#39;: \u0026#39;sz-2411051182955\u0026#39;, # \u0026#39;ajklink\u0026#39;: \u0026#39;https://shenzhen.anjuke.com/community/view/96690\u0026#39;, # \u0026#39;bemetro\u0026#39;: 1, # \u0026#39;jiaofu\u0026#39;: \u0026#39;äº¤ä»˜\u0026#39; # } å¸¸ç”¨æ–¹å¼ # å†™å…¥ insert_house = f\u0026#34;\u0026#34;\u0026#34; INSERT INTO houselist(fzID, statusCode, statusName, thumb, atArea, buildingName, communityName, areaSize, startPrice, currentPrice, unitPrice, buildingType, bTypeName, taxesBy, taxesName, canLoan, LoanText, discountRate, puchaseLimit, countyName, startTime, endTime, editDate, competePersons, callTimes, yijialv, ccode, ajklink, bemetro, jiaofu) VALUES ( {fzID}, {statusCode}, {statusName}, {thumb}, {atArea}, {buildingName}, {communityName}, {areaSize}, {startPrice}, {currentPrice}, {unitPrice}, {buildingType}, {bTypeName}, {taxesBy}, {taxesName}, {canLoan}, {LoanText}, {discountRate}, {puchaseLimit}, {countyName}, {startTime}, {endTime}, {editDate}, {competePersons}, {callTimes}, {yijialv}, {ccode}, {ajklink}, {bemetro}, {jiaofu} ) \u0026#34;\u0026#34;\u0026#34; # æ‰§è¡Œè¯­å¥ cursor.execute(insert_house) # æ›´æ–° update_house = f\u0026#34;\u0026#34;\u0026#34; UPDATE houselist SET fzID={fzID}, statusCode={statusCode}, statusName={statusName}, thumb={thumb}, atArea={atArea}, buildingName={buildingName}, communityName={communityName}, areaSize={areaSize}, startPrice={startPrice}, currentPrice={currentPrice}, unitPrice={unitPrice}, buildingType={buildingType}, bTypeName={bTypeName}, taxesBy={taxesBy}, taxesName={taxesName}, canLoan={canLoan}, LoanText={LoanText}, discountRate={discountRate}, puchaseLimit={puchaseLimit}, countyName={countyName}, startTime={startTime}, endTime={endTime}, editDate={editDate}, competePersons={competePersons}, callTimes={callTimes}, yijialv={yijialv}, ccode={ccode}, ajklink={ajklink}, bemetro={bemetro}, jiaofu={jiaofu} WHERE fzID={fzID} \u0026#34;\u0026#34;\u0026#34; # æ‰§è¡Œè¯­å¥ cursor.execute(update_house) é€šç”¨ä¼˜åŒ– # å†™å…¥ keys = \u0026#34;, \u0026#34;.join(data_dict.keys()) values = \u0026#39;, \u0026#39;.join([\u0026#39;%s\u0026#39;] * len(data_dict)) value = tuple([v for v in data_dict.values()]) insert_house = \u0026#39;INSERT INTO %s (%s) VALUES (%s)\u0026#39; % (\u0026#39;tablename\u0026#39;, keys, values) cursor.execute(insert_house, value) # æ›´æ–° kvs = \u0026#34;, \u0026#34;.join(list(map(lambda k: k + \u0026#34;=%s\u0026#34;, list(data_dict.keys())))) value = tuple([v for v in data_dict.values()]) update_house = \u0026#34;UPDATE %s SET %s WHERE fzID=%s\u0026#34; % (\u0026#34;tablename\u0026#34;, kvs, repr(data_dict.get(\u0026#39;fzID\u0026#39;))) cursor.execute(update_house, value) ","permalink":"https://www.chenzqi.cn/posts/2020/20200629_sql%E5%86%99%E5%85%A5%E4%B8%8E%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96/","tags":["python","mysql"],"title":"SQLå†™å…¥ä¸æ›´æ–°è¯­å¥ä¼˜åŒ–"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip æœåŠ¡å™¨ç«¯è§£å†³è·¨åŸŸé—®é¢˜: django-cors-headers ::: æ–‡æ¡£ django-cors-headers å®‰è£… pip install -i https://pypi.douban.com/simple django-cors-headers é…ç½® settings.py æ·»åŠ åˆ°å·²å®‰è£…çš„åº”ç”¨ç¨‹åºä¸­ï¼š INSTALLED_APPS = [ ... \u0026#39;corsheaders\u0026#39;ï¼Œ ... ] ç¡®ä¿æ·»åŠ ç»“å°¾é€—å·ï¼Œå¦åˆ™å¯èƒ½ä¼šæ”¶åˆ°ä¸€ä¸ªé€—å·ModuleNotFoundError æ·»åŠ ä¸€ä¸ªä¸­é—´ä»¶ç±»æ¥ä¾¦å¬å“åº”ï¼š MIDDLEWARE = [ ... \u0026#39;corsheaders.middleware.CorsMiddleware\u0026#39;, \u0026#39;django.middleware.common.CommonMiddleware\u0026#39;, ... ] CorsMiddlewareåº”è¯¥æ”¾ç½®åœ¨å°½å¯èƒ½é«˜çš„ä½ç½®ï¼Œå°¤å…¶æ˜¯åœ¨å¯ä»¥ç”Ÿæˆå“åº”çš„ä»»ä½•ä¸­é—´ä»¶ä¹‹å‰ è®¾ç½® CORS_ALLOW_ALL_ORIGINS CORS_ALLOW_ALL_ORIGINS = True å¦‚æœä¸ºTrueï¼Œåˆ™å°†å…è®¸æ‰€æœ‰æ¥æºã€‚é™åˆ¶å…è®¸çš„åŸç‚¹çš„å…¶ä»–è®¾ç½®å°†è¢«å¿½ç•¥ã€‚é»˜è®¤ä¸ºFalseã€‚ å°†å…¶è®¾ç½®ä¸ºTrueå¯èƒ½å¾ˆå±é™©ï¼Œå› ä¸ºå®ƒå…è®¸ä»»ä½•ç½‘ç«™å‘æ‚¨çš„ç½‘ç«™å‘å‡ºè·¨åŸŸè¯·æ±‚ã€‚ é€šå¸¸ï¼Œéœ€è¦ä½¿ç”¨CORS_ALLOWED_ORIGINSæˆ– é™åˆ¶å…è®¸çš„æ¥æºåˆ—è¡¨CORS_ALLOWED_ORIGIN_REGEXESã€‚ æ—§ç‰ˆæ­¤è®¾ç½®ç§°ä¸º CORS_ORIGIN_ALLOW_ALLï¼Œä»ç„¶å¯ä»¥ç”¨ä½œåˆ«åï¼Œæ–°åç§°ä¼˜å…ˆã€‚ ","permalink":"https://www.chenzqi.cn/posts/2020/20200625_django%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%B7%A8%E5%9F%9F/","tags":["æ¡†æ¶","Django","web"],"title":"DjangoæœåŠ¡å™¨ç«¯è·¨åŸŸ"},{"categories":[2020,"æŠ€æœ¯"],"contents":"::: tip æµè¡Œçš„è·¨åŸŸè®¤è¯è§£å†³æ–¹æ¡ˆ, JWTåŸç†å’Œç”¨æ³• ::: JWT ::: tip Json web token (JWT), æ˜¯ä¸ºäº†åœ¨ç½‘ç»œåº”ç”¨ç¯å¢ƒé—´ä¼ é€’å£°æ˜è€Œæ‰§è¡Œçš„ä¸€ç§åŸºäºJSONçš„å¼€æ”¾æ ‡å‡†ï¼ˆ(RFC 7519).è¯¥tokenè¢«è®¾è®¡ä¸ºç´§å‡‘ä¸”å®‰å…¨çš„ï¼Œç‰¹åˆ«é€‚ç”¨äºåˆ†å¸ƒå¼ç«™ç‚¹çš„å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰åœºæ™¯ã€‚JWTçš„å£°æ˜ä¸€èˆ¬è¢«ç”¨æ¥åœ¨èº«ä»½æä¾›è€…å’ŒæœåŠ¡æä¾›è€…é—´ä¼ é€’è¢«è®¤è¯çš„ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œä»¥ä¾¿äºä»èµ„æºæœåŠ¡å™¨è·å–èµ„æºï¼Œä¹Ÿå¯ä»¥å¢åŠ ä¸€äº›é¢å¤–çš„å…¶å®ƒä¸šåŠ¡é€»è¾‘æ‰€å¿…é¡»çš„å£°æ˜ä¿¡æ¯ï¼Œè¯¥tokenä¹Ÿå¯ç›´æ¥è¢«ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯è¢«åŠ å¯†ã€‚ ::: ä¼ ç»Ÿsessionè®¤è¯ äº’è”ç½‘æœåŠ¡ç¦»ä¸å¼€ç”¨æˆ·è®¤è¯, ä¸€èˆ¬æµç¨‹ ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€ç”¨æˆ·åå’Œå¯†ç ã€‚ æœåŠ¡å™¨éªŒè¯é€šè¿‡åï¼Œåœ¨å½“å‰å¯¹è¯ï¼ˆsessionï¼‰é‡Œé¢ä¿å­˜ç›¸å…³æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·è§’è‰².ç™»å½•æ—¶é—´ç­‰ç­‰ã€‚ æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›ä¸€ä¸ª session_idï¼Œå†™å…¥ç”¨æˆ·çš„ Cookieã€‚ ç”¨æˆ·éšåçš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½ä¼šé€šè¿‡ Cookieï¼Œå°† session_id ä¼ å›æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨æ”¶åˆ° session_idï¼Œæ‰¾åˆ°å‰æœŸä¿å­˜çš„æ•°æ®ï¼Œç”±æ­¤å¾—çŸ¥ç”¨æˆ·çš„èº«ä»½ã€‚ ::: warning è¿™ç§æ¨¡å¼çš„é—®é¢˜åœ¨äºï¼Œæ‰©å±•æ€§ï¼ˆscalingï¼‰ä¸å¥½ã€‚å•æœºæ²¡æœ‰é—®é¢˜ï¼Œå¦‚æœæœåŠ¡å™¨é›†ç¾¤ï¼Œæˆ–è€…è·¨åŸŸçš„æœåŠ¡å¯¼å‘æ¶æ„ï¼Œå°±è¦æ±‚ session æ•°æ®å…±äº«ï¼Œæ¯å°æœåŠ¡å™¨éƒ½èƒ½å¤Ÿè¯»å– sessionã€‚ ::: ::: details ä¸¾ä¾‹ï¼ŒA ç½‘ç«™å’Œ B ç½‘ç«™æ˜¯åŒä¸€å®¶å…¬å¸çš„å…³è”æœåŠ¡ã€‚ç°åœ¨è¦æ±‚ï¼Œç”¨æˆ·åªè¦åœ¨å…¶ä¸­ä¸€ä¸ªç½‘ç«™ç™»å½•ï¼Œå†è®¿é—®å¦ä¸€ä¸ªç½‘ç«™å°±ä¼šè‡ªåŠ¨ç™»å½•ï¼Œè¯·é—®æ€ä¹ˆå®ç°ï¼Ÿ ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ session æ•°æ®æŒä¹…åŒ–ï¼Œå†™å…¥æ•°æ®åº“æˆ–åˆ«çš„æŒä¹…å±‚ã€‚å„ç§æœåŠ¡æ”¶åˆ°è¯·æ±‚åï¼Œéƒ½å‘æŒä¹…å±‚è¯·æ±‚æ•°æ®ã€‚è¿™ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯æ¶æ„æ¸…æ™°ï¼Œç¼ºç‚¹æ˜¯å·¥ç¨‹é‡æ¯”è¾ƒå¤§ã€‚å¦å¤–ï¼ŒæŒä¹…å±‚ä¸‡ä¸€æŒ‚äº†ï¼Œå°±ä¼šå•ç‚¹å¤±è´¥ å¦ä¸€ç§æ–¹æ¡ˆæ˜¯æœåŠ¡å™¨ç´¢æ€§ä¸ä¿å­˜ session æ•°æ®äº†ï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å‘å›æœåŠ¡å™¨ã€‚JWT å°±æ˜¯è¿™ç§æ–¹æ¡ˆçš„ä¸€ä¸ªä»£è¡¨ ::: tokençš„é‰´æƒæœºåˆ¶ æµç¨‹: ç”¨æˆ·ä½¿ç”¨ç”¨æˆ·åå¯†ç æ¥è¯·æ±‚æœåŠ¡å™¨ æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ç”¨æˆ·çš„ä¿¡æ¯ æœåŠ¡å™¨é€šè¿‡éªŒè¯å‘é€ç»™ç”¨æˆ·ä¸€ä¸ªtoken å®¢æˆ·ç«¯å­˜å‚¨tokenï¼Œå¹¶åœ¨æ¯æ¬¡è¯·æ±‚æ—¶é™„é€ä¸Šè¿™ä¸ªtokenå€¼ æœåŠ¡ç«¯éªŒè¯tokenå€¼ï¼Œå¹¶è¿”å›æ•°æ® tokenå¿…é¡»è¦åœ¨æ¯æ¬¡è¯·æ±‚æ—¶ä¼ é€’ç»™æœåŠ¡ç«¯ï¼Œåº”è¯¥ä¿å­˜åœ¨è¯·æ±‚å¤´é‡Œï¼Œ å¦å¤–ï¼ŒæœåŠ¡ç«¯è¦æ”¯æŒCORS(è·¨æ¥æºèµ„æºå…±äº«)ç­–ç•¥ï¼Œä¸€èˆ¬åœ¨æœåŠ¡ç«¯è¿™ä¹ˆåšå°±å¯ä»¥Access-Control-Allow-Origin: * JWT åŸç† JWT çš„åŸç†: æœåŠ¡å™¨è®¤è¯ä»¥åï¼Œç”Ÿæˆä¸€ä¸ª JSON å¯¹è±¡ï¼Œå‘å›ç»™ç”¨æˆ·ï¼Œå¦‚ä¸‹ { \u0026#34;å§“å\u0026#34;: \u0026#34;å¼ ä¸‰\u0026#34;, \u0026#34;è§’è‰²\u0026#34;: \u0026#34;ç®¡ç†å‘˜\u0026#34;, \u0026#34;åˆ°æœŸæ—¶é—´\u0026#34;: \u0026#34;2018å¹´7æœˆ1æ—¥0ç‚¹0åˆ†\u0026#34; } JWT æ•°æ®ç»“æ„ ä¸­é—´ç”¨ç‚¹ï¼ˆ.ï¼‰åˆ†éš”æˆä¸‰ä¸ªéƒ¨åˆ†ã€‚JWT å†…éƒ¨æ²¡æœ‰æ¢è¡Œï¼Œè¿™é‡Œä¸ºäº†ä¾¿äºå±•ç¤º, å¦‚ä¸‹: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ JWT çš„ä¸‰ä¸ªéƒ¨åˆ†ä¾æ¬¡å¦‚ä¸‹: Headerï¼ˆå¤´éƒ¨ï¼‰ Payloadï¼ˆè´Ÿè½½ï¼‰ Signatureï¼ˆç­¾åï¼‰ JWT ç‰¹ç‚¹ JWT é»˜è®¤æ˜¯ä¸åŠ å¯†ï¼Œä½†ä¹Ÿæ˜¯å¯ä»¥åŠ å¯†çš„ã€‚ç”ŸæˆåŸå§‹ Token ä»¥åï¼Œå¯ä»¥ç”¨å¯†é’¥å†åŠ å¯†ä¸€æ¬¡ã€‚ JWT ä¸åŠ å¯†çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½å°†ç§˜å¯†æ•°æ®å†™å…¥ JWTã€‚ JWT ä¸ä»…å¯ä»¥ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯ä»¥ç”¨äºäº¤æ¢ä¿¡æ¯ã€‚æœ‰æ•ˆä½¿ç”¨ JWTï¼Œå¯ä»¥é™ä½æœåŠ¡å™¨æŸ¥è¯¢æ•°æ®åº“çš„æ¬¡æ•°ã€‚ JWT çš„æœ€å¤§ç¼ºç‚¹æ˜¯ï¼Œç”±äºæœåŠ¡å™¨ä¸ä¿å­˜ session çŠ¶æ€ï¼Œå› æ­¤æ— æ³•åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­åºŸæ­¢æŸä¸ª tokenï¼Œæˆ–è€…æ›´æ”¹ token çš„æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ JWT ç­¾å‘äº†ï¼Œåœ¨åˆ°æœŸä¹‹å‰å°±ä¼šå§‹ç»ˆæœ‰æ•ˆï¼Œé™¤éæœåŠ¡å™¨éƒ¨ç½²é¢å¤–çš„é€»è¾‘ã€‚ JWT æœ¬èº«åŒ…å«äº†è®¤è¯ä¿¡æ¯ï¼Œä¸€æ—¦æ³„éœ²ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—è¯¥ä»¤ç‰Œçš„æ‰€æœ‰æƒé™ã€‚ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT çš„æœ‰æ•ˆæœŸåº”è¯¥è®¾ç½®å¾—æ¯”è¾ƒçŸ­ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æƒé™ï¼Œä½¿ç”¨æ—¶åº”è¯¥å†æ¬¡å¯¹ç”¨æˆ·è¿›è¡Œè®¤è¯ã€‚ ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT ä¸åº”è¯¥ä½¿ç”¨ HTTP åè®®æ˜ç ä¼ è¾“ï¼Œè¦ä½¿ç”¨ HTTPS åè®®ä¼ è¾“ã€‚ ","permalink":"https://www.chenzqi.cn/posts/2020/20200625_jsonwebtoken%E5%9F%BA%E7%A1%80/","tags":["web"],"title":"JSON Web Token"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip Django REST Framework. Filters ::: åŸºæœ¬ä¿¡æ¯ æºç  rest_framework.filters å®˜æ–¹æ–‡æ¡£ DRF API Guide-Filtering django-filter DRF è¿‡æ»¤ç»„ä»¶ DRF æœç´¢è¿‡æ»¤ç»„ä»¶ urls.py from django.urls import path from . import views urlpatterns = [ path(\u0026#39;cars/\u0026#39;, views.CarListAPIView.as_view()), # SearchFilter ] views.py # drfçš„SearchFilter # ç¬¬ä¸€æ­¥ï¼š æœç´¢è¿‡æ»¤ from rest_framework.filters import SearchFilter class CarListAPIView(ListAPIView): queryset = models.Car.objects.all() serializer_class = serializers.CarModelSerializer #è‡ªå®šä¹‰è®¤è¯ # ç¬¬äºŒæ­¥ï¼šå±€éƒ¨é…ç½® è¿‡æ»¤ç±» ä»¬ï¼ˆå…¨å±€é…ç½®ç”¨DEFAULT_FILTER_BACKENDSï¼‰ filter_backends = [SearchFilter] # ç¬¬ä¸‰æ­¥ï¼šSearchFilterè¿‡æ»¤ç±»ä¾èµ–çš„è¿‡æ»¤æ¡ä»¶ =\u0026gt; æ¥å£ï¼š/cars/?search=... search_fields = [\u0026#39;name\u0026#39;, \u0026#39;price\u0026#39;] #ç­›é€‰å­—æ®µ # egï¼š/cars/?search=1ï¼Œnameå’Œpriceä¸­åŒ…å«1çš„æ•°æ®éƒ½ä¼šè¢«æŸ¥è¯¢å‡º DRF æ’åºè¿‡æ»¤ç»„ä»¶ urls.py from django.urls import path from . import views urlpatterns = [ path(\u0026#39;cars2/\u0026#39;, views.CarListAPIView2.as_view()), # OrderingFilter ] views.py # ç¬¬ä¸€æ­¥ï¼šdrfçš„OrderingFilter - æ’åºè¿‡æ»¤ from rest_framework.filters import OrderingFilter class CarListAPIView2(ListAPIView): queryset = models.Car.objects.all() serializer_class = serializers.CarModelSerializer # ç¬¬äºŒæ­¥ï¼šå±€éƒ¨é…ç½® è¿‡æ»¤ç±» ä»¬ï¼ˆå…¨å±€é…ç½®ç”¨DEFAULT_FILTER_BACKENDSï¼‰ filter_backends = [OrderingFilter] # ç¬¬ä¸‰æ­¥ï¼šOrderingFilterè¿‡æ»¤ç±»ä¾èµ–çš„è¿‡æ»¤æ¡ä»¶ =\u0026gt; æ¥å£ï¼š/cars/?ordering=... ordering_fields = [\u0026#39;pk\u0026#39;, \u0026#39;price\u0026#39;] # egï¼š/cars/?ordering=-price,pkï¼Œå…ˆæŒ‰priceé™åºï¼Œå¦‚æœå‡ºç°priceç›¸åŒï¼Œå†æŒ‰pkå‡åº è‡ªå®šä¹‰è¿‡æ»¤å™¨ urls.py from django.urls import path from . import views urlpatterns = [ path(\u0026#39;cars3/\u0026#39;, views.CarListAPIView3.as_view()), # è‡ªå®šä¹‰fitler ] filters.py from . import models # è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œæ¥å£ï¼š?limit=æ˜¾ç¤ºçš„æ¡æ•° class LimitFilter: def filter_queryset(self, request, queryset, view): # å‰å°å›ºå®šç”¨ ?limit=... ä¼ é€’è¿‡æ»¤å‚æ•° limit = request.query_params.get(\u0026#39;limit\u0026#39;) if limit: limit = int(limit) return queryset[:limit] return queryset views.py # è‡ªå®šä¹‰fitler from .filters import LimitFilter class CarListAPIView3(ListAPIView): # å¦‚æœquerysetæ²¡æœ‰è¿‡æ»¤æ¡ä»¶ï¼Œå°±å¿…é¡» .all()ï¼Œä¸ç„¶åˆ†é¡µä¼šå‡ºé—®é¢˜ queryset = models.Car.objects.all() serializer_class = serializers.CarModelSerializer # å±€éƒ¨é…ç½® è¿‡æ»¤ç±» ä»¬ï¼ˆå…¨å±€é…ç½®ç”¨DEFAULT_FILTER_BACKENDSï¼‰ filter_backends = [LimitFilter] è¿‡æ»¤å™¨æ’ä»¶ django-filter urls.py from django.urls import path from . import views urlpatterns = [ path(\u0026#39;cars4/\u0026#39;, views.CarListAPIView4.as_view()), # æ’ä»¶django-filter ] filters.py # django-fitleræ’ä»¶ï¼šè‡ªå®šä¹‰è¿‡æ»¤å­—æ®µ from django_filters import filters from django_filters.rest_framework.filterset import FilterSet from django.db.models import Q class CarFilterSet(FilterSet): min_price = filters.NumberFilter(field_name=\u0026#39;price\u0026#39;, lookup_expr=\u0026#39;gte\u0026#39;) max_price = filters.NumberFilter(field_name=\u0026#39;price\u0026#39;, lookup_expr=\u0026#39;lte\u0026#39;) top_category = django_filters.NumberFilter(method=\u0026#39;top_category_filter\u0026#39;) def top_category_filter(self, queryset, name, value): return queryset.filter(Q(category_id=value)|Q(category__parent_category_id=value)|Q(category__parent_category__parent_category_id=value)) class Meta: model = models.Car fields = [\u0026#39;brand\u0026#39;, \u0026#39;min_price\u0026#39;, \u0026#39;max_price\u0026#39;] # brandæ˜¯modelä¸­å­˜åœ¨çš„å­—æ®µï¼Œä¸€èˆ¬éƒ½æ˜¯å¯ä»¥ç”¨äºåˆ†ç»„çš„å­—æ®µ # min_priceã€max_priceæ˜¯è‡ªå®šä¹‰å­—æ®µï¼Œéœ€è¦è‡ªå·±è‡ªå®šä¹‰è¿‡æ»¤æ¡ä»¶ views.py # django-filteræ’ä»¶è¿‡æ»¤å™¨ from django_filters.rest_framework import DjangoFilterBackend from .filters import CarFilterSet class CarListAPIView4(ListAPIView): queryset = models.Car.objects.all() serializer_class = serializers.CarModelSerializer # å±€éƒ¨é…ç½® è¿‡æ»¤ç±» ä»¬ï¼ˆå…¨å±€é…ç½®ç”¨DEFAULT_FILTER_BACKENDSï¼‰ filter_backends = [DjangoFilterBackend] # django-filterè¿‡æ»¤å™¨æ’ä»¶ä½¿ç”¨ #filter_class = CarFilterSet filterset_class = CarFilterSet # æ—§ç‰ˆå†™ä½œfilter_class, æ–°ç‰ˆå†™ä½œfitlerset_class # æ¥å£ï¼š?brand=...\u0026amp;min_price=...\u0026amp;max_price=... # eg:?brand=å®é©¬\u0026amp;min_price=5\u0026amp;max_price=10 =\u0026gt; 5~10é—´çš„å®é©¬ç‰Œæ±½è½¦ ","permalink":"https://www.chenzqi.cn/posts/2020/20200622_drf%E8%BF%87%E6%BB%A4%E5%99%A8%E7%BB%84%E4%BB%B6/","tags":["æ¡†æ¶","Django","DRF"],"title":"DRF è¿‡æ»¤å™¨ç»„ä»¶"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip Django REST Framework. Generic Views, MixIns, ViewSets and Routers ::: åŸºæœ¬ä¿¡æ¯ æºç ä»“åº“ rest_framework.views rest_framework.generics rest_framework.viewsets rest_framework.routers å®˜æ–¹æ–‡æ¡£ API Guide-Generic views API Guide-ViewSets API Guide-Routers å…³ç³»å›¾ ::: details Viewç»§æ‰¿å›¾ä¸Viewå›¾è°± ::: AIPView-APIè§†å›¾ç±» APIView æ˜¯ Django REST Framework æä¾›çš„æ‰€æœ‰è§†å›¾çš„åŸºç±»ï¼Œç»§æ‰¿è‡ª Django çš„ View çˆ¶ç±» AIPView å¯¹æ¯” Django View ä¼ å…¥åˆ°è§†å›¾æ–¹æ³•ä¸­çš„æ˜¯ REST framework çš„ Request å¯¹è±¡ï¼Œè€Œä¸æ˜¯ Django çš„ HttpRequeset å¯¹è±¡ è§†å›¾æ–¹æ³•å¯ä»¥è¿”å› REST framework çš„ Response å¯¹è±¡ï¼Œè§†å›¾ä¼šä¸ºå“åº”æ•°æ®è®¾ç½®ï¼ˆrenderï¼‰ç¬¦åˆå‰ç«¯è¦æ±‚çš„æ ¼å¼ ä»»ä½• APIException å¼‚å¸¸éƒ½ä¼šè¢«æ•è·åˆ°ï¼Œå¹¶ä¸”å¤„ç†æˆåˆé€‚çš„å“åº”ä¿¡æ¯ åœ¨è¿›è¡Œ dispatch() åˆ†å‘å‰ï¼Œä¼šå¯¹è¯·æ±‚è¿›è¡Œèº«ä»½è®¤è¯ã€æƒé™æ£€æŸ¥ã€æµé‡æ§åˆ¶ é‡è¦ç±»å±æ€§ AIPView æœ‰å¦‚ä¸‹å¯è®¾ç½®çš„é‡è¦ç±»å±æ€§ï¼š authentication_classesï¼šåˆ—è¡¨æˆ–å…ƒç¥–ï¼Œèº«ä»½è®¤è¯ç±» permissoin_classesï¼š åˆ—è¡¨æˆ–å…ƒç¥–ï¼Œæƒé™æ£€æŸ¥ç±» throttle_classesï¼š åˆ—è¡¨æˆ–å…ƒç¥–ï¼Œæµé‡æ§åˆ¶ç±» ç¤ºä¾‹ views.py from rest_framework.views import APIView from rest_framework.response import Response from models import Goods from serializers import GoodsSerializer class GoodListView(APIView): def get(self, request): goods = Goods.objects.all() serializer = GoodsSerializer(goods, many=True) return Response(serializer.data) serializers.py class GoodsSerializer(serializers.ModelSerializer): # category = CategorySerializer() # images = GoodsImageSerializer(many=True) class Meta: model = Goods fields = \u0026#34;__all__\u0026#34; GenericAPIView-é€šç”¨APIè§†å›¾ç±» é€šç”¨ API è§†å›¾ç±» GenericAPIView ç»§æ‰¿è‡ª APIViewï¼Œå®Œå…¨å…¼å®¹ APIViewï¼Œä¸»è¦å¢åŠ äº†æ“ä½œåºåˆ—åŒ–å™¨å’Œæ•°æ®åº“æŸ¥è¯¢çš„æ–¹æ³•ï¼Œä½œç”¨æ˜¯ä¸ºä¸‹é¢ Mixin æ‰©å±•ç±»çš„æ‰§è¡Œæä¾›åŸºç¡€ç±»æ”¯æŒã€‚é€šå¸¸åœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥é…åˆä¸€ä¸ªæˆ–å¤šä¸ª Mixin æ‰©å±•ç±»ã€‚ GenericAPIView å¯¹æ¯” APIView get_queryset()ï¼š ä»ç±»å±æ€§ querysetä¸­è·å¾— model çš„ queryset æ•°æ®ã€‚ç¾¤æ“ä½œå°±èµ° get_queryset() æ–¹æ³• (åŒ…æ‹¬ç¾¤æŸ¥ï¼Œç¾¤å¢ç­‰)ã€‚ get_object()ï¼š ä»ç±»å±æ€§ queryset ä¸­è·å¾— model çš„ queryset æ•°æ®ï¼Œå†é€šè¿‡æœ‰ååˆ†ç»„ pk ç¡®å®šå”¯ä¸€æ“ä½œå¯¹è±¡ã€‚å•æ“ä½œå°±èµ° get_object() æ–¹æ³•ï¼ˆåŒ…æ‹¬å•æŸ¥ï¼Œå•å¢ç­‰ï¼‰ã€‚ get_serializer()ï¼šä»ç±»å±æ€§ serializer_class ä¸­è·å¾— serializer çš„åºåˆ—åŒ–ç±»ã€‚ é‡è¦ç±»å±æ€§ åˆ—è¡¨è§†å›¾ä¸è¯¦æƒ…è§†å›¾å…±ç”¨ querysetï¼š æŒ‡æ˜è§†å›¾éœ€è¦çš„æ•°æ®ï¼ˆmodel æŸ¥è¯¢æ•°æ®ï¼‰ permissoin_classesï¼šæŒ‡æ˜è§†å›¾ä½¿ç”¨çš„åºåˆ—åŒ–å™¨ åˆ—è¡¨è§†å›¾ä½¿ç”¨ pagination_classï¼šæŒ‡å®šåˆ†é¡µæ§åˆ¶ç±» filter_backendsï¼š æŒ‡å®šè¿‡æ»¤æ§åˆ¶åç«¯ è¯¦æƒ…é¡µè§†å›¾ä½¿ç”¨ lookup_fieldï¼š è‡ªå®šä¹‰ä¸»é”®ï¼Œæœ‰ååˆ†ç»„çš„æŸ¥è¯¢ï¼Œé»˜è®¤æ˜¯ pk lookup_url_kwargï¼šæŸ¥è¯¢å•ä¸€æ•°æ®æ—¶ url ä¸­çš„å‚æ•°å…³é”®å­—åç§°ï¼Œé»˜è®¤ä¸ look_field ç›¸åŒ é‡è¦ç±»æ–¹æ³• get_queryset()ï¼š ä»ç±»å±æ€§ queryset ä¸­è·å¾— model çš„ queryset æ•°æ®ã€€get_object()ï¼š ä»ç±»å±æ€§ queryset ä¸­è·å¾— model çš„ queryset æ•°æ®ï¼Œå†é€šè¿‡æœ‰ååˆ†ç»„ pk æ¥ç¡®å®šå”¯ä¸€æ“ä½œå¯¹è±¡ get_serializer()ï¼šä»ç±»å±æ€§ serializer_class ä¸­è·å¾— serializer çš„åºåˆ—åŒ–ç±»ï¼Œä¸»è¦ç”¨æ¥æä¾›ç»™ Mixin æ‰©å±•ç±»ä½¿ç”¨ get_serializer æºç  def get_serializer(self, *args, **kwargs): \u0026#34;\u0026#34;\u0026#34; Return the serializer instance that should be used for validating and deserializing input, and for serializing output. è¿”å›åº”è¯¥ç”¨äºéªŒè¯å’Œååºåˆ—åŒ–è¾“å…¥ä»¥åŠåºåˆ—åŒ–è¾“å‡ºçš„åºåˆ—åŒ–å™¨å®ä¾‹ã€‚ \u0026#34;\u0026#34;\u0026#34; serializer_class = self.get_serializer_class() kwargs[\u0026#39;context\u0026#39;] = self.get_serializer_context() return serializer_class(*args, **kwargs) ç¤ºä¾‹ views.py class GoodGenericAPIView(GenericAPIView): queryset = models.Good.objects.filter(is_delete=False) serializer_class = serializers.GoodModelSerializer lookup_field = \u0026#39;pk\u0026#39; # å…ˆå®šä¹‰å¥½ï¼Œå•æŸ¥å¯ä»¥ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯pk è‡ªå®šä¹‰ä¸»é”®çš„æœ‰ååˆ†ç»„ï¼Œå¦‚æœè·¯ç”±æœ‰ååˆ†ç»„ä¸æ˜¯pk,è¿™ä¸ªå±æ€§å°±è¦è‡ªå·±è®¾ç½®äº† # ç¾¤å– def get(self, request, *args, **kwargs): good_query = self.get_queryset() # è·å–querysetæ•°æ®ï¼ˆmodelæŸ¥è¯¢æ•°æ®ï¼‰ good_ser = self.get_serializer(good_query, many=True) good_data = good_ser.data return APIResponse(results=good_data) # # å•å– # def get(self, request, *args, **kwargs): # good_query = self.get_object() # good_ser = self.get_serializer(good_query) # good_data = good_ser.data # return APIResponse(results=good_data) urls.py urlpatterns = [ path(\u0026#39;v2/goods/\u0026#39;, views.GoodGenericAPIView.as_view()), path(\u0026#39;v2/goods/\u0026lt;pk\u0026gt;/\u0026#39;, views.GoodGenericAPIView.as_view()), ] xxxModelMixin-è§†å›¾ç±»çš„æ¨¡å‹å·¥å…·é›† ä½œç”¨ æä¾›äº†å‡ ç§åç«¯è§†å›¾ï¼ˆå¯¹æ•°æ®èµ„æºçš„å¢åˆ æ”¹æŸ¥ï¼‰å¤„ç†æµç¨‹çš„å®ç°ï¼Œå¦‚æœéœ€è¦ç¼–å†™çš„è§†å›¾å±äºè¿™äº”ç§ï¼Œåˆ™è§†å›¾å¯ä»¥é€šè¿‡ç»§æ‰¿ç›¸åº”çš„æ‰©å±•ç±»æ¥å¤ç”¨ä»£ç ï¼Œå‡å°‘è‡ªå·±ç¼–å†™çš„ä»£ç é‡ã€‚ mixins æœ‰äº”ä¸ªå·¥å…·ç±»æ–‡ä»¶ï¼Œä¸€å…±æä¾›äº†äº”ä¸ªå·¥å…·ç±»ï¼Œå…­ä¸ªå·¥å…·æ–¹æ³•ï¼šå•æŸ¥ã€ç¾¤æŸ¥ã€å•å¢ã€å•åˆ ã€å•æ•´ä½“æ”¹ã€å•å±€éƒ¨æ”¹ ä½¿ç”¨ ç»§æ‰¿å·¥å…·ç±»å¯ä»¥ç®€åŒ–è¯·æ±‚å‡½æ•°çš„å®ç°ä½“ï¼Œä½†æ˜¯å¿…é¡»ç»§æ‰¿ GenericAPIViewï¼Œéœ€è¦ GenericAPIView ç±»æä¾›åºåˆ—åŒ–å™¨ä¸æ•°æ®åº“æŸ¥è¯¢çš„æ–¹æ³• (è§ä¸Šæ–¹ GenericAPIView åŸºç±»çŸ¥è¯†ç‚¹) å·¥å…·ç±»çš„å·¥å…·æ–¹æ³•è¿”å›å€¼éƒ½æ˜¯ Response ç±»å‹å¯¹è±¡ï¼Œå¦‚æœè¦æ ¼å¼åŒ–æ•°æ®æ ¼å¼å†è¿”å›ç»™å‰å°ï¼Œå¯ä»¥é€šè¿‡ response.data æ‹¿åˆ°å·¥å…·æ–¹æ³•è¿”å›çš„ Response ç±»å‹å¯¹è±¡çš„å“åº”æ•°æ® äº”å¤§æ¨¡å‹å·¥å…·ç±» ListModelMixin ç¾¤æŸ¥ åˆ—è¡¨è§†å›¾æ‰©å±•ç±»ï¼Œæä¾› list æ–¹æ³•å¿«é€Ÿå®ç°æŸ¥è¯¢è§†å›¾ è¿”å› 200 çŠ¶æ€ç  é™¤äº†æŸ¥è¯¢ï¼Œè¯¥ list æ–¹æ³•ä¼šå¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤å’Œåˆ†é¡µ CreateModelMixin å•å¢ åˆ›å»ºè§†å›¾æ‰©å±•ç±»ï¼Œæä¾› create æ–¹æ³•å¿«é€Ÿåˆ›å»ºèµ„æºçš„è§†å›¾ï¼ŒæˆåŠŸè¿”å› 201 çš„çŠ¶æ€ç  æ²¡æœ‰ç¾¤å¢çš„æ–¹æ³•ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨å†™ RetrieveModelMixin å•æŸ¥ è¯¦æƒ…è§†å›¾æ‰©å±•ç±»ï¼Œæä¾› retrieve æ–¹æ³•ï¼Œå¯ä»¥å¿«é€Ÿå®ç°è¿”å›ä¸€ä¸ªå­˜åœ¨çš„æ•°æ®å¯¹è±¡ UpdateModelMixin æ›´æ–° / ä¿®æ”¹ æ›´æ–°è§†å›¾æ‰©å±•ç±»ï¼Œæä¾› update æ–¹æ³•ï¼Œå¯ä»¥å¿«é€Ÿå®ç°æ›´æ–°ä¸€ä¸ªå­˜åœ¨çš„æ•°æ®å¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿæä¾› partial_update æ–¹æ³•ï¼Œå¯ä»¥å®ç°å±€éƒ¨æ›´æ–° åªæœ‰å•æ•´ä½“æ”¹å’Œå•å±€éƒ¨æ”¹ï¼Œæ²¡æœ‰ç¾¤æ•´ä½“æ”¹å’Œç¾¤å±€éƒ¨æ”¹ DestoryModelMixin åˆ é™¤ åˆ é™¤è§†å›¾æ‰©å±•ç±»ï¼Œæä¾› destory æ–¹æ³•ï¼Œå¯ä»¥å¿«é€Ÿå®ç°åˆ é™¤ä¸€ä¸ªå­˜åœ¨æ•°æ®å¯¹è±¡ ä¸€èˆ¬ä¸æ€ä¹ˆç”¨åˆ°ï¼Œå› ä¸ºå®é™…å¼€å‘ä¸­å¹¶ä¸ä¼šçœŸçš„åˆ é™¤æ•°æ®ï¼Œè€Œæ˜¯ä¿®æ”¹æ˜¯å¦å¯ç”¨çš„æ ‡è®° ç¤ºä¾‹ views.py from rest_framework.mixins import ListModelMixin, CreateModelMixin, RetrieveModelMixin, UpdateModelMixin class GoodMixinGenericAPIView(ListModelMixin, CreateModelMixin, RetrieveModelMixin, UpdateModelMixin, GenericAPIView): # GenericAPIViewæä¾›çš„åºåˆ—åŒ–å™¨å’ŒæŸ¥è¯¢çš„æ•°æ® queryset = models.Good.objects.filter(is_delete=False) serializer_class = serializers.GoodModelSerializer # å•æŸ¥å’Œç¾¤æŸ¥ def get(self, request, *args, **kwargs): if \u0026#39;pk\u0026#39; in kwargs: # å•æŸ¥ RetrieveModelMixinæ–¹æ³• response = self.retrieve(request, *args, **kwargs) else: # mixinsæä¾›çš„listæ–¹æ³•çš„å“åº”å¯¹è±¡æ˜¯Responseï¼Œå°†è¯¥å¯¹è±¡æ ¼å¼åŒ–ä¸ºè‡ªå®šä¹‰çš„APIResponse response = self.list(request, *args, **kwargs) # ç¾¤æŸ¥ ListModelMixin # responseçš„æ•°æ®éƒ½å­˜æ”¾åœ¨response.dataä¸­ return APIResponse(results=response.data) # å•å¢ def post(self, request, *args, **kwargs): response = self.create(request, *args, **kwargs) # CreateModelMixinæ–¹æ³• return APIResponse(results=response.data) # å•æ•´ä½“ä¿®æ”¹ def put(self, request, *args, **kwargs): response = self.update(request, *args, **kwargs) # UpdateModelMixin return APIResponse(results=response.data) # å•å±€éƒ¨ä¿®æ”¹ def patch(self, request, *args, **kwargs): response = self.partial_update(request, *args, **kwargs) return APIResponse(results=response.data) urls.py urlpatterns = [ path(\u0026#39;v3/goods/\u0026#39;, views.GoodMixinGenericAPIView.as_view()), path(\u0026#39;v3/goods/\u0026lt;pk\u0026gt;/\u0026#39;, views.GoodMixinGenericAPIView.as_view()), ] xxxAPIView-åŠŸèƒ½æ€§å­è§†å›¾ç±» åŠŸèƒ½æ€§å­è§†å›¾ç±»ç»§æ‰¿äº† GenericAPIView å’Œå„ç§ Mixins å·¥å…·ç±» åŠŸèƒ½æ€§è§†å›¾ç±»éƒ½æ˜¯ GenericAPIView çš„å­ç±»ï¼Œä¸”ä¸åŒçš„å­ç±»ç»§æ‰¿äº†ä¸åŒçš„å·¥å…·ç±» åŠŸèƒ½æ€§è§†å›¾ç±»çš„åŠŸèƒ½å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œåªéœ€è¦ç»§æ‰¿å·¥å…·è§†å›¾ï¼Œå¹¶ä¸”æä¾› queryset ä¸ serializer_class å³å¯ å„å¤§åŠŸèƒ½å­è§†å›¾ç±» è§†å›¾ ä½œç”¨ è¯·æ±‚ç±»å‹ çˆ¶ç±» ListAPIView æŸ¥è¯¢å¤šæ¡æ•°æ® get GenericAPIView ListModelMixin CreateAPIView æ–°å¢ä¸€æ¡æ•°æ® post GenericAPIView CreateModelMixin RetrieveAPIView æŸ¥è¯¢ä¸€æ¡æ•°æ® get GenericAPIView RetrieveModelMixin UpdateAPIView ä¿®æ”¹ä¸€æ¡æ•°æ® put patch GenericAPIView UpdateModelMixin DestroyAPIView åˆ é™¤ä¸€æ¡æ•°æ® delete GenericAPIView DestroyModelMixin RetrieveUpdateAPIView å•æŸ¥ æ›´æ–°ä¸€æ¡ get put patch GenericAPIView RetrieveModelMixin UpdateModelMixin RetrieveUpdateDestroyAPIView å•æŸ¥ æ›´æ–°åˆ é™¤ä¸€æ¡ get put patch delete GenericAPIView RetrieveModelMixin UpdateModelMixin DestroyModelMixin ListCreateAPIView ç¾¤æŸ¥ æ›´æ–°ä¸€æ¡ get post GenericAPIView ListModelMixin mixins.CreateModelMixin xxxViewset-è§†å›¾é›† å¸¸ç”¨è§†å›¾é›†çˆ¶ç±» ViewSetMixin ViewSetMixin ä¸»è¦æ˜¯è‡ªå®šä¹‰äº† as_view æ–¹æ³•ï¼Œä½¿å¯ä»¥é€šè¿‡å…¶å‚æ•°æŒ‡å®š HTTP_METHOD ä¸å‡½æ•°çš„æ˜ å°„å…³ç³»ï¼Œå¦‚ view = MyViewSet.as_view({\u0026lsquo;get\u0026rsquo;: \u0026rsquo;list\u0026rsquo;, \u0026lsquo;post\u0026rsquo;: \u0026lsquo;create\u0026rsquo;}) ViewSet ç»§æ‰¿è‡ª APIView å’Œ ViewSetMixinï¼Œæ²¡æœ‰æä¾›ä»»ä½•æ–¹æ³•ï¼Œéœ€è¦è‡ªå·±å†™ GenericViewSet ç»§æ‰¿ GenericAPIView å’Œ ViewSetMixinï¼Œå…¶ä¸­ GenericAPIView æä¾›äº†åŸºç¡€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥æ­é… Mixin æ‰©å±•ç±»ä½¿ç”¨ï¼Œå› æ­¤æ¯”è¾ƒå¸¸ç”¨ ModelViewSetã€€ç»§æ‰¿ GenericViewsetï¼Œä½†åŒæ—¶ä¹ŸåŒ…æ‹¬ ListModelMixinã€CreateModelMixin ç­‰ mixin æ‰©å±•ç±» æºç åˆ†æ è§†å›¾é›†éƒ½æ˜¯é»˜è®¤ä¼˜å…ˆç»§æ‰¿ ViewSetMixin ç±»ï¼Œå†ç»§æ‰¿ä¸€ä¸ªè§†å›¾ç±»ï¼ˆGenericAPIView æˆ– APIViewï¼‰ ViewSetMixin æä¾›äº†é‡å†™çš„ as_view() æ–¹æ³•ï¼Œç»§æ‰¿è§†å›¾é›†çš„è§†å›¾ç±»ï¼Œé…ç½®è·¯ç”±æ—¶è°ƒç”¨ as_view() å¿…é¡»ä¼ å…¥ è¯·æ±‚å - å‡½æ•°å æ˜ å°„å…³ç³»å­—å…¸ ä¾‹å¦‚: # è¡¨ç¤º get è¯·æ±‚ä¼šäº¤ç»™ my_get_list è§†å›¾å‡½æ•°å¤„ç† path(\u0026#39;v5/books/\u0026#39;, views.BookGenericViewSet.as_view({\u0026#39;get\u0026#39;: \u0026#39;my_get_list\u0026#39;})), GenericViewSet ç¤ºä¾‹ä»£ç  urls.py urlpatterns = [ # Viewçš„as_view()ï¼šå°†getè¯·æ±‚æ˜ å°„åˆ°è§†å›¾ç±»çš„getæ–¹æ³• # ViewSetçš„as_view({\u0026#39;get\u0026#39;: \u0026#39;my_get_list\u0026#39;})ï¼šå°†getè¯·æ±‚æ˜ å°„åˆ°è§†å›¾ç±»çš„my_get_listæ–¹æ³• path(\u0026#39;v5/books/\u0026#39;, views.BookGenericViewSet.as_view({\u0026#39;get\u0026#39;: \u0026#39;my_get_list\u0026#39;})), path(\u0026#39;v5/books/\u0026lt;pk\u0026gt;/\u0026#39;, views.BookGenericViewSet.as_view({\u0026#39;get\u0026#39;: \u0026#39;my_get_obj\u0026#39;})), ] views.py from rest_framework.viewsets import GenericViewSet from rest_framework import mixins #å·¥å…·é›† å¯ä»¥ä½¿ç”¨list, retrieveç­‰æ–¹æ³• class BookGenericViewSet(RetrieveModelMixin, ListModelMixin, GenericViewSet): queryset = models.Book.objects.filter(is_delete=False) serializer_class = serializers.BookModelSerializer def my_get_list(self, request, *args, **kwargs): return self.list(request, *args, **kwargs) def my_get_obj(self, request, *args, **kwargs): return self.retrieve(request, *args, **kwargs) GenericViewSet ä¸ ViewSet å¼‚åŒ GenericViewSet å’Œ ViewSet éƒ½ç»§æ‰¿äº† ViewSetMixinï¼Œas_view éƒ½å¯ä»¥é…ç½® è¯·æ±‚ - å‡½æ•° æ˜ å°„ GenericViewSet ç»§æ‰¿çš„æ˜¯ GenericAPIView è§†å›¾ç±»ï¼Œç”¨æ¥å®Œæˆæ ‡å‡†çš„ model ç±»æ“ä½œæ¥å£ ViewSet ç»§æ‰¿çš„æ˜¯ APIView è§†å›¾ç±»ï¼Œç”¨æ¥å®Œæˆä¸éœ€è¦ model ç±»å‚ä¸ï¼Œæˆ–æ˜¯éæ ‡å‡†çš„ model ç±»æ“ä½œæ¥å£ï¼Œå¦‚ post è¯·æ±‚åœ¨æ ‡å‡†çš„ model ç±»æ“ä½œä¸‹å°±æ˜¯æ–°å¢æ¥å£ï¼Œç™»é™†çš„ post ä¸æ»¡è¶³ã€‚ç™»é™†çš„ post è¯·æ±‚ï¼Œå¹¶ä¸æ˜¯å®Œæˆæ•°æ®çš„æ–°å¢ï¼Œåªæ˜¯ç”¨ post æäº¤æ•°æ®ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿä¸æ˜¯ç™»é™†çš„ç”¨æˆ·ä¿¡æ¯ï¼Œè€Œæ˜¯ç™»é™†çš„è®¤è¯ä¿¡æ¯ post è¯·æ±‚éªŒè¯ç çš„æ¥å£ï¼Œä¸éœ€è¦ model ç±»çš„å‚ä¸ æºç  GenericViewSet # viewsets.py class GenericViewSet(ViewSetMixin, generics.GenericAPIView): \u0026#34;\u0026#34;\u0026#34; The GenericViewSet class does not provide any actions by default, but does include the base set of generic view behavior, such as the `get_object` and `get_queryset` methods. é»˜è®¤æƒ…å†µä¸‹ï¼ŒGenericViewSetç±»ä¸æä¾›ä»»ä½•æ“ä½œï¼Œä½†æ˜¯åŒ…å«é€šç”¨è§†å›¾è¡Œä¸ºçš„åŸºæœ¬é›†ï¼Œæ¯”å¦‚get ohiectå’Œget querysetæ–¹æ³• \u0026#34;\u0026#34;\u0026#34; pass # generics.py class GenericAPIView(views.APIView): # ... # vies.py class APIView(View): # ... ViewSet class ViewSet(ViewSetMixin, views.APIView): \u0026#34;\u0026#34;\u0026#34; The base ViewSet class does not provide any actions by default. é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸºæœ¬ViewSetç±»ä¸æä¾›ä»»ä½•æ“ä½œã€‚ \u0026#34;\u0026#34;\u0026#34; pass # vies.py class APIView(View): # ... ModelViewSet ç¤ºä¾‹ä»£ç  urls.py urlpatterns = [ path(\u0026#39;v6/books/\u0026#39;, views.BookModelViewSet.as_view({\u0026#39;get\u0026#39;: \u0026#39;list\u0026#39;, \u0026#39;post\u0026#39;: \u0026#39;create\u0026#39;})), path(\u0026#39;v6/books/\u0026lt;pk\u0026gt;/\u0026#39;, views.BookModelViewSet.as_view({\u0026#39;get\u0026#39;: \u0026#39;retrieve\u0026#39;, \u0026#39;put\u0026#39;: \u0026#39;update\u0026#39;, \u0026#39;patch\u0026#39;: \u0026#39;partial_update\u0026#39;, \u0026#39;delete\u0026#39;: \u0026#39;destroy\u0026#39;})), ] views.py class BookModelViewSet(ModelViewSet): queryset = models.Book.objects.filter(is_delete=False) serializer_class = serializers.BookModelSerializer # åˆ ä¸æ˜¯æ•°æ®åº“ï¼Œè€Œæ˜¯è¯¥è®°å½•ä¸­çš„ä¿®æ”¹is_deleteçš„å€¼ï¼Œå› æ­¤é‡å†™é»˜è®¤çš„destroyå‡½æ•° def destroy(self, request, *args, **kwargs): instance = self.get_object() # type: models.Book if not instance: return APIResponse(1, \u0026#39;åˆ é™¤å¤±è´¥\u0026#39;) # å®é™…æ“ä½œï¼Œåœ¨æ­¤ä¹‹å‰å°±åšäº†åˆ¤æ–­ instance.is_delete = True instance.save() return APIResponse(0, \u0026#39;åˆ é™¤æˆåŠŸ\u0026#39;) è·¯ç”±ç»„ä»¶ å› ä¸ºå…·æœ‰å±€é™æ€§ï¼Œæ‰€ä»¥åœ¨å¼€å‘å¤æ‚æ¥å£æ—¶å¹¶ä¸æ˜¯é¦–é€‰ã€‚ ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š from django.urls import path, include from rest_framework.routers import SimpleRouter from . import views router = SimpleRouter() # æ‰€æœ‰è·¯ç”±ä¸ViewSetè§†å›¾ç±»çš„éƒ½å¯ä»¥æ³¨å†Œï¼Œä¼šäº§ç”Ÿ \u0026#39;v7/books/\u0026#39; å’Œ \u0026#39;v7/books/\u0026lt;pk\u0026gt;/\u0026#39; router.register(\u0026#39;v7/books\u0026#39;, views.BookModelViewSet) urlpatterns = [ # router.urls æ·»åŠ æ–¹æ³•ä¸€ # path(\u0026#39;\u0026#39;, include(router.urls)), ] # router.urls æ·»åŠ æ–¹æ³•äºŒ # urlpatterns += router.urls ","permalink":"https://www.chenzqi.cn/posts/2020/20200621_drf%E9%80%9A%E7%94%A8%E8%A7%86%E5%9B%BE-%E8%A7%86%E5%9B%BE%E5%B7%A5%E5%85%B7%E7%B1%BB-%E8%A7%86%E5%9B%BE%E9%9B%86%E4%BB%A5%E5%8F%8A%E8%B7%AF%E7%94%B1/","tags":["æ¡†æ¶","Django","DRF"],"title":"DRF é€šç”¨è§†å›¾-è§†å›¾å·¥å…·ç±»-è§†å›¾é›†ä»¥åŠè·¯ç”±"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip Vue + Element-UI æ­å»ºåå°ç®¡ç†ç³»ç»Ÿæ¨¡å‹ ::: çº¿ä¸Šæµ‹è¯•åœ°å€ ","permalink":"https://www.chenzqi.cn/posts/2020/20200613_vue%E6%90%AD%E5%BB%BA%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/","tags":["å‰ç«¯"],"title":"VUEæ­å»ºåå°ç®¡ç†ç³»ç»Ÿ"},{"categories":[2020,"æŠ€æœ¯"],"contents":"å…³é—­æŸä¸ªç«¯å£ firewall-cmd --permanent --zone=public --remove-port=8080/tcp æ‰“å¼€æŸä¸ªç«¯å£ firewall-cmd --permanent --add-port=10086/tcp é‡æ–°åŠ è½½é˜²ç«å¢™ç­–ç•¥ firewall-cmd --reload æŸ¥çœ‹é˜²ç«å¢™ç«¯å£å¼€æ”¾æƒ…å†µ firewall-cmd --list-ports ","permalink":"https://www.chenzqi.cn/posts/2020/20200606_linux%E9%98%B2%E7%81%AB%E5%A2%99%E7%AB%AF%E5%8F%A3%E8%AE%BE%E7%BD%AE/","tags":["è®°å½•","linux"],"title":"linuxé˜²ç«å¢™ç«¯å£è®¾ç½®"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip Flask SQLAlchemyå­—æ®µé»˜è®¤å€¼å‚æ•° server_default ä¸ default åŒºåˆ« ::: defult è¿™ç§æ–¹æ³•ä¸ä¼šåœ¨æ•°æ®åº“é‡Œé¢è®¾ç½®é»˜è®¤å€¼ï¼Œæ˜¯ä½¿ç”¨äº†SQLAlchemy Modelç±»æäº¤æ•°æ®æ—¶æ·»åŠ ä¸Šå»çš„å€¼ï¼Œä¸é€‚åˆéœ€è¦å–æ•°æ®åº“æ‰€æœ‰æœåŠ¡å™¨æ—¶é—´çš„åœºåˆã€‚ from sqlalchemy.sql.sqltypes import TIMESTAMP class Test(db.Model): id = db.Column(db.Integer, primary_key = True) name = db.Column(db.String(32)) create_date = db.Column(TIMESTAMP, default = datetime.datetime) server_default ä½¿ç”¨ SQLAlchemy æ¨¡å‹ç›´æ¥åœ¨æ•°æ®åº“è®¾ç½®é»˜è®¤å€¼çš„æ–¹æ³•ï¼š ::: warning éœ€è¦æ³¨æ„çš„ ? Integer é»˜è®¤å€¼ä¸èƒ½ç›´æ¥è®¾ç½®æ•°å­—ï¼Œéœ€è¦æ˜¯å­—ç¬¦ä¸²ï¼› DateTime é»˜è®¤å€¼éœ€è¦ä½¿ç”¨func.now()ï¼› è‡ªåŠ¨æ›´æ–°çš„æ—¶é—´æˆ³å¯ä»¥ä½¿ç”¨TIMESTAMPï¼Œåªéœ€è®¾ç½®nullable=Falseå³å¯ ::: #mysql æ—¥æœŸè®¾ç½®é»˜è®¤å€¼å¿…é¡»ä½¿ç”¨timestampç±»å‹ from sqlalchemy.sql.sqltypes import TIMESTAMP #funcç”¨æ¥ç”Ÿæˆæ•°æ®åº“å‡½æ•°ä»£ç ï¼Œè·Ÿè¸ªè¿›æºä»£ç çœ‹ä¸€*** from sqlalchemy.sql import func class Test(db.Model): id = db.Column(db.Integer, primary_key = True) name = db.Column(db.String(32)) create_date = db.Column(TIMESTAMP, server_default = func.now()) # æ³¨æ„è¿™é‡Œæ˜¯ server_default ","permalink":"https://www.chenzqi.cn/posts/2020/20200529_sqlalchemy%E5%AD%97%E6%AE%B5%E9%BB%98%E8%AE%A4%E5%80%BC/","tags":["è®°å½•","flask"],"title":"SQLAlchemyå­—æ®µé»˜è®¤å€¼"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip åç«¯å¸¸ç”¨å“åº”ç  ::: \u0026#34;\u0026#34;\u0026#34;å…±ç”¨çš„ä¸€äº›æ•°å­—çº¦å®šå«ä¹‰\u0026#34;\u0026#34;\u0026#34; class RET: OK = \u0026#34;0\u0026#34; DBERR = \u0026#34;4001\u0026#34; NODATA = \u0026#34;4002\u0026#34; DATAEXIST = \u0026#34;4003\u0026#34; DATAERR = \u0026#34;4004\u0026#34; SESSIONERR = \u0026#34;4101\u0026#34; LOGINERR = \u0026#34;4102\u0026#34; PARAMERR = \u0026#34;4103\u0026#34; USERERR = \u0026#34;4104\u0026#34; ROLEERR = \u0026#34;4105\u0026#34; PWDERR = \u0026#34;4106\u0026#34; REQERR = \u0026#34;4201\u0026#34; IPERR = \u0026#34;4202\u0026#34; THIRDERR = \u0026#34;4301\u0026#34; IOERR = \u0026#34;4302\u0026#34; SERVERERR = \u0026#34;4500\u0026#34; UNKOWNERR = \u0026#34;4501\u0026#34; error_map = { RET.OK : \u0026#34;æˆåŠŸ\u0026#34;, RET.DBERR : \u0026#34;æ•°æ®åº“æŸ¥è¯¢é”™è¯¯\u0026#34;, RET.NODATA : \u0026#34;æ— æ•°æ®\u0026#34;, RET.DATAEXIST : \u0026#34;æ•°æ®å·²å­˜åœ¨\u0026#34;, RET.DATAERR : \u0026#34;æ•°æ®é”™è¯¯\u0026#34;, RET.SESSIONERR : \u0026#34;ç”¨æˆ·æœªç™»å½•\u0026#34;, RET.LOGINERR : \u0026#34;ç”¨æˆ·ç™»å½•å¤±è´¥\u0026#34;, RET.PARAMERR : \u0026#34;å‚æ•°é”™è¯¯\u0026#34;, RET.USERERR : \u0026#34;ç”¨æˆ·ä¸å­˜åœ¨æˆ–æœªæ¿€æ´»\u0026#34;, RET.ROLEERR : \u0026#34;ç”¨æˆ·èº«ä»½é”™è¯¯\u0026#34;, RET.PWDERR : \u0026#34;å¯†ç é”™è¯¯\u0026#34;, RET.REQERR : \u0026#34;éæ³•è¯·æ±‚æˆ–è¯·æ±‚æ¬¡æ•°å—é™\u0026#34;, RET.IPERR : \u0026#34;IPå—é™\u0026#34;, RET.THIRDERR : \u0026#34;ç¬¬ä¸‰æ–¹ç³»ç»Ÿé”™è¯¯\u0026#34;, RET.IOERR : \u0026#34;æ–‡ä»¶è¯»å†™é”™è¯¯\u0026#34;, RET.SERVERERR : \u0026#34;å†…éƒ¨é”™è¯¯\u0026#34;, RET.UNKOWNERR : \u0026#34;æœªçŸ¥é”™è¯¯\u0026#34;, } ","permalink":"https://www.chenzqi.cn/posts/2020/20200529_%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B8%B8%E7%94%A8%E5%90%8E%E7%AB%AF%E5%93%8D%E5%BA%94%E7%A0%81/","tags":["web"],"title":"è‡ªå®šä¹‰å¸¸ç”¨åç«¯å“åº”ç "},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip PyQt5å®‰è£…ä¸Qt Designerï¼ŒPyUICåœ¨ PyCharm ä¸­é…ç½® ::: PyQt5,Qt Designerå®‰è£… pip install sip pip install PyQt5 pip install PyQt5-tools å®‰è£…å®Œæˆåï¼Œåœ¨pythonå®‰è£…ç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°ä¸‹é¢æ ‡å‡ºçš„æ–‡ä»¶å¤¹ é…ç½®PyCharm ::: details ä¸ºä»€ä¹ˆé…ç½®PyCharm? é…ç½®PyCharmæ˜¯ä¸ºäº†åœ¨ Pycharm é‡Œé¢å®ç°æ‰“å¼€ Qt Designer ï¼Œç”Ÿæˆqtæ–‡ä»¶ï¼Œæ–¹ä¾¿è½¬æ¢æˆ python æ–‡ä»¶. ::: æ‰“å¼€Pycharmï¼Œsettings æŒ‰ä¸‹å›¾æ“ä½œ Nameï¼šå¯è‡ªå·±å®šä¹‰ Programï¼šæŒ‡å‘ä¸Šè¿°å®‰è£…PyQt5-toolsé‡Œé¢çš„designer.exe Work directoryï¼šä½¿ç”¨å˜é‡ $FileDir$ å†æ–°å»ºä¸€ä¸ªâ€œPyUICâ€ï¼Œè¿™ä¸ªä¸»è¦æ˜¯ç”¨æ¥å°† Qt ç•Œé¢ è½¬æ¢æˆ py ä»£ç  Argumentsçš„å€¼æ”¹æˆä¸‹: -m PyQt5.uic.pyuic $FileName$ -o $FileNameWithoutExtension$.py ä½¿ç”¨ æ‰“å¼€Qt Designerè¿›è¡ŒUIç¼–è¾‘ è®¾è®¡UI ä¿å­˜åä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ç”Ÿæˆuiåç¼€çš„æ–‡ä»¶ï¼Œç‚¹å‡»uiæ–‡ä»¶å³é”® External Tool ã€‹ PyUICï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆpythonæ–‡ä»¶ï¼Œåšä¸€äº›ç¼–è¾‘æ‰èƒ½è¿è¡Œã€‚ä¸¤ç§æ–¹æ¡ˆï¼š ç›´æ¥åœ¨å½“å‰æ–‡ä»¶æ·»åŠ ä»¥ä¸‹ä»£ç  import sys from PyQt5.QtWidgets import QApplication, QMainWindow ... ... if __name__ == \u0026#39;__main__\u0026#39;: app = QApplication(sys.argv) MainWindow = QMainWindow() ui = Ui_MainWindow() ui.setupUi(MainWindow) MainWindow.show() sys.exit(app.exec_()) æ–°å»ºå¯åŠ¨æ–‡ä»¶ï¼ˆæ–¹ä¾¿é€»è¾‘å±‚ç¼–å†™ï¼‰ ","permalink":"https://www.chenzqi.cn/posts/2020/20200526_pyqt5%E5%AE%89%E8%A3%85%E4%B8%8Epycharm%E9%85%8D%E7%BD%AE/","tags":["å·¥å…·","é…ç½®"],"title":"PyQt5å®‰è£…ä¸PyCharmé…ç½®"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip å¾®ä¿¡å°ç¨‹åºç™»å½•APIå®ç° ::: å°ç¨‹åºç™»å½•æµç¨‹ å°ç¨‹åºç«¯è°ƒç”¨ wx.login åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æˆæƒ å°ç¨‹åºç«¯è®¿é—® wx.getUserInfo å°ç¨‹åºç«¯jsä»£ç  wx.login({ success: resp =\u0026gt; { // å‘é€ res.code åˆ°åå°æ¢å– openId, sessionKey, unionId console.log(resp); var that = this; // è·å–ç”¨æˆ·ä¿¡æ¯ wx.getSetting({ success: res =\u0026gt; { if (res.authSetting[\u0026#39;scope.userInfo\u0026#39;]) { // å·²ç»æˆæƒï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ getUserInfo è·å–å¤´åƒæ˜µç§°ï¼Œä¸ä¼šå¼¹æ¡† wx.getUserInfo({ success: userResult =\u0026gt; { var platUserInfoMap = {} platUserInfoMap[\u0026#34;encryptedData\u0026#34;] = userResult.encryptedData; platUserInfoMap[\u0026#34;iv\u0026#34;] = userResult.iv; wx.request({ url: \u0026#39;http://127.0.0.1:5000/user/wxlogin\u0026#39;, data: { platCode: resp.code, platUserInfoMap: platUserInfoMap, }, header: { \u0026#34;Content-Type\u0026#34;: \u0026#34;application/json\u0026#34; }, method: \u0026#39;POST\u0026#39;, dataType:\u0026#39;json\u0026#39;, success: function (res) { console.log(res) wx.setStorageSync(\u0026#34;userinfo\u0026#34;, res.userinfo) //è®¾ç½®æœ¬åœ°ç¼“å­˜ }, fail: function (err) { },//è¯·æ±‚å¤±è´¥ complete: function () { }//è¯·æ±‚å®Œæˆåæ‰§è¡Œçš„å‡½æ•° }) } }) } } }) } }) åç«¯æœåŠ¡å™¨è®¿é—® code2sessionï¼Œé€šè¿‡ code2Session è¿™ä¸ªapiæ¥å£æ¥è·å–çœŸæ­£éœ€è¦çš„å¾®ä¿¡ç”¨æˆ·çš„ç™»å½•æ€ session_ke yå’Œ openid å’Œ unionid. åç«¯æœåŠ¡å™¨æ ¡éªŒç”¨æˆ·ä¿¡æ¯ï¼Œå¯¹ encryptedData è§£å¯† å¾®ä¿¡å°ç¨‹åºç™»å½•åè·å¾— session_key åï¼Œè¿”å›äº†encryptedDataï¼Œiv çš„æ•°æ®ï¼Œå…¶ä¸­ encryptedData è§£å¯†ååŒ…å«äº†ç”¨æˆ·çš„ä¿¡æ¯ï¼Œè§£å¯†åçš„jsonæ ¼å¼å¦‚ä¸‹ï¼š { \u0026#34;openId\u0026#34;: \u0026#34;OPENID\u0026#34;, \u0026#34;nickName\u0026#34;: \u0026#34;NICKNAME\u0026#34;, \u0026#34;gender\u0026#34;: GENDER, \u0026#34;city\u0026#34;: \u0026#34;CITY\u0026#34;, \u0026#34;province\u0026#34;: \u0026#34;PROVINCE\u0026#34;, \u0026#34;country\u0026#34;: \u0026#34;COUNTRY\u0026#34;, \u0026#34;avatarUrl\u0026#34;: \u0026#34;AVATARURL\u0026#34;, \u0026#34;unionId\u0026#34;: \u0026#34;UNIONID\u0026#34;, \u0026#34;watermark\u0026#34;: { \u0026#34;appid\u0026#34;:\u0026#34;APPID\u0026#34;, \u0026#34;timestamp\u0026#34;:TIMESTAMP } } è§£å¯†æ–‡ä»¶ â€”â€” WXBizDataCrypt.py import base64 import json from Crypto.Cipher import AES class WXBizDataCrypt: def __init__(self, appId, sessionKey): self.appId = appId self.sessionKey = sessionKey def decrypt(self, encryptedData, iv): # base64 decode sessionKey = base64.b64decode(self.sessionKey) encryptedData = base64.b64decode(encryptedData) iv = base64.b64decode(iv) cipher = AES.new(sessionKey, AES.MODE_CBC, iv) decrypted = json.loads(self._unpad(cipher.decrypt(encryptedData))) if decrypted[\u0026#39;watermark\u0026#39;][\u0026#39;appid\u0026#39;] != self.appId: raise Exception(\u0026#39;Invalid Buffer\u0026#39;) return decrypted def _unpad(self, s): return s[:-ord(s[len(s)-1:])] Flask çš„ wxlogin API import json, requests from WXBizDataCrypt import WXBizDataCrypt from flask import Flask, jsonify @app.route(\u0026#39;/user/wxlogin\u0026#39;, methods=[\u0026#39;GET\u0026#39;,\u0026#39;POST\u0026#39;]) def user_wxlogin(): appID = \u0026#39;appID\u0026#39; # å¼€å‘è€…å…³äºå¾®ä¿¡å°ç¨‹åºçš„appID appSecret = \u0026#39;appSecret\u0026#39; # å¼€å‘è€…å…³äºå¾®ä¿¡å°ç¨‹åºçš„appSecret data = json.loads(request.get_data().decode(\u0026#39;utf-8\u0026#39;)) # å°†å‰ç«¯Jsonæ•°æ®è½¬ä¸ºå­—å…¸ code = data[\u0026#39;platCode\u0026#39;] # å‰ç«¯POSTè¿‡æ¥çš„å¾®ä¿¡ä¸´æ—¶ç™»å½•å‡­è¯code encryptedData = data[\u0026#39;platUserInfoMap\u0026#39;][\u0026#39;encryptedData\u0026#39;] iv = data[\u0026#39;platUserInfoMap\u0026#39;][\u0026#39;iv\u0026#39;] req_params = { \u0026#39;appid\u0026#39;: appID, \u0026#39;secret\u0026#39;: appSecret, \u0026#39;js_code\u0026#39;: code, \u0026#39;grant_type\u0026#39;: \u0026#39;authorization_code\u0026#39; } wx_login_api = \u0026#39;https://api.weixin.qq.com/sns/jscode2session\u0026#39; response_data = requests.get(wx_login_api, params=req_params) # å‘APIå‘èµ·GETè¯·æ±‚ resData = response_data.json() openid = resData[\u0026#39;openid\u0026#39;] # å¾—åˆ°ç”¨æˆ·å…³äºå½“å‰å°ç¨‹åºçš„OpenID session_key = resData[\u0026#39;session_key\u0026#39;] # å¾—åˆ°ç”¨æˆ·å…³äºå½“å‰å°ç¨‹åºçš„ä¼šè¯å¯†é’¥session_key pc = WXBizDataCrypt(appID, session_key) #å¯¹ç”¨æˆ·ä¿¡æ¯è¿›è¡Œè§£å¯† data = pc.decrypt(encryptedData, iv) #è·å¾—ç”¨æˆ·ä¿¡æ¯ print(userinfo) \u0026#39;\u0026#39;\u0026#39; é€šè¿‡åˆ¤æ–­æ•°æ®åº“ä¸­ç”¨æˆ·æ˜¯å¦å­˜åœ¨æ¥ç¡®å®šæ·»åŠ æˆ–è¿”å›è‡ªå®šä¹‰ç™»å½•æ€ è‹¥ç”¨æˆ·ä¸å­˜åœ¨åˆ™æ·»åŠ ï¼›è‹¥ç”¨æˆ·å­˜åœ¨ï¼Œè¿”å›ç”¨æˆ·ä¿¡æ¯ï¼‰ æ•°æ®åº“ä¸­å¯¹ç”¨æˆ·è¿›è¡Œæ“ä½œ \u0026#39;\u0026#39;\u0026#39; return jsonify(code=200, msg=\u0026#34;ç™»å½•æˆåŠŸ\u0026#34;, data=data) ","permalink":"https://www.chenzqi.cn/posts/2020/20200523_%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%99%BB%E5%BD%95/","tags":["web"],"title":"å¾®ä¿¡å°ç¨‹åºç™»å½•è¯¦è§£åŠFlask APIå®ç°"},{"categories":[2020,"æŠ€æœ¯"],"contents":"å¤šç§å®ç°æ–¹æ¡ˆ: å¼€å¯å¤šä¸ªå‘½ä»¤è¡Œï¼Œåˆ†åˆ«æ‰§è¡Œscrapy cralw xxxx ç¼–å†™è„šæœ¬ï¼Œæ‰§è¡Œå·¥ç¨‹ä¸‹çš„æ‰€æœ‰çˆ¬è™« #!/usr/bin/env python # -*- coding:utf-8 -*- \u0026#34;\u0026#34;\u0026#34; @file: run.py @time: 2020/05/19 9:49 @desc: None @Author: Chenzq @Wechat: * @contact: czq181020@gmail.com \u0026#34;\u0026#34;\u0026#34; from scrapy.utils.project import get_project_settings from scrapy.crawler import CrawlerProcess def main(): setting = get_project_settings() process = CrawlerProcess(setting) didntWorkSpider = [\u0026#39;tb\u0026#39;, \u0026#39;jd\u0026#39;, \u0026#39;anjuke\u0026#39;, \u0026#39;51paimaifang\u0026#39;, \u0026#39;manjuke\u0026#39;, \u0026#39;upd_status\u0026#39;] print(didntWorkSpider) for spider_name in process.spiders.list(): if spider_name in didntWorkSpider: continue print(\u0026#34;Running spider %s\u0026#34; % (spider_name)) process.crawl(spider_name) process.start() main() è„šæœ¬è§£æï¼š æ­£å¸¸æƒ…å†µä¸‹ï¼Œåœ¨ç»ˆç«¯å¯ä»¥é€šè¿‡scrapy crawl *** æ¥è¿è¡ŒæŸä¸ª spiderã€‚ è¿‡ç¨‹å¤§è‡´æ˜¯ï¼Œé¦–å…ˆè¯»å–é…ç½®ï¼Œå…¶ä¸­ SpiderLoader ä¼šé»˜è®¤è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„ SPIDER_MODULES å¯¹åº”çš„æ‰€æœ‰spiderï¼Œå¦å¤–è¿˜éœ€è¦åˆå§‹åŒ–å„ç§ç±»ï¼Œå…¶ä¸­åŒ…å«äº† CrawlerProcess è¿™ä¸ªé‡è¦çš„ç±» cmd.crawler_process = CrawlerProcess(settings)ï¼Œç„¶åè°ƒç”¨ crawl scrapy.commands.crawl, è¿™ä¸ªç»ˆç«¯å‘½ä»¤ run æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œè¯¥å®ç°ä¸­self.crawler_process.crawl(spname, **opts.spargs)ï¼Œself.crawler_process.start() ä½¿ç”¨scrapydï¼Œéƒ¨ç½²çˆ¬è™«ï¼Œé€šè¿‡scrapydçš„APIè°ƒç”¨çˆ¬è™« æ¨èä½¿ç”¨ spiderkeeperæˆ–è€… gerapyï¼Œspiderkeeperå¯ä»¥å®šæ—¶è¿è¡Œçˆ¬è™«ã€‚ ","permalink":"https://www.chenzqi.cn/posts/2020/20200519_scrapy%E5%90%8C%E6%97%B6%E8%BF%90%E8%A1%8C%E5%A4%9A%E4%B8%AA%E7%88%AC%E8%99%AB/","tags":["çˆ¬è™«","æ¡†æ¶","scrapy"],"title":"ScrapyåŒæ—¶è¿è¡Œå¤šä¸ªçˆ¬è™«"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip å®‰å±…å®¢ç½‘é¡µä»·æ ¼å­—ä½“åŠ å¯†é—®é¢˜ ::: é—®é¢˜ ç”±jsç”Ÿæˆçš„fangchan-secretè‡ªå®šä¹‰å­—ä½“ï¼Œæ¯éš”å‡ ç§’é’Ÿå˜åŒ–fangchan-secretçš„keyã€‚ è§£å†³ æ ¹æ®ç½‘å€è·å¾—çš„fangchan-secretçš„keyæ¥è§£ç  bs64_stræ˜¯ç½‘é¡µå†…å®¹æ­£åˆ™åŒ¹é…åˆ°çš„key: bs64_str = re.findall(\u0026#34;charset=utf-8;base64,(.*?)\u0026#39;\\)\u0026#34;, html_str)[0] from io import BytesIO from fontTools.ttLib import TTFont import base64 def get_page_show_ret(mystr, bs64_str): \u0026#39;\u0026#39;\u0026#39; :param mystr: è¦è½¬ç çš„å­—ç¬¦ä¸² :param bs64_str: è½¬ç æ ¼å¼ :return: è½¬ç åçš„å­—ç¬¦ä¸² \u0026#39;\u0026#39;\u0026#39; font = TTFont(BytesIO(base64.decodebytes(bs64_str.encode()))) c = font[\u0026#39;cmap\u0026#39;].tables[0].ttFont.tables[\u0026#39;cmap\u0026#39;].tables[0].cmap ret_list = [] for char in mystr: decode_num = ord(char) if decode_num in c: num = c[decode_num] num = int(num[-2:]) - 1 ret_list.append(num) else: ret_list.append(char) ret_str_show = \u0026#39;\u0026#39; for num in ret_list: ret_str_show += str(num) return ret_str_show ","permalink":"https://www.chenzqi.cn/posts/2020/20200516_%E5%AE%89%E5%B1%85%E5%AE%A2%E5%AD%97%E4%BD%93%E8%A7%A3%E5%AF%86/","tags":["çˆ¬è™«","è§£å¯†"],"title":"å®‰å±…å®¢å­—ä½“è§£å¯†"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip scrapyä¸­é—´ä»¶é‡æ„ ::: å®˜æ–¹æ–‡æ¡£ï¼šDownloader Middleware é‡å†™ import json # å¤„ç†jsonçš„åŒ… import redis # Pythonæ“ä½œredisçš„åŒ… import random # éšæœºé€‰æ‹© from .useragent import agents # å¯¼å…¥è¯·æ±‚å¤´åˆ—è¡¨ from scrapy.downloadermiddlewares.useragent import UserAgentMiddleware # UserAegentä¸­é—´ä»¶ from scrapy.downloadermiddlewares.retry import RetryMiddleware # é‡è¯•ä¸­é—´ä»¶ class UserAgentmiddleware(UserAgentMiddleware): def process_request(self, request, spider): agent = random.choice(agents) request.headers[\u0026#34;User-Agent\u0026#34;] = agent å®šä¹‰äº†ä¸€ä¸ªç±» UserAgentmiddleware ç»§æ‰¿è‡ª UserAgentMiddleware ã€‚ å®šä¹‰äº†å‡½æ•° process_request(request, spider) ï¼ŒScrapy æ¯ä¸€ä¸ª request é€šè¿‡ä¸­é—´ ä»¶éƒ½ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚ éšæœºé€‰æ‹©ä¸€ä¸ª User-Agentã€‚ è®¾ç½® request çš„ User-Agent ä¸ºæˆ‘ä»¬éšæœºçš„ User-Agentã€‚ Cookie æ±  ç»´æŠ¤ä¸€ä¸ª Cookie æ±  (redis)ï¼Œå¤‡äº›åŠŸèƒ½ï¼š è·å– Cookie æ›´æ–° Cookie åˆ é™¤ Cookie åˆ¤æ–­ Cookie æ˜¯å¦å¯ç”¨è¿›è¡Œç›¸å¯¹åº”çš„æ“ä½œï¼ˆæ¯”å¦‚é‡è¯•ï¼‰ æ–°å»ºä¸€ä¸ª cookies.py çš„æ–‡ä»¶ï¼Œå¯¼å…¥éœ€è¦çš„æ–‡ä»¶ï¼š import requests import json import redis import logging from .settings import REDIS_URL ##è·å–settings.pyä¸­çš„REDIS_URL ç™»é™†ç”¨çš„è´¦å·å¯†ç  ä»¥ Key:value çš„å½¢å¼å­˜å…¥ redis æ•°æ®åº“ã€‚ä¸æ¨èä½¿ç”¨ db0ï¼ˆè´¦å·å¯†ç å•ç‹¬ä½¿ç”¨ä¸€ä¸ª db è¿›è¡Œå­˜å‚¨ï¼‰ è·å– Cookie import requests import json import redis import logging from .settings import REDIS_URL logger = logging.getLogger(__name__) # ä½¿ç”¨REDIS_URLé“¾æ¥Redisæ•°æ®åº“, deconde_responses=True è¿™ä¸ªå‚æ•°å¿…é¡»è¦ï¼Œæ•°æ®ä¼šå˜æˆbyteå½¢å¼ å®Œå…¨æ²¡æ³•ç”¨ reds = redis.Redis.from_url(REDIS_URL, db=2, decode_responses=True) login_url = \u0026#39;http://haoduofuli.pw/wp-login.php\u0026#39; # è·å–Cookie def get_cookie(account, password): s = requests.Session() payload = { \u0026#39;log\u0026#39;: account, \u0026#39;pwd\u0026#39;: password, \u0026#39;rememberme\u0026#39;: \u0026#34;forever\u0026#34;, \u0026#39;wp-submit\u0026#39;: \u0026#34;ç™»å½•\u0026#34;, \u0026#39;redirect_to\u0026#39;: \u0026#34;http://http://www.haoduofuli.pw/wp-admin/\u0026#34;, \u0026#39;testcookie\u0026#39;: \u0026#34;1\u0026#34; } response = s.post(login_url, data=payload) cookies = response.cookies.get_dict() logger.warning(\u0026#34;è·å–CookieæˆåŠŸï¼ï¼ˆè´¦å·ä¸º:%sï¼‰\u0026#34; % account) return json.dumps(cookies) ä½¿ç”¨ requests æ¨¡å—æäº¤è¡¨å•ç™»é™†è·å¾— Cookieï¼Œè¿”å›ä¸€ä¸ªé€šè¿‡ Json åºåˆ—åŒ–åçš„ Cookieï¼ˆå¦‚æœä¸åºåˆ—åŒ–ï¼Œå­˜å…¥ Redis åä¼šå˜æˆ Plain Text æ ¼å¼çš„ï¼Œåé¢å–å‡ºæ¥ Cookie å°±æ²¡æ³•ç”¨ï¼‰ å°† Cookie å†™å…¥ Redis æ•°æ®åº“ï¼ˆå…¶å®ƒ Spider ä¹Ÿèƒ½ä½¿ç”¨è¿™ä¸ª Cookie ï¼‰: def init_cookie(red, spidername): redkeys = reds.keys() for user in redkeys: password = reds.get(user) if red.get(\u0026#34;%s:Cookies:%s--%s\u0026#34; % (spidername, user, password)) is None: cookie = get_cookie(user, password) red.set(\u0026#34;%s:Cookies:%s--%s\u0026#34;% (spidername, user, password), cookie) é‡å†™ Cookie ä¸­é—´ä»¶ class CookieMiddleware(RetryMiddleware): def __init__(self, settings, crawler): # ç»§æ‰¿çˆ¶ç±»ä¹‹åï¼›å­ç±»æ˜¯ä¸èƒ½ç”¨ def init() æ–¹æ³•çš„ï¼Œéœ€è¦é‡è½½çˆ¶ç±»æ‰å¯ä»¥ç”¨ RetryMiddleware.__init__(self, settings) self.rconn = redis.from_url(settings[\u0026#39;REDIS_URL\u0026#39;], db=1, decode_responses=True #decode_responsesè®¾ç½®å–å‡ºçš„ç¼–ç ä¸ºstr # å¾€ redis ä¸­æ·»åŠ  cookie init_cookie(self.rconn, crawler.spider.name) @classmethod def from_crawler(cls, crawler): return cls(crawler.settings, crawler) def process_request(self, request, spider): redisKeys = self.rconn.keys() while len(redisKeys) \u0026gt; 0: elem = random.choice(redisKeys) if spider.name + \u0026#39;:Cookies\u0026#39; in elem: cookie = json.loads(self.rconn.get(elem)) request.cookies = cookie request.meta[\u0026#34;accountText\u0026#34;] = elem.split(\u0026#34;Cookies:\u0026#34;)[-1] break è®¿é—® settings çš„æ–¹æ³•å®˜æ–¹æ–‡æ¡£ï¼šå®˜æ–¹æ–‡æ¡£ å®Œæ•´ä»£ç  # -*- coding: utf-8 -*- # Define here the models for your spider middleware # # See documentation in: # http://doc.scrapy.org/en/latest/topics/spider-middleware.html from scrapy import signals import json import redis import random from .useragent import agents from .cookies import init_cookie, remove_cookie, update_cookie from scrapy.downloadermiddlewares.useragent import UserAgentMiddleware from scrapy.downloadermiddlewares.retry import RetryMiddleware import logging logger = logging.getLogger(__name__) class UserAgentmiddleware(UserAgentMiddleware): def process_request(self, request, spider): agent = random.choice(agents) request.headers[\u0026#34;User-Agent\u0026#34;] = agent class CookieMiddleware(RetryMiddleware): def __init__(self, settings, crawler): RetryMiddleware.__init__(self, settings) self.rconn = redis.from_url(settings[\u0026#39;REDIS_URL\u0026#39;], db=1, decode_responses=True) #decode_responsesè®¾ç½®å–å‡ºçš„ç¼–ç ä¸ºstr init_cookie(self.rconn, crawler.spider.name) def from_crawler(cls, crawler): return cls(crawler.settings, crawler) def process_request(self, request, spider): redisKeys = self.rconn.keys() while len(redisKeys) \u0026gt; 0: elem = random.choice(redisKeys) if spider.name + \u0026#39;:Cookies\u0026#39; in elem: cookie = json.loads(self.rconn.get(elem)) request.cookies = cookie request.meta[\u0026#34;accountText\u0026#34;] = elem.split(\u0026#34;Cookies:\u0026#34;)[-1] break #else: #redisKeys.remove(elem) #def process_response(self, request, response, spider): # # \u0026#34;\u0026#34;\u0026#34; # åˆ¤æ–­cookieæ˜¯å¦å¤±æ•ˆ # è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œå¦‚æ›´æ–°cookie åˆ é™¤ä¸èƒ½ç”¨çš„è´¦å· # \u0026#34;\u0026#34;\u0026#34; ","permalink":"https://www.chenzqi.cn/posts/2020/20200515_%E9%87%8D%E5%86%99scrapy%E4%B8%8B%E8%BD%BD%E4%B8%AD%E9%97%B4%E4%BB%B6/","tags":["çˆ¬è™«","æ¡†æ¶","scrapy"],"title":"é‡è½½Scrapyä¸‹è½½ä¸­é—´ä»¶åŠCookieæ± "},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip ä½¿ç”¨pythonæ‰§è¡ŒJSä»£ç  ::: ç®€ä»‹ å¯¹äºç®€å•çš„ JS æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡ Python ä»£ç ï¼Œç›´æ¥é‡å†™ï¼Œè½»è½»æ¾æ¾çš„å°±èƒ½æå®šã€‚ è€Œå¯¹äºå¤çš„ JS ä»£ç ï¼Œç”±äºä»£ç è¿‡äºå¤æ‚ï¼Œé‡å†™å¤ªè´¹æ—¶è´¹åŠ›ï¼Œä¸”ç¢°åˆ°å¯¹æ–¹æ›´æ–°å°±æ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥ï¼Œä¸€èˆ¬ç›´æ¥ä½¿ç”¨ç¨‹åºå»è°ƒç”¨ JSï¼Œåœ¨ Python å±‚é¢å°±åªæ˜¯è·å–ä¸€ä¸ªè¿è¡Œç»“æœï¼Œè¿™æ ·åšç›¸æ¯”äºé‡å†™è€Œè¨€å°±æ–¹ä¾¿å¤šäº†ã€‚ é€šå¸¸æ¥è¯´ç¢°åˆ° JSã€€é€†å‘ç½‘ç«™æ—¶ä¼šæœ‰è¿™ä¸¤ç§æƒ…å†µï¼š ç®€å• JS ç ´è§£ï¼šé€šè¿‡ Python ä»£ç è½»æ¾å®ç°ã€‚ å¤æ‚çš„ JS ç ´è§£ï¼šä»£ç ä¸å®¹æ˜“é‡å†™ï¼Œä½¿ç”¨ç¨‹åºç›´æ¥è°ƒç”¨ JS è¿è¡Œè·å–ç»“æœã€‚ 1 Base64 Base64 æ˜¯æˆ‘ä»¬å†å†™çˆ¬è™«è¿‡ç¨‹ä¸­ç»å¸¸çœ‹åˆ°çš„ä¸€ç§ç¼–ç æ–¹å¼. // åŸå­—ç¬¦ NightTeam // ç¼–ç ä¹‹åçš„ï¼š TmlnaHRUZWFt // åŸå­—ç¬¦ aiyuechuang // ç¼–ç ä¹‹åçš„ï¼š YWl5dWVjaHVhbmc= // åŸå­—ç¬¦ Python3 // ç¼–ç ä¹‹å UHl0aG9uMw== ç¬¬äºŒä¸ªä¾‹å­æ˜¯ aiyuechuang ç¼–ç ä¹‹åçš„ç»“æœï¼Œå®ƒçš„æœ«å°¾æœ‰ä¸€ä¸ªç­‰å·ï¼ŒPython3 ç¼–ç ä¹‹åæœ«å°¾æœ‰ä¸¤ä¸ªç­‰å·ï¼Œè¿™ä¸ªç‰¹å¾ç›¸å¯¹ç¬¬ä¸€ä¸ªå°±æ¯”è¾ƒæ˜æ˜¾ã€‚ä¸€èˆ¬çœ‹åˆ°å°¾å·æœ‰ä¸¤ä¸ªç­‰å·æ—¶åº”è¯¥å¤§æ¦‚å¯ä»¥çŒœåˆ°è¿™ä¸ªå°±æ˜¯ Base64 ã€‚ ç„¶åï¼Œç›´æ¥è§£ç çœ‹ä¸€çœ‹ï¼Œå¦‚æœæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„è¯ï¼Œå°±å¯ä»¥ä½¿ç”¨ Python è¿›è¡Œé‡å†™. 2 MD5 MD5 åœ¨ Javascript ä¸­å¹¶æ²¡æœ‰æ ‡å‡†çš„åº“ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨å¼€æºåº“å»æ“ä½œã€‚ é€šå¸¸çœ‹åˆ° 32 ä½çš„ä¸€ä¸ªè‹±æ–‡æ•°å­—æ··åˆçš„å­—ç¬¦ä¸²ï¼Œåº”è¯¥é©¬ä¸Šå°±èƒ½æƒ³åˆ°æ—¶ md5 äº†ï¼Œè¿™ä¸¤ä¸ªæ“ä½œçš„è¯ï¼Œå› ä¸ºåœ¨ Python ä¸­éƒ½æœ‰å¯¹åº”çš„åº“ï¼Œåˆ†åˆ«æ˜¯ï¼šBase64 å’Œ hashlibã€‚ import base64 str1 = b\u0026#39;aiyuechuang\u0026#39; str2 = base64.b64encode(str1) print(str2) str3 = base64.b64decode(\u0026#39;YWl5dWVjaHVhbmc=\u0026#39;) print(str3) è¾“å‡º: b\u0026#39;YWl5dWVjaHVhbmc=\u0026#39; b\u0026#39;aiyuechuang\u0026#39; import hashlib data = \u0026#34;aiyuechuang\u0026#34; result = hashlib.md5(data.encode(encoding = \u0026#34;UTF-8\u0026#34;)).hexdigest() print(result) è¾“å‡ºï¼š e55babec7f5d5cf7bac7872f0481bec1 3 Python è°ƒç”¨ JS Python è°ƒç”¨ JS åº“çš„åº“ã€‚ PyV8 Js2Py PyExecJS PyminiRacer Selenium Pyppeteer 3.1 PyExecJS è¯ç”Ÿäº Ruby ä¸­çš„åº“ï¼Œåæ¥è¢«ç§»æ¤åˆ°äº† Python ä¸Š è¾ƒæ–°çš„æ–‡ç« ä¸€èˆ¬éƒ½ä¼šè¯´ç”¨å®ƒæ¥æ‰§è¡Œ JS ä»£ç  æœ‰å¤šä¸ªå¼•æ“å¯é€‰ï¼Œä½†ä¸€èˆ¬æˆ‘ä»¬ä¼šé€‰æ‹©ä½¿ç”¨ NodeJS ä½œä¸ºå¼•æ“æ¥æ‰§è¡Œä»£ç  3.2 PyExecJS çš„ä½¿ç”¨ å®‰è£… JS è¿è¡Œç¯å¢ƒNode.js æ³¨æ„ï¼šè™½ç„¶ Windows ä¸Šæœ‰ä¸ªç³»ç»Ÿè‡ªå¸¦çš„ JScriptï¼Œå¯ä»¥ç”¨æ¥ä½œä¸º PyExecjs çš„å¼•æ“ï¼Œä½†æ˜¯è¿™ä¸ª JScript å¾ˆå®¹æ˜“ä¸å…¶ä»–çš„å¼•æ“æœ‰ä¸€ä¸ªä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œå®¹æ˜“è¸©åˆ°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„å‘ã€‚æ‰€ä»¥è¯·å¤§å®¶åŠ¡å¿…è¦å®‰è£…ä¸€ä¸ªå…¶ä»–çš„å¼•æ“ã€‚æ¯”å¦‚è¯´æˆ‘ä»¬è¿™é‡Œå®‰è£… Node.js ã€‚ å®‰è£… PyExecJS pip install pyexecjs æ£€æµ‹è¿è¡Œç¯å¢ƒ IPython ç»ˆç«¯æ‰§è¡Œ In [1]: import execjs In [2]: execjs.get().name # æŸ¥çœ‹è°ƒç”¨ç¯å¢ƒ Out[2]: \u0026#39;Node.js (V8)\u0026#39; execjs.get() # æŸ¥çœ‹è°ƒç”¨çš„ç¯å¢ƒç”¨æ­¤æ¥çœ‹çœ‹æˆ‘ä»¬çš„åº“èƒ½ä¸èƒ½æ£€æµ‹åˆ° nodejsï¼Œå¦‚æœä¸èƒ½çš„è¯é‚£å°±éœ€è¦æ‰‹åŠ¨è®¾ç½®ã€‚ # é•¿æœŸä½¿ç”¨ os.environ[\u0026#34;EXECJS_RUNTIME\u0026#34;]=\u0026#34;Node\u0026#34; # ä¸´æ—¶ä½¿ç”¨ import execjs.runtime_names node=execjs.get(execjs.runtime_names.Node) ä¸¤ç§å½¢å¼ï¼šä¸€ç§æ˜¯é•¿æœŸä½¿ç”¨çš„ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡çš„å½¢å¼ï¼Œé€šè¿‡æŠŠç¯å¢ƒå˜é‡æ”¹æˆå¤§å†™çš„ EXECJS_RUNTIME ç„¶åå°†å…¶å€¼èµ‹å€¼ä¸º Nodeã€‚ å¦ä¸€ç§çš„è¯ï¼Œå°†å®ƒæ”¹æˆä¸´æ—¶ä½¿ç”¨çš„ä¸€ç§æ–¹å¼ï¼Œè¿™ç§æ˜¯ç›´æ¥ä½¿ç”¨ getï¼Œè¿™ç§åšæ³•çš„è¯ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å°±éœ€è¦ä½¿ç”¨ node å˜é‡äº†ï¼Œä¸èƒ½ç›´æ¥å¯¼å…¥ PyExecjs æ¥ç›´æ¥å¼€å§‹ä½¿ç”¨ï¼Œç›¸å¯¹éº»çƒ¦ä¸€äº› ä½¿ç”¨ from pprint import pprint import execjs import pathlib import os js_path = pathlib.Path(os.path.abspath(os.path.dirname(__file__))) js_path = js_path / \u0026#34;crypto.js\u0026#34; with js_path.open(\u0026#39;r\u0026#39;, encoding=\u0026#34;utf-8\u0026#34;) as f: script = f.read() c = \u0026#34;1234\u0026#34; # ä¼ å…¥pythonä¸­çš„å˜é‡ add = (\u0026#39;\u0026#39;\u0026#39; aesEncrypt = function() { result={} var t = CryptoJS.MD5(\u0026#34;login.xxx.com\u0026#34;), i = CryptoJS.enc.Utf8.parse(t), r = CryptoJS.enc.Utf8.parse(\u0026#34;1234567812345678\u0026#34;), u = CryptoJS.AES.encrypt(\u0026#39;\u0026#39;\u0026#39; + \u0026#34;\u0026#39;{}\u0026#39;\u0026#34;.format(c) + \u0026#39;\u0026#39;\u0026#39;,i, { iv: r }); result.t=t.toString() result.i =i.toString() result.r =r.toString() result.u =u.toString() return result }; \u0026#39;\u0026#39;\u0026#39;) script = script + add print(\u0026#34;script\u0026#34;,script) x = execjs.compile(script) result = x.call(\u0026#34;aesEncrypt\u0026#34;) print(result) å®é™…ä½¿ç”¨æ—¶ï¼Œå¦‚æœéœ€è¦åœ¨ Python ä¸­æ‹¿åˆ° object çš„è¯ï¼Œå»ºè®®æŠŠå®ƒè½¬æ¢æˆä¸€ä¸ª json å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ç›´æ¥çš„æŠŠç»“æœ return å‡ºæ¥ã€‚ å› ä¸ºï¼Œæœ‰äº›æ—¶å€™ PyExecjs å¯¹ object çš„è½¬æ¢ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥å¯èƒ½ä¼šæ‹¿åˆ°ä¸€äº›ç±»ä¼¼äºå°†å­—å…¸ç›´æ¥ç”¨ str å‡½æ•°åŒ…è£¹åè½¬ä¸ºå­—ç¬¦ä¸²çš„ä¸€ä¸ªä¸œè¥¿ï¼Œè¿™æ ·çš„è¯å®ƒæ˜¯æ— æ³•é€šè¿‡æ­£å¸¸çš„æ–¹å¼å»è§£æçš„ PyExecJS å­˜åœ¨çš„ä¸€äº›é—®é¢˜ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š æ‰§è¡Œå¤§å‹ JS æ—¶ä¼šæœ‰ç‚¹æ…¢ï¼ˆè¿™ä¸ªæ˜¯å› ä¸ºï¼Œæ¯æ¬¡æ‰§è¡Œ JS ä»£ç çš„æ—¶å€™ï¼Œéƒ½æ˜¯ä»å‘½ä»¤è¡Œå»è°ƒç”¨åˆ°çš„ JSï¼Œæ‰€ä»¥ JS ä»£ç è¶Šå¤æ‚çš„è¯ï¼Œnodejs çš„åˆå§‹åŒ–æ—¶é—´å°±è¶Šé•¿ï¼Œè¿™ä¸ªåŸºæœ¬ä¸Šæ˜¯æ— è§£çš„ï¼‰ ç‰¹æ®Šç¼–ç çš„è¾“å…¥æˆ–è¾“å‡ºå‚æ•°ä¼šå‡ºç°æŠ¥é”™çš„æƒ…å†µï¼ˆå› ä¸ºï¼Œæ˜¯ä»å‘½ä»¤è¡Œè°ƒç”¨çš„ï¼Œæ‰€ä»¥åœ¨ç¢°åˆ°ä¸€äº›ç‰¹æ®Šå­—ç¬¦è¾“å…¥æˆ–è¾“å‡ºå‚æ•°æˆ–è€… JS ä»£ç æœ¬èº«å°±æœ‰ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„æƒ…å†µä¸‹ï¼Œå°±ä¼šç›´æ¥æ‰§è¡Œä¸äº†ï¼Œç»™ä½ æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ä¸è¿‡è¿™ä¸ªè·Ÿç³»ç»Ÿçš„å‘½ä»¤è¡Œé»˜è®¤ç¼–ç æœ‰ä¸€å®šå…³ç³»ï¼Œå…·ä½“çš„è¯è¿™é‡Œå°±ä¸æ·±ç©¶äº†ï¼Œç›´æ¥å°±è¯´è§£å†³æ–¹æ¡ˆå§ã€‚ï¼‰ å¯ä»¥æŠŠè¾“å…¥æˆ–è¾“å‡ºçš„å‚æ•°ä½¿ç”¨ Base64 ç¼–ç ä¸€ä¸‹ï¼ˆå¦‚æœçœ‹æŠ¥é”™æ˜¯ JS ä»£ç éƒ¨åˆ†å¯¼è‡´çš„ï¼Œé‚£å°±å»çœ‹çœ‹èƒ½ä¸èƒ½åˆ é™¤ä»£ç ä¸­çš„é‚£éƒ¨åˆ†å­—ç¬¦æˆ–è€…ä½ è‡ªå·± new ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå°†é‚£ä¸ªåå« tempfile çš„å‚æ•°æ‰“å¼€ï¼Œè¿™æ ·åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œå®ƒå°±ç›´æ¥å»æ‰§è¡Œé‚£ä¸ªæ–‡ä»¶äº†ï¼Œä¸è¿‡å¤§é‡è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå¯¹ç£ç›˜é€ æˆä¸€å®šå‹åŠ›ã€‚ è€Œå¦‚æœå‚æ•°ä¸å……åˆ†å¯¼è‡´çš„è¯ï¼Œæœ‰ä¸ªå¾ˆç®€å•çš„æ–¹æ³•ï¼šå°±æ˜¯æŠŠå‚æ•°ä½¿ç”¨ Base64 ç¼–ç ä¸€ä¸‹ï¼Œå› ä¸ºç¼–ç ä¹‹åå‡ºæ¥çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬çŸ¥é“ Base64 ç¼–ç ä¹‹åæ˜¯ç”Ÿæˆè‹±æ–‡å’Œæ•°å­—ç»„æˆçš„ã€‚è¿™æ ·å°±æ²¡æœ‰ç‰¹æ®Šç¬¦å·äº†ã€‚æ‰€ä»¥å°±ä¸ä¼šå‡ºç°é—®é¢˜äº†ã€‚ï¼‰ ","permalink":"https://www.chenzqi.cn/posts/2020/20200511_js-%E9%80%86%E5%90%91--python-%E8%B0%83%E7%94%A8js%E4%BB%A3%E7%A0%81/","tags":["python","çˆ¬è™«"],"title":"JSé€†å‘ - Pythonè°ƒç”¨JSä»£ç "},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip ä¸€ä¸ªå…·æœ‰å®æ—¶é‡æ–°åŠ è½½åŠŸèƒ½çš„å°å‹å¼€å‘æœåŠ¡å™¨ ::: ç®€ä»‹ è¿™æ˜¯ä¸€ä¸ªå…·æœ‰å®æ—¶é‡æ–°åŠ è½½åŠŸèƒ½çš„å°å‹å¼€å‘æœåŠ¡å™¨ã€‚ä½¿ç”¨å®ƒæ¥å…¥ä¾µæ‚¨çš„HTML / JavaScript / CSSæ–‡ä»¶ï¼Œè€Œä¸æ˜¯ç”¨äºéƒ¨ç½²æœ€ç»ˆç«™ç‚¹ã€‚ ä½¿ç”¨æ­¤æ–‡ä»¶æœ‰ä¸¤ä¸ªåŸå› ï¼š file://ç”±äºå®‰å…¨é™åˆ¶ï¼ŒAJAXè¯·æ±‚ä¸é€‚ç”¨äºè¯¥åè®®ï¼Œå³ï¼Œå¦‚æœæ‚¨çš„ç«™ç‚¹é€šè¿‡JavaScriptè·å–å†…å®¹ï¼Œåˆ™æ‚¨éœ€è¦ä¸€å°æœåŠ¡å™¨ã€‚ æ–‡ä»¶æ›´æ”¹åè‡ªåŠ¨é‡æ–°åŠ è½½é¡µé¢å¯ä»¥åŠ å¿«å¼€å‘é€Ÿåº¦ å®‰è£… æ‚¨éœ€è¦node.jså’Œnpmã€‚æ‚¨å¯èƒ½åº”è¯¥åœ¨å…¨å±€èŒƒå›´å†…å®‰è£…å®ƒã€‚ Npmæ–¹å¼ npm install -g live-server æ‰‹åŠ¨æ–¹å¼ git clone https://github.com/tapio/live-server cd live-server npm install # Local dependencies if you want to hack npm install -g # Install globally ä½¿ç”¨ live-server åœ¨é¡¹ç›®ç›®å½•ä¸­å‘å‡ºå‘½ä»¤ã€‚æˆ–è€…ï¼Œå¯ä»¥æ·»åŠ è·¯å¾„ä»¥ç”¨ä½œå‘½ä»¤è¡Œå‚æ•°ã€‚ è¿™å°†è‡ªåŠ¨å¯åŠ¨é»˜è®¤æµè§ˆå™¨ã€‚å½“æ‚¨å¯¹ä»»ä½•æ–‡ä»¶è¿›è¡Œæ›´æ”¹æ—¶ï¼Œæµè§ˆå™¨éƒ½ä¼šé‡æ–°åŠ è½½é¡µé¢-é™¤éå®ƒæ˜¯CSSæ–‡ä»¶ï¼Œå¦åˆ™åœ¨ä¸é‡æ–°åŠ è½½çš„æƒ…å†µä¸‹åº”ç”¨æ›´æ”¹ã€‚ å‘½ä»¤è¡Œå‚æ•°ï¼š \u0026ndash;port=NUMBER -é€‰æ‹©è¦ä½¿ç”¨çš„ç«¯å£ï¼Œé»˜è®¤ï¼šPORT env varæˆ–8080 \u0026ndash;host=ADDRESS -é€‰æ‹©è¦ç»‘å®šåˆ°çš„ä¸»æœºåœ°å€ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼šIP env varæˆ–0.0.0.0ï¼ˆâ€œä»»ä½•åœ°å€â€ï¼‰ \u0026ndash;no-browser -ç¦æ­¢è‡ªåŠ¨å¯åŠ¨Webæµè§ˆå™¨ \u0026ndash;browser=BROWSER -æŒ‡å®šè¦ä½¿ç”¨çš„æµè§ˆå™¨ï¼Œè€Œä¸æ˜¯ç³»ç»Ÿé»˜è®¤å€¼ \u0026ndash;quiet | -q -ç¦æ­¢è®°å½• \u0026ndash;verbose | -V -æ›´å¤šæ—¥å¿—è®°å½•ï¼ˆè®°å½•æ‰€æœ‰è¯·æ±‚ï¼Œæ˜¾ç¤ºæ‰€æœ‰ä¾¦å¬çš„IPv4æ¥å£ï¼Œç­‰ç­‰ï¼‰ \u0026ndash;open=PATH -å°†æµè§ˆå™¨å¯åŠ¨åˆ°PATHè€Œä¸æ˜¯æœåŠ¡å™¨æ ¹ç›®å½• \u0026ndash;watch=PATH -ä»¥é€—å·åˆ†éš”çš„è·¯å¾„å­—ç¬¦ä¸²ï¼Œä¸“é—¨ç”¨äºç›‘è§†æ›´æ”¹ï¼ˆé»˜è®¤å€¼ï¼šç›‘è§†æ‰€æœ‰å†…å®¹ï¼‰ \u0026ndash;ignore=PATH-é€—å·åˆ†éš”çš„è·¯å¾„å­—ç¬¦ä¸²ï¼Œå¯ä»¥å¿½ç•¥ï¼ˆanymatchå…¼å®¹å®šä¹‰ï¼‰ \u0026ndash;ignorePattern=RGXP-æ–‡ä»¶çš„æ­£åˆ™è¡¨è¾¾å¼å¿½ç•¥ï¼ˆå³.*.jadeï¼‰ï¼ˆä¸æ¨èä½¿ç”¨èµæˆ\u0026ndash;ignoreï¼‰ \u0026ndash;no-css-inject -åœ¨CSSæ›´æ”¹æ—¶é‡æ–°åŠ è½½é¡µé¢ï¼Œè€Œä¸æ˜¯æ³¨å…¥æ›´æ”¹çš„CSS \u0026ndash;middleware=PATH-å¯¼å‡ºè¦æ·»åŠ çš„ä¸­é—´ä»¶åŠŸèƒ½çš„.jsæ–‡ä»¶çš„è·¯å¾„ï¼›å¯ä»¥æ˜¯æ²¡æœ‰è·¯å¾„çš„åç§°ï¼Œä¹Ÿä¸èƒ½æ˜¯å¼•ç”¨middlewareæ–‡ä»¶å¤¹ä¸­æ†ç»‘çš„ä¸­é—´ä»¶çš„æ‰©å±•å \u0026ndash;entry-file=PATH -æä¾›æ­¤æ–‡ä»¶ï¼ˆç›¸å¯¹äºæœåŠ¡å™¨æ ¹ç›®å½•çš„æ–‡ä»¶ï¼‰ä»£æ›¿ä¸¢å¤±çš„æ–‡ä»¶ï¼ˆå¯¹äºå•é¡µåº”ç”¨ç¨‹åºå¾ˆæœ‰ç”¨ï¼‰ \u0026ndash;mount=ROUTE:PATH -åœ¨å®šä¹‰çš„è·¯çº¿ä¸‹æŠ•æ”¾è·¯å¾„å†…å®¹ï¼ˆå¯èƒ½æœ‰å¤šä¸ªå®šä¹‰ï¼‰ \u0026ndash;spa -å°†è¯·æ±‚ä»/ abcè½¬æ¢ä¸º/ï¼ƒ/ abcï¼ˆå¯¹äºå•é¡µåº”ç”¨ç¨‹åºéå¸¸æ–¹ä¾¿ï¼‰ \u0026ndash;wait=MILLISECONDS -ï¼ˆé»˜è®¤100msï¼‰ç­‰å¾…æ‰€æœ‰æ›´æ”¹ï¼Œç„¶åé‡æ–°åŠ è½½ \u0026ndash;htpasswd=PATH -å¯ç”¨ä½äºPATHçš„http-authæœŸæœ›htpasswdæ–‡ä»¶ \u0026ndash;cors -ä¸ºä»»ä½•æ¥æºå¯ç”¨CORSï¼ˆåæ˜ è¯·æ±‚æ¥æºï¼Œæ”¯æŒå¸¦æœ‰å‡­æ®çš„è¯·æ±‚ï¼‰ \u0026ndash;https=PATH -HTTPSé…ç½®æ¨¡å—çš„è·¯å¾„ \u0026ndash;https-module=MODULE_NAME-è‡ªå®šä¹‰HTTPSæ¨¡å—ï¼ˆä¾‹å¦‚spdyï¼‰ \u0026ndash;proxy=ROUTE:URL -å°†æ‰€æœ‰å¯¹ROUTEçš„è¯·æ±‚ä»£ç†åˆ°URL \u0026ndash;help | -h -æ˜¾ç¤ºç®€æ´çš„ä½¿ç”¨æç¤ºå¹¶é€€å‡º \u0026ndash;version | -v -æ˜¾ç¤ºç‰ˆæœ¬å¹¶é€€å‡º ","permalink":"https://www.chenzqi.cn/posts/2020/20200504_live-server/","tags":["web","å‰ç«¯"],"title":"Live Server å®æ—¶æœåŠ¡å™¨"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip è”é€šå†…ç½‘å·¥å•ç™»å½•ç³»ç»Ÿç ´è§£æµç¨‹ ::: è®°å½•ä½¿ç”¨tkinter + pythonå®Œæˆä¸­å›½è”é€šå·¥å•ç³»ç»Ÿçš„æŠ“å–ç¨‹åºã€‚ä½¿ç”¨VPN + fiddler + postmanåˆ†æç³»ç»Ÿå•ç‚¹ç™»å½•çš„æµç¨‹ã€‚ å•ç‚¹ç™»å½•ï¼ˆSingle Sign Onï¼‰ï¼Œç®€ç§°ä¸º SSOï¼Œæ˜¯ç›®å‰æ¯”è¾ƒæµè¡Œçš„ä¼ä¸šä¸šåŠ¡æ•´åˆçš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚SSOçš„å®šä¹‰æ˜¯åœ¨å¤šä¸ªåº”ç”¨ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·åªéœ€è¦ç™»å½•ä¸€æ¬¡å°±å¯ä»¥è®¿é—®æ‰€æœ‰ç›¸äº’ä¿¡ä»»çš„åº”ç”¨ç³»ç»Ÿã€‚ æ­¥éª¤ è·å–åŠ å¯†åçš„å¯†ç  è·å–appidï¼Œsocpï¼ŒtokenApiå‚æ•° è·å–tokenï¼Œsoapï¼Œltpaå‚æ•° å®Œæˆè®¤è¯ï¼Œè·å–utï¼Œpid è·å–æ•°æ® æµç¨‹ ç¨‹åºå¼€å§‹ç›´æ¥è¯·æ±‚è¦æŠ“å–çš„æ•°æ®URLï¼ŒæŠ“å–å¤±è´¥è¯´æ˜æœªç™»å½•ï¼Œèµ°ç™»å½•æ–¹æ³•ï¼Œç„¶åé‡æ–°æŠ“å–ã€‚ ç™»å½• def login(): username = \u0026#39;miaoxn3\u0026#39; password = pwd.get() # å¦‚æœæœªè·å–åˆ°å¯†ç ï¼Œä½¿ç”¨é»˜è®¤çš„åŠ å¯†å¯†ç  if not password: password = \u0026#39;090620mxnMXN!\u0026#39; # ç¬¬ä¸€æ­¥ è·å–åŠ å¯†å¯†ç  try: url0 = \u0026#34;http://sso.portal.unicom.local/eip_sso/rest/authentication/login\u0026#34; payload0 = \u0026#39;success=http%3A//service.aiportal.unicom.local/ssoclient/ssologin%3Faction%3Dlogin\u0026amp;error=http%\u0026#39; \\ \u0026#39;3A//sso.portal.unicom.local/eip_sso/aiportalLogin.html\u0026amp;return=http%3A//sso.portal.unicom.local/\u0026#39; \\ \u0026#39;eip_sso/aiportalLogin.html\u0026amp;appid=na186\u0026amp;login=miaoxn3\u0026amp;password={}\u0026#39;.format(password) headers0 = { \u0026#39;Host\u0026#39;: \u0026#39;sso.portal.unicom.local\u0026#39;, \u0026#39;Connection\u0026#39;: \u0026#39;keep-alive\u0026#39;, \u0026#39;Origin\u0026#39;: \u0026#39;http://sso.portal.unicom.local\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39; } response = session.post(url=url0, headers=headers0, data=payload0) password = re_search(r\u0026#39;id=\u0026#34;password\u0026#34; value=\u0026#34;(.*?)\u0026#34;/\u0026gt;\u0026#39;, response.text).group(1) except Exception as e: set_message(msg=\u0026#39;ç™»é™†å¤±è´¥\u0026#39;) return False print(password) # ç¬¬äºŒæ­¥ è·å–appidï¼Œsocpï¼ŒtokenApiå‚æ•° try: url1 = \u0026#34;http://uac.sso.chinaunicom.cn:8282/uac-sso/login\u0026#34; payload1 = \u0026#39;fromAppID=20F9390D5D40ED95E552109364458DC1\u0026amp;success=http%3A//service.aiportal.unicom.local/ssoclient/ssologin\u0026#39; \\ \u0026#39;%3Faction%3Dlogin\u0026amp;error=http%3A//sso.portal.unicom.local/eip_sso/aiportalLogin.html\u0026amp;return=http%3A//\u0026#39; \\ \u0026#39;sso.portal.unicom.local/eip_sso/aiportalLogin.html\u0026amp;eipsuccess=http%3A//sso.portal.unicom.local%3A80/\u0026#39; \\ \u0026#39;eip_sso/rest/authentication/portalLogin\u0026amp;login={}\u0026amp;appid=na186\u0026amp;password={}\u0026#39;.format(username, password) headers1 = { \u0026#39;Host\u0026#39;: \u0026#39;uac.sso.chinaunicom.cn:8282\u0026#39;, \u0026#39;Origin\u0026#39;: \u0026#39;http://sso.portal.unicom.local\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\u0026#39;, \u0026#39;Referer\u0026#39;: \u0026#39;http://sso.portal.unicom.local/eip_sso/rest/authentication/login\u0026#39;, \u0026#39;Cookie\u0026#39;: \u0026#39;UC_SSO_SESSIONID_WEB=0519B25947E84F4D83FF939CFE91457A\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39; } response = session.post(url=url1, headers=headers1, data=payload1) soap = re_search(r\u0026#39;id=\u0026#34;soap\u0026#34; value=\\\u0026#39;(.*?)\\\u0026#39;\u0026gt;\u0026#39;, response.text).group(1) tokenApi = re_search(r\u0026#39;id=\u0026#34;tokenApi\u0026#34; value=\u0026#34;(.*?)\u0026#34;\u0026gt;\u0026#39;, response.text).group(1) except Exception as e: set_message(msg=\u0026#39;ç™»é™†å¤±è´¥\u0026#39;) return False # ç¬¬ä¸‰æ­¥ è·å–tokenï¼Œsoapï¼Œltpaå‚æ•° try: url2 = \u0026#34;http://sso.portal.unicom.local/eip_sso/rest/authentication/portalLogin\u0026#34; payload2 = \u0026#39;appid=na186\u0026amp;error=http%3A//sso.portal.unicom.local/eip_sso/aiportalLogin.html\u0026amp;errorCode=0\u0026amp;\u0026#39; \\ \u0026#39;errorMessage=%u64CD%u4F5C%u6210%u529F\u0026amp;return=http%3A//sso.portal.unicom.local/eip_sso/aiportalLogin.html\u0026amp;\u0026#39; \\ \u0026#39;soap={soap}\u0026amp;tokenApi={tokenApi}\u0026amp;userId=\u0026#39;.format(soap=soap, tokenApi=tokenApi) headers2 = { \u0026#39;Host\u0026#39;: \u0026#39;sso.portal.unicom.local\u0026#39;, \u0026#39;Connection\u0026#39;: \u0026#39;keep-alive\u0026#39;, \u0026#39;Origin\u0026#39;: \u0026#39;http://uac.sso.chinaunicom.cn:8282\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\u0026#39;, \u0026#39;Referer\u0026#39;: \u0026#39;http://uac.sso.chinaunicom.cn:8282/uac-sso/login\u0026#39;, \u0026#39;Cookie\u0026#39;: \u0026#39;JSESSIONID=CC8A69435BD9EF8060E5F43DBEB4B402; lastUid=miaoxn3; miaoxn3=hY2C5VeHiX%2FgFpM9bYQK%2Bg%3D%3D; LtpaToken=tQX78YHEEn1YBvIwIQdNNzNwQ8Sv9jiP4SReDet6rrVTfbwZ/SMsBKSL+VTC0boqM8qSZgnoRfi6veIJIWih+WySFrZAlaLmU58CgKe1WkT+kMos3jFFwr5jrCPPuDY4li2K8HVM9f1OB9mAQoselXjyw2AM3jGEeG+CdKLQh7dU7hmICoRl6OlNGJBxU1UKVwX1TqyevMX9pIwYb1ql+U7RFeVkoJYIH5ClZmezz3fYzNIckiuwlk8HxtjJyTfr3/5GJDfRRRNOgGrF/QjqQeX2LkfVm9x3FzJSSf5B3JSbyUgoOhr0EQ==; aiportalut=\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39;, \u0026#39;Cookie\u0026#39;: \u0026#39;JSESSIONID=59703BB2816D0AE16249AD9ADE0C5F72\u0026#39; } response = session.post(url=url2, headers=headers2, data=payload2) # print(response.text) # token = re_search(r\u0026#39;name=\u0026#34;token\u0026#34; value=\\\u0026#39;(.*?)\\\u0026#39;\u0026gt;\u0026#39;, response.text, re_S).group(1) soap = re_search(r\u0026#39;name=\u0026#34;soap\u0026#34; value=\u0026#34;(.*?)\u0026#34;\u0026gt;\u0026#39;, response.text, re_S).group(1) ltpa = re_search(r\u0026#39;name=\u0026#34;ltpa\u0026#34; value=\\\u0026#39;(.*?)\\\u0026#39;;document\u0026#39;, response.text, re_S).group(1) # print(token) # print(soap) # print(ltpa) except Exception as e: set_message(msg=\u0026#39;ç™»é™†å¤±è´¥\u0026#39;) return False # ç¬¬å››æ­¥ å®Œæˆè®¤è¯ï¼Œè·å–utï¼Œpid try: url3 = \u0026#34;http://service.aiportal.unicom.local/ssoclient/ssologin?action=login\u0026#34; # payload3 = \u0026#39;return=http%3A//sso.portal.unicom.local/eip_sso/aiportalLogin.html\u0026amp;soap={soap}\u0026amp;ltpa={ltpa}\u0026#39;.format(soap=soap, ltpa=ltpa) payload3 = { # \u0026#39;return\u0026#39;: \u0026#39;http://sso.portal.unicom.local/eip_sso/aiportalLogin.html\u0026#39;, \u0026#39;soap\u0026#39;: soap, \u0026#39;ltpa\u0026#39;: ltpa } headers3 = { \u0026#39;Host\u0026#39;: \u0026#39;service.aiportal.unicom.local\u0026#39;, \u0026#39;Origin\u0026#39;: \u0026#39;http://sso.portal.unicom.local\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39; } response = session.post(url=url3, headers=headers3, data=payload3) result = re_findall(r\u0026#39;pid=(.*?)\u0026amp;token=(.*?)\u0026amp;\u0026#39;, response.text, re_S) global pid global ut pid = result[0][0] ut = result[0][1] except Exception as e: # print(\u0026#39;3\u0026#39;, e) set_message(msg=\u0026#39;ç™»é™†å¤±è´¥\u0026#39;) return False else: set_message(msg=\u0026#39;ç™»é™†æˆåŠŸ\u0026#39;) set_message(msg=\u0026#39;pid {}\u0026#39;.format(pid)) set_message(msg=\u0026#39;ut {}\u0026#39;.format(ut)) return True æŠ“å– ut, pidæ˜¯ç™»å½•æˆåŠŸè·å¾—çš„å‚æ•°ï¼ŒæŠ“å–æ—¶å¸¦ä¸Š def get_current_data(): global page url = \u0026#34;http://service.aiportal.unicom.local/taskquery/taskpend/v1/list//0/{page}/10/all/?pendingTitle=\u0026amp;startTime=\u0026amp;endTime=\u0026amp;sort=DESC\u0026#34;.format( page=page) headers = { \u0026#39;Host\u0026#39;: \u0026#39;service.aiportal.unicom.local\u0026#39;, \u0026#39;Origin\u0026#39;: \u0026#39;http://aiportal.unicom.local\u0026#39;, \u0026#39;Referer\u0026#39;: \u0026#39;http://aiportal.unicom.local/modules/readyto/manageIndex.html?pendingState=daiban\u0026amp;type=all\u0026amp;version=20200304\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36\u0026#39;, \u0026#39;ut\u0026#39;: ut, \u0026#39;pid\u0026#39;: pid } try: response = session.get(url=url, headers=headers) data = json_loads(response.text) except: messagebox.showerror(title=\u0026#39;æ— æƒè®¿é—®\u0026#39;, message=\u0026#39;æ— æƒé™æ­£å¸¸è®¿é—®å†…ç½‘ï¼\u0026#39;) else: ... æ•ˆæœå›¾ é¦–é¡µåˆ—è¡¨ è¯¦æƒ…é¡µ æ•°æ®å¯¼å‡º ","permalink":"https://www.chenzqi.cn/posts/2020/20200423_%E4%B8%AD%E5%9B%BD%E8%81%94%E9%80%9A%E5%B7%A5%E5%8D%95%E7%B3%BB%E7%BB%9F%E7%99%BB%E5%BD%95/","tags":["çˆ¬è™«","å·¥å…·"],"title":"ä¸­å›½è”é€šå·¥å•ç³»ç»Ÿç™»å½•"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip PyQt5ä¸­ä½¿ç”¨å¤šçº¿ç¨‹QThreadæ¨¡å— ::: å¤šçº¿ç¨‹æ¨¡å—QThreadåŸºæœ¬åŸç† QThreadæ˜¯Qtçš„çº¿ç¨‹ç±»ä¸­æœ€æ ¸å¿ƒçš„åº•å±‚ç±»ã€‚ç”±äºPyQtçš„çš„è·¨å¹³å°ç‰¹æ€§ï¼ŒQThreadè¦éšè—æ‰€æœ‰ä¸å¹³å°ç›¸å…³çš„ä»£ç  è¦ä½¿ç”¨çš„QThreadå¼€å§‹ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥åˆ›å»ºå®ƒçš„ä¸€ä¸ªå­ç±»ï¼Œç„¶åè¦†ç›–å…¶å®ƒQThread.run()å‡½æ•° class Thread(QThread): def __init__(self): super(Thread,self).__init__() def run(self): æ¥ä¸‹æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ thread = Thread() thread.start() å¯ä»¥çœ‹å‡ºï¼ŒPyQtçš„çº¿ç¨‹ä½¿ç”¨éå¸¸ç®€å•ï¼Œå»ºç«‹ä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»ï¼ˆå¦‚Threadï¼‰ï¼Œè‡ªæˆ‘ç»§æ‰¿è‡ªQThread ï¼Œå¹¶å®ç°å…¶run()æ–¹æ³•å³å¯ã€‚åœ¨ä½¿ç”¨çº¿ç¨‹æ—¶å¯ä»¥ç›´æ¥å¾—åˆ°Threadå®ä¾‹ï¼Œè°ƒç”¨å…¶start()å‡½æ•°å³å¯å¯åŠ¨çº¿ç¨‹ï¼Œçº¿ç¨‹å¯åŠ¨ä¹‹åï¼Œä¼šè‡ªåŠ¨è°ƒç”¨å…¶å®ç°çš„run()çš„å‡½æ•°ï¼Œè¯¥æ–¹æ³•å°±æ˜¯çº¿ç¨‹çš„æ‰§è¡Œå‡½æ•° ã€‚ ä¸šåŠ¡çš„çº¿ç¨‹ä»»åŠ¡å°±å†™åœ¨run()å‡½æ•°ä¸­ï¼Œå½“run()é€€å‡ºä¹‹åçº¿ç¨‹å°±åŸºæœ¬ç»“æŸäº†ï¼ŒQThreadæœ‰startedå’Œfinishedä¿¡å·ï¼Œå¯ä»¥ä¸ºè¿™ä¸¤ä¸ªä¿¡å·æŒ‡å®šæ§½å‡½æ•°ï¼Œåœ¨çº¿ç¨‹å¯åŠ¨å’Œç»“æŸä¹‹æ—¶æ‰§è¡Œä¸€æ®µä»£ç è¿›è¡Œèµ„æºçš„åˆå§‹åŒ–å’Œé‡Šæ”¾æ“ä½œï¼Œæ›´çµæ´»çš„ä½¿ç”¨æ–¹æ³•æ˜¯ï¼Œåœ¨è‡ªå®šä¹‰çš„QThreadå®ä¾‹ä¸­è‡ªå®šä¹‰ä¿¡å·ï¼Œå¹¶å°†ä¿¡å·è¿æ¥åˆ°æŒ‡å®šçš„æ§½å‡½æ•°ï¼Œå½“æ»¡è¶³ä¸€å®šçš„ä¸šåŠ¡æ¡ä»¶æ—¶å‘å°„æ­¤ä¿¡å·ã€‚ QThreadç±»ä¸­çš„å¸¸ç”¨æ–¹æ³• start()ï¼šå¯åŠ¨çº¿ç¨‹ wait()ï¼šé˜»æ­¢çº¿ç¨‹ï¼Œç›´åˆ°æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ä¹‹ä¸€ ä¸æ­¤QThreadå¯¹è±¡å…³è”çš„çº¿ç¨‹å·²å®Œæˆæ‰§è¡Œï¼ˆå³ä»runè¿”å›æ—¶ï¼‰ï¼Œå¦‚æœçº¿ç¨‹å®Œæˆæ‰§è¡Œï¼Œæ­¤å‡½æ•°è¿”å›Trueï¼Œå¦‚æœçº¿ç¨‹å°šæœªå¯åŠ¨ï¼Œä¹Ÿè¿”å›True ç­‰å¾…æ—¶é—´çš„å•ä½æ˜¯æ¯«ç§’ï¼Œå¦‚æœæ—¶é—´æ˜¯ULONG_MAXï¼ˆé»˜è®¤å€¼Â·ï¼‰ï¼Œåˆ™ç­‰å¾…ï¼Œæ°¸è¿œä¸ä¼šè¶…æ—¶(çº¿ç¨‹å¿…é¡»ä»runè¿”å›ï¼‰ï¼Œå¦‚æœç­‰å¾…è¶…æ—¶ï¼Œæ­¤å‡½æ•°å°†ä¼šè¿”å›False sleep()ï¼šå¼ºåˆ¶å½“å‰çº¿ç¨‹ç¡çœ å¤šå°‘ç§’ QThreadç±»ä¸­çš„å¸¸ç”¨ä¿¡å· startedï¼šåœ¨å¼€å§‹æ‰§è¡Œrunå‡½æ•°ä¹‹å‰ï¼Œä»ç›¸å…³çº¿ç¨‹å‘å°„æ­¤ä¿¡å· finishedï¼šå½“ç¨‹åºå®Œæˆä¸šåŠ¡é€»è¾‘æ—¶ï¼Œä»ç›¸å…³çº¿ç¨‹å‘å°„æ­¤ä¿¡å· ä½¿ç”¨QThreadé‡æ–°å®ç°ç¨‹åºè§£å†³é—®é¢˜ # -*- coding: utf-8 -*- import sys import time from PyQt5.QtCore import QThread, pyqtSignal from PyQt5.QtWidgets import QApplication, QMainWindow from QThread_Example_UI import Ui_Form class MyMainForm(QMainWindow, Ui_Form): def __init__(self, parent=None): super(MyMainForm, self).__init__(parent) self.setupUi(self) # å®ä¾‹åŒ–çº¿ç¨‹å¯¹è±¡ self.work = WorkThread() self.runButton.clicked.connect(self.execute) def execute(self): # å¯åŠ¨çº¿ç¨‹ self.work.start() # çº¿ç¨‹è‡ªå®šä¹‰ä¿¡å·è¿æ¥çš„æ§½å‡½æ•° self.work.trigger.connect(self.display) def display(self,str): # ç”±äºè‡ªå®šä¹‰ä¿¡å·æ—¶è‡ªåŠ¨ä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªæ§½å‡½æ•°ä¸­è¦æ¥å—ä¸€ä¸ªå‚æ•° self.listWidget.addItem(str) class WorkThread(QThread): # è‡ªå®šä¹‰ä¿¡å·å¯¹è±¡ã€‚å‚æ•°strå°±ä»£è¡¨è¿™ä¸ªä¿¡å·å¯ä»¥ä¼ ä¸€ä¸ªå­—ç¬¦ä¸² trigger = pyqtSignal(str) def __int__(self): # åˆå§‹åŒ–å‡½æ•° super(WorkThread, self).__init__() def run(self): #é‡å†™çº¿ç¨‹æ‰§è¡Œçš„runå‡½æ•° #è§¦å‘è‡ªå®šä¹‰ä¿¡å· for i in range(20): time.sleep(1) # é€šè¿‡è‡ªå®šä¹‰ä¿¡å·æŠŠå¾…æ˜¾ç¤ºçš„å­—ç¬¦ä¸²ä¼ é€’ç»™æ§½å‡½æ•° self.trigger.emit(str(i)) if __name__ == \u0026#34;__main__\u0026#34;: app = QApplication(sys.argv) myWin = MyMainForm() myWin.show() sys.exit(app.exec_()) å°ç»“ å¦‚æœå®ç°çš„å·¥å…·éœ€è¦æ‰§è¡Œç‰¹åˆ«è€—æ—¶çš„æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨æœ¬æ–‡å¤šçº¿ç¨‹QThreadå¤„ç†æ–¹æ³•å®ç°ã€‚å½“ç„¶ï¼Œå·¥å…·å®é™…å®ç°è¿‡ç¨‹ä¸­çš„åœºæ™¯ä¼šæ¯”è¿™å¤æ‚ã€‚æ¯”å¦‚ï¼Œä½ çš„è¾“å‡ºå¹¶ä¸æ˜¯æœ‰å›ºå®šæ—¶é—´é—´éš”è¾“å‡ºçš„æ–‡æœ¬æ¡†ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨å¤šæ¬¡self.trigger.emit(str)æ–¹æ³•è¿›è¡Œæ“ä½œã€‚ ","permalink":"https://www.chenzqi.cn/posts/2020/20200420_pyqt5%E4%B8%AD%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9D%97qthread%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/","tags":["å·¥å…·"],"title":"PyQt5å¤šçº¿ç¨‹æ¨¡å—QThreadä½¿ç”¨"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip TBç½‘é¡µç™»å½•æµç¨‹è§£æï¼Œä½¿ç”¨Pythonä»£ç å®ç°ç™»å½•åä¿å­˜Cookieä¿¡æ¯ ::: ä¸€ã€æ·˜å®ç™»å½•æµç¨‹ æ·˜å®uaå‚æ•°ï¼šua(User-Agent)æ•…åç”¨æˆ·ä»£ç†ï¼Œæ·˜å®çš„uaå‚æ•°åŠ å…¥äº†æµè§ˆå™¨ã€ipã€ç”µè„‘ã€æ—¶é—´ç­‰ä¿¡æ¯ï¼Œç„¶ååŠ å¯†ç”Ÿæˆï¼Œåœ¨å¾ˆå¤šåœ°æ–¹ä½¿ç”¨ï¼Œä¸ä»…ä»…æ˜¯ç™»å½• ä»ä»£ç å±‚é¢è€ƒè™‘å°†æ¨¡æ‹Ÿç™»å½•æ·˜å®åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š è¾“å…¥ç”¨æˆ·ååï¼Œæµè§ˆå™¨ä¼šå‘æ·˜å®ï¼ˆtaobao.comï¼‰å‘èµ·ä¸€ä¸ªpostçš„è¯·æ±‚ï¼Œåˆ¤æ–­æ˜¯å¦å‡ºç°æ»‘å—éªŒè¯ï¼ ç”¨æˆ·è¾“å…¥å¯†ç åï¼Œæµè§ˆå™¨å‘æ·˜å®ï¼ˆtaobao.comï¼‰åˆå‘èµ·ä¸€ä¸ªpostè¯·æ±‚ï¼ŒéªŒè¯ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®åˆ™è¿”å›ä¸€ä¸ªtokenã€‚ æµè§ˆå™¨æ‹¿ç€tokenå»é˜¿é‡Œå·´å·´ï¼ˆalibaba.comï¼‰äº¤æ¢stç ï¼ æµè§ˆå™¨è·å–stç ä¹‹åï¼Œæ‹¿ç€stç è·å–cookiesï¼Œç™»å½•æˆåŠŸ äºŒã€æ¨¡æ‹Ÿç™»å½•å®ç° 1.åˆ¤æ–­æ˜¯å¦éœ€è¦æ»‘å— ä¸¾ä¸ªä¾‹å­ï¼šæŸå°è®¾å¤‡å¯èƒ½å‡ºç°ç™»å½•è¿‡å¤§é‡çš„è´¦å·ï¼Œè¿™æ—¶å€™æ·˜å®å°±å¯ä»¥ä»uaå‚æ•°ä¸­è·å–è®¾å¤‡å·ï¼Œç„¶åå¯¹è¯¥è®¾å¤‡è¿›è¡Œé™åˆ¶ï¼ 2.éªŒè¯ç”¨æˆ·åå¯†ç  è¿™é‡Œä¸€æ­¥ä¹Ÿå°±æ˜¯ä¸Šé¢æ—¶åºå›¾å›¾ä¸­çš„ç¬¬5æ­¥ï¼šè¯·æ±‚ç™»å½•ï¼Œè¿™é‡Œä¼šå°†ç”¨æˆ·åã€uaå‚æ•°ã€åŠ å¯†å¯†ç ç­‰å‚æ•°poståˆ°æ·˜å®ï¼ˆtaobao.comï¼‰å»éªŒè¯ã€‚ éªŒè¯è´¦å·å¯†ç è·å–stç ç”³è¯·åœ°å€ ç»“æœ å¯ä»¥çœ‹åˆ°ç”³è¯·stç é“¾æ¥åé¢å¸¦äº†ä¸€ä¸ªtoken 3.ç”³è¯·stç  ç”³è¯·åˆ°äº†æ·˜å®ï¼ˆtaobao.comï¼‰çš„tokenï¼Œè¿™ä¸€æ­¥å°±æ˜¯ç”¨tokenæ¥æ¢å–stç  ä¸ºä»€ä¹ˆæ·˜å®ç™»å½•éœ€è¦è¿™ä¹ˆéº»çƒ¦å‘¢ï¼Ÿç›´æ¥åœ¨ taobao.com ç™»å½•ä¸å°±å¯ä»¥å—ï¼Ÿä¸ºä»€ä¹ˆè¦å…ˆåœ¨taobaoéªŒè¯ç”¨æˆ·åå¯†ç ï¼Œé€šè¿‡ä¹‹åå†å» alibaba.com æ¢å–stç ç™»å½•å‘¢ï¼Ÿ ä»»ä½•å…¬å¸çš„æ¡†æ¶éƒ½æ˜¯æ…¢æ…¢æ¼”å˜çš„ç»“æœï¼Œæˆ‘æƒ³æœ€å¼€å§‹çš„æ·˜å®ç™»å½•è‚¯å®šæ²¡è¿™ä¹ˆå¤æ‚ã€‚ä½†æ˜¯éšç€é˜¿é‡Œå·´å·´çš„æ…¢æ…¢å£®å¤§ï¼Œå¾ˆå¤šäº‹ä¸šçº¿éƒ½åˆ’åˆ†å¼€æ¥ï¼Œä½†æ˜¯è¿™äº›äº‹ä¸šçº¿ä¹‹é—´åˆæœ‰å…³è”æ€§ï¼Œæ¯”å¦‚ç”¨æˆ·ç™»å½•äº†æ·˜å®è´¦å·ä¹‹åå¤©çŒ«å°±ä¸éœ€è¦å†ç™»å½•äº†å‘¢ï¼Ÿï¼ˆæ³¨æ„æ·˜å®å’Œå¤©çŒ«çš„é¡¶çº§åŸŸåä¸åŒï¼Œæ‰€ä»¥ä¸èƒ½å…±äº«cookisï¼‰ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå•ç‚¹ç™»å½•å°±å‡ºç°äº†ã€‚ å•ç‚¹ç™»å½•ï¼ˆSingle Sign Onï¼‰ï¼Œç®€ç§°ä¸º SSOï¼Œæ˜¯ç›®å‰æ¯”è¾ƒæµè¡Œçš„ä¼ä¸šä¸šåŠ¡æ•´åˆçš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚SSOçš„å®šä¹‰æ˜¯åœ¨å¤šä¸ªåº”ç”¨ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·åªéœ€è¦ç™»å½•ä¸€æ¬¡å°±å¯ä»¥è®¿é—®æ‰€æœ‰ç›¸äº’ä¿¡ä»»çš„åº”ç”¨ç³»ç»Ÿã€‚ â€”â€”ç™¾åº¦ç™¾ç§‘ ç”¨æˆ·æ•°æ®åœ¨æ·˜å®è¿™é‡Œï¼Œæ‰€ä»¥éœ€è¦ç°åœ¨æ·˜å®ï¼ˆtaobao.comï¼‰éªŒè¯ç”¨æˆ·åå’Œå¯†ç ï¼ŒéªŒè¯é€šè¿‡ç”Ÿæˆä¸€ä¸ªtokenï¼Œæµè§ˆå™¨æ‹¿ç€tokenå»å’Œé˜¿é‡Œå·´å·´ï¼ˆalibaba.comï¼‰ç”³è¯·å•ç‚¹ç™»å½•ç ï¼ˆstç ï¼‰ï¼Œé˜¿é‡Œå·´å·´æ”¶åˆ°è¯·æ±‚éªŒè¯tokené€šè¿‡åˆ™è¿”å›stç ï¼Œæ‰€ä»¥ç”¨tokenæ¢stç çš„åŸå› å°±åœ¨äºå•ç‚¹ç™»å½•ï¼ 4.ä½¿ç”¨stç ç™»å½• æˆåŠŸè·å–stç ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ¥ç™»å½•äº†ï¼Œè¿™ä¸€æ­¥æ˜¯é€šè¿‡stç è·å–ç™»å½•çš„cookieså¹¶ä¿å­˜ ä¸‰ ã€éªŒè¯cookie æ¯æ¬¡è¿è¡ŒåŠ è½½æœ¬åœ°cookiesæ–‡ä»¶ï¼Œåˆ¤æ–­æ˜¯å¦è¿‡æœŸã€‚ ","permalink":"https://www.chenzqi.cn/posts/2020/20200415_python-%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95%E6%B7%98%E5%AE%9D%E4%B8%8Ecookies%E5%BA%8F%E5%88%97%E5%8C%96/","tags":["çˆ¬è™«"],"title":"æ¨¡æ‹Ÿç™»å½•TBä¸Cookiesåºåˆ—åŒ–"},{"categories":[2020,"æŠ€æœ¯"],"contents":"scrapy-splashçš„ä»‹ç» Scrapyæ²¡æœ‰JS engine, æ— æ³•çˆ¬å–JavaScriptç”Ÿæˆçš„åŠ¨æ€ç½‘é¡µï¼Œåªèƒ½çˆ¬å–é™æ€ç½‘é¡µï¼Œè€Œåœ¨ç°ä»£çš„ç½‘ç»œä¸–ç•Œä¸­ï¼Œå¤§éƒ¨åˆ†ç½‘é¡µéƒ½ä¼šé‡‡ç”¨JavaScriptæ¥ä¸°å¯Œç½‘é¡µçš„åŠŸèƒ½ã€‚ scrapy-splashæ¨¡å—ä¸»è¦ä½¿ç”¨äº†Splash. æ‰€è°“çš„Splash, å°±æ˜¯ä¸€ä¸ªJavascriptæ¸²æŸ“æœåŠ¡ã€‚å®ƒæ˜¯ä¸€ä¸ªå®ç°äº†HTTP APIçš„è½»é‡çº§æµè§ˆå™¨ï¼ŒSplashæ˜¯ç”¨Pythonå®ç°çš„ï¼ŒåŒæ—¶ä½¿ç”¨Twistedå’ŒQTã€‚Twistedï¼ˆQTï¼‰ç”¨æ¥è®©æœåŠ¡å…·æœ‰å¼‚æ­¥å¤„ç†èƒ½åŠ›ï¼Œä»¥å‘æŒ¥webkitçš„å¹¶å‘èƒ½åŠ›ã€‚Splashçš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š å¹¶è¡Œå¤„ç†å¤šä¸ªç½‘é¡µ å¾—åˆ°HTMLç»“æœä»¥åŠï¼ˆæˆ–è€…ï¼‰æ¸²æŸ“æˆå›¾ç‰‡ å…³æ‰åŠ è½½å›¾ç‰‡æˆ–ä½¿ç”¨ Adblock Plusè§„åˆ™ä½¿å¾—æ¸²æŸ“é€Ÿåº¦æ›´å¿« ä½¿ç”¨JavaScriptå¤„ç†ç½‘é¡µå†…å®¹ ä½¿ç”¨Luaè„šæœ¬ èƒ½åœ¨Splash-Jupyter Notebooksä¸­å¼€å‘Splash Lua scripts èƒ½å¤Ÿè·å¾—å…·ä½“çš„HARæ ¼å¼çš„æ¸²æŸ“ä¿¡æ¯ scrapy-splashçš„å®‰è£… å®‰è£…scrapy-splashæ¨¡å— pip3 install scrapy-splash scrapy-splashä½¿ç”¨çš„æ˜¯Splash HTTP APIï¼Œ æ‰€ä»¥éœ€è¦ä¸€ä¸ªsplash instanceï¼Œä¸€èˆ¬é‡‡ç”¨dockerè¿è¡Œsplashï¼Œæ‰€ä»¥éœ€è¦å®‰è£…dockerã€‚ CentOS7 sudo yum install docker å¼€å¯dockeræœåŠ¡ï¼Œæ‹‰å–splashé•œåƒï¼ˆpull the imageï¼‰ sudo service docker start\rsudo docker pull scrapinghub/splash å¼€å¯å®¹å™¨ï¼ˆstart the containerï¼‰ sudo docker run -p 8050:8050 scrapinghub/splash æ­¤æ—¶Splashä»¥è¿è¡Œåœ¨æœ¬åœ°æœåŠ¡å™¨çš„ç«¯å£8050(http)ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥\u0026rsquo;IP:8050' scrapy-splashçš„å®ä¾‹ ä¸€ä¸ªç®€å•çš„å®ä¾‹ï¼Œåˆ©ç”¨ç™¾åº¦æŸ¥è¯¢æ‰‹æœºå·ç ä¿¡æ¯ã€‚æ¯”å¦‚ï¼Œåœ¨ç™¾åº¦è¾“å…¥æ¡†ä¸­è¾“å…¥æ‰‹æœºå·ç â€˜159â€™ï¼Œç„¶åæŸ¥è¯¢ï¼Œå¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ åˆ©ç”¨scrapy-splashæ¨¡æ‹Ÿä»¥ä¸Šæ“ä½œå¹¶è·å–æ‰‹æœºå·ç ä¿¡æ¯ åˆ›å»ºscrapyé¡¹ç›®phone é…ç½®settings.pyæ–‡ä»¶ï¼Œé…ç½®çš„å†…å®¹å¦‚ä¸‹ ROBOTSTXT_OBEY = False SPIDER_MIDDLEWARES = { \u0026#39;scrapy_splash.SplashDeduplicateArgsMiddleware\u0026#39;: 100, } DOWNLOADER_MIDDLEWARES = { \u0026#39;scrapy_splash.SplashCookiesMiddleware\u0026#39;: 723, \u0026#39;scrapy_splash.SplashMiddleware\u0026#39;: 725, \u0026#39;scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware\u0026#39;: 810 } SPLASH_URL = \u0026#39;http://localhost:8050\u0026#39; DUPEFILTER_CLASS = \u0026#39;scrapy_splash.SplashAwareDupeFilter\u0026#39; HTTPCACHE_STORAGE = \u0026#39;scrapy_splash.SplashAwareFSCacheStorage\u0026#39; å…·ä½“çš„é…ç½®è¯´æ˜å¯ä»¥å‚è€ƒ: scrapy-splash åˆ›å»ºçˆ¬è™«æ–‡ä»¶phoneSpider.py, ä»£ç å¦‚ä¸‹ # -*- coding: utf-8 -*- from scrapy import Spider, Request from scrapy_splash import SplashRequest # splash lua script script = \u0026#34;\u0026#34;\u0026#34; function main(splash, args) assert(splash:go(args.url)) assert(splash:wait(args.wait)) js = string.format(\u0026#34;document.querySelector(\u0026#39;#kw\u0026#39;).value=%s;document.querySelector(\u0026#39;#su\u0026#39;).click()\u0026#34;, args.phone) splash:evaljs(js) assert(splash:wait(args.wait)) return splash:html() end \u0026#34;\u0026#34;\u0026#34; class phoneSpider(Spider): name = \u0026#39;phone\u0026#39; allowed_domains = [\u0026#39;www.baidu.com\u0026#39;] url = \u0026#39;https://www.baidu.com\u0026#39; # start request def start_requests(self): yield SplashRequest(self.url, callback=self.parse, endpoint=\u0026#39;execute\u0026#39;, args={\u0026#39;lua_source\u0026#39;: script, \u0026#39;phone\u0026#39;:\u0026#39;159*******\u0026#39;, \u0026#39;wait\u0026#39;: 5}) # parse the html content def parse(self, response): info = response.css(\u0026#39;div.op_mobilephone_r.c-gap-bottom-small\u0026#39;).xpath(\u0026#39;span/text()\u0026#39;).extract() print(\u0026#39;=\u0026#39;*40) print(\u0026#39;\u0026#39;.join(info)) print(\u0026#39;=\u0026#39;*40) è¿è¡Œçˆ¬è™«: scrapy crawl phone ","permalink":"https://www.chenzqi.cn/posts/2020/20200409_scrapy-splash%E7%9A%84%E4%BD%BF%E7%94%A8/","tags":["çˆ¬è™«","æ¡†æ¶","scrapy"],"title":"Scrapy-Splashçš„ä½¿ç”¨"},{"categories":[2020,"æŠ€æœ¯"],"contents":"Tornadoç®€ä»‹ Tornado-åŸºäºPythonçš„webæœåŠ¡ç«¯æ¡†æ¶ï¼Œ ä¸ç°æœ‰ä¸»æµçš„webæœåŠ¡ç«¯ï¼ˆä»¥åŠå¤§å¤šæ•°Pythonæ¡†æ¶ï¼‰æœ‰ç€æ˜æ˜¾çš„åŒºåˆ«ï¼š æ˜¯éé˜»å¡å¼ï¼Œé€Ÿåº¦ç›¸å½“å¿«ã€‚å¾—åˆ©äºå…¶éé˜»å¡å¼çš„æ–¹å¼ï¼ŒTornadoæ¯ç§’å¯ä»¥å¤„ç†æ•°ä»¥åƒè®¡çš„è¿æ¥ï¼Œå› æ­¤æ˜¯å®æ—¶webæœåŠ¡çš„ä¸€ä¸ªç†æƒ³æ¡†æ¶ã€‚ Tornadoå®‰è£… pip install tornado Tornado webç¨‹åºæµç¨‹ åˆ›å»ºwebåº”ç”¨å®ä¾‹å¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªåˆå§‹åŒ–å‚æ•°ä¸ºè·¯ç”±æ˜ å°„åˆ—è¡¨ å®šä¹‰å®ç°è·¯ç”±æ˜ å°„åˆ—è¡¨çš„handlerç±» åˆ›å»ºå®ä¾‹ï¼Œç›‘å¬æœåŠ¡å™¨ç«¯å£ å¯åŠ¨ã€‚æ‰§è¡ŒIOLoopç±»çš„start()æ–¹æ³• å¤„ç†HTTPè¯·æ±‚ RequestHandler.get(args,kwargs) #å¤„ç†getè¯·æ±‚\rRequestHandler.post(*args, kwargs) #å¤„ç†postè¯·æ±‚\rRequestHandler.put(args, kwargs) #å¤„ç†putè¯·æ±‚\rRequestHandler.delete(*args, kwargs) #å¤„ç†deleteè¯·æ±‚ Hello world import tornado.ioloop import tornado.web # å®šä¹‰å®ç°è·¯ç”±æ˜ å°„åˆ—è¡¨çš„handlerç±» class MainHandler(tornado.web.RequestHandler): def get(self): self.write(\u0026#34;Hello world\u0026#34;) class Application(tornado.web.Application): def __init__(self): handlers = [ (r\u0026#39;/\u0026#39;, MainHandler), ] # åˆ›å»ºwebåº”ç”¨å®ä¾‹å¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªåˆå§‹åŒ–å‚æ•°ä¸ºè·¯ç”±æ˜ å°„åˆ—è¡¨ tornado.web.Application.__init__(self, handlers) if __name__==\u0026#34;__main__\u0026#34;: app = Application() # åˆ›å»ºå®ä¾‹ï¼Œç›‘å¬æœåŠ¡å™¨ç«¯å£ app.listen(8000) print(\u0026#34;Tornado Started in port 8000ï¼Œhttp://127.0.0.1:8000\u0026#34;) # å¯åŠ¨ã€‚æ‰§è¡ŒIOLoopç±»çš„start()æ–¹æ³• tornado.ioloop.IOLoop.current().start() Hello worldåˆ›å»ºäº†ä¸€ä¸ªsocketæœåŠ¡å¹¶ç›‘å¬8000ç«¯å£ï¼Œå½“æ¥æ”¶åˆ°è¯·æ±‚æ—¶æ ¹æ®è·¯ç”±è§„åˆ™æ¥æ‰¾åˆ°ç›¸åº”çš„ç±»å¤„ç†è¯¥è¯·æ±‚ï¼Œå¹¶æ ¹æ®è¯·æ±‚æ–¹å¼æŒ‡å®šç›¸åº”ç±»ä¸­çš„æŒ‡å®šæ–¹æ³•å¤„ç†ã€‚ æ‰€ä»¥å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨é”®å…¥127.0.0.1:8000ï¼ŒæœåŠ¡ç«¯ä¼šç»™æµè§ˆå™¨è¿”å›Hello worldã€‚ ","permalink":"https://www.chenzqi.cn/posts/2020/20200405_%E5%9F%BA%E4%BA%8Epython%E7%9A%84tornado%E6%A1%86%E6%9E%B6%E5%85%A5%E9%97%A8/","tags":["æ¡†æ¶"],"title":"åŸºäºPythonçš„Tornadoæ¡†æ¶å…¥é—¨è®°å½•"},{"categories":[2020,"æŠ€æœ¯"],"contents":"Homebrewæ˜¯ä¸€æ¬¾Mac OSå¹³å°ä¸‹çš„è½¯ä»¶åŒ…ç®¡ç†å·¥å…·ï¼Œæ‹¥æœ‰å®‰è£…ã€å¸è½½ã€æ›´æ–°ã€æŸ¥çœ‹ã€æœç´¢ç­‰å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½ é—®é¢˜ï¼š macOSå®‰è£…Homebrewæ—¶æ€»æ˜¯æŠ¥é”™ï¼ˆFailed to connect to raw.githubusercontent.com port 443: Connection refusedï¼‰ åŸå› ï¼š GitHubçš„raw.githubusercontent.comåŸŸåè§£æè¢«æ±¡æŸ“äº†ã€‚ è§£å†³ï¼š é€šè¿‡ä¿®æ”¹hostsè§£å†³æ­¤é—®é¢˜ã€‚ è§£å†³ åœ¨ www.ipaddress.com æŸ¥è¯¢ raw.githubusercontent.com çš„çœŸå®IPã€‚ ä¿®æ”¹hosts: sudo vim /etc/hosts æ·»åŠ å¦‚ä¸‹å†…å®¹: 199.232.28.133 raw.githubusercontent.com hosts æƒé™ æ–¹æ³•1 æ‰“å¼€Finderï¼ŒæŒ‰å¿«æ·é”®ç»„åˆ Shift+Command+G æŸ¥æ‰¾æ–‡ä»¶ï¼Œè¾“å…¥/etc/hosts,ç¡®è®¤å‰å¾€ è¿›å…¥æ–‡ä»¶å¤¹åï¼Œå¤åˆ¶è¯¥æ–‡ä»¶åˆ°æ¡Œé¢ï¼Œä¿®æ”¹æˆåŠŸåä¿å­˜ï¼Œå°†åŸå…ˆçš„hostæ–‡ä»¶æ›¿æ¢æ‰å³å¯ æ–¹æ³•2 æ‰“å¼€Finderï¼ŒæŒ‰å¿«æ·é”®ç»„åˆ Shift+Command+G æŸ¥æ‰¾æ–‡ä»¶ï¼Œè¾“å…¥/private,ç¡®è®¤å‰å¾€åå¯çœ‹åˆ° etc æ–‡ä»¶å¤¹ï¼Œé‚®ä»¶é€‰æ‹©\u0026rsquo;æ˜¾ç¤ºç®€ä»‹\u0026rsquo;ï¼Œåœ¨åº•éƒ¨æ‰“å¼€â€˜å…±äº«å’Œæƒé™â€™ å°†everyoneçš„æƒé™æ”¹ä¸ºâ€˜è¯»ä¸å†™â€™ï¼Œä¿å­˜åç›´æ¥ä¿®æ”¹hostsæ–‡ä»¶ï¼Œæœ€åå®Œæˆåå°†æƒé™æ”¹å›æ¥ ","permalink":"https://www.chenzqi.cn/posts/2020/20200401_macos%E5%AE%89%E8%A3%85homebrew%E9%97%AE%E9%A2%98/","tags":["é—®é¢˜","è®°å½•"],"title":"macOSå®‰è£…Homebrewé—®é¢˜"},{"categories":[2020,"æŠ€æœ¯"],"contents":":::tip ä½¿ç”¨Dockerfileéƒ¨ç½²é¡¹ç›®,dockerå®‰è£…ä¸åŒè½¯ä»¶ ::: éƒ¨ç½²javaé¡¹ç›® åˆ›å»ºDockerfile # åŸºç¡€é•œåƒæ˜¯dockerä»“åº“çš„java:8ï¼ˆä¹Ÿå°±æ˜¯jdk8çš„æ„æ€ï¼‰\rFROM java:8\r# ä½œè€…ç­¾å\rMAINTAINER xiaoxiang\r# ç®€åŒ– jar çš„åå­—è·¯å¾„ ï¼ˆå·¦è¾¹æ˜¯æœåŠ¡å™¨ä¸­jaråŒ…çš„è·¯å¾„ï¼Œå› ä¸ºå½“å‰æ–‡ä»¶æ˜¯å’ŒjaråŒ…åŒçº§ï¼Œæ‰€ä»¥ç›´æ¥å†™åå­—å³å¯ï¼Œå³è¾¹æ˜¯é•œåƒä¸­è¦å­˜æ”¾jaråŒ…çš„è·¯å¾„ï¼‰\rCOPY test.jar /test.jar\r# è®¾ç½®æ—¶é—´\rRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \u0026amp;\u0026amp; echo \u0026#39;Asia/Shanghai\u0026#39; \u0026gt;/etc/timezone\r# æ‰§è¡Œ java -jar å‘½ä»¤ ï¼ˆCMDï¼šåœ¨å¯åŠ¨å®¹å™¨æ—¶æ‰æ‰§è¡Œæ­¤è¡Œã€‚RUNï¼šæ„å»ºé•œåƒæ—¶å°±æ­¤è¡Œï¼Œåé¢çš„jaråŒ…è·¯å¾„å°±æ˜¯ä¸Šé¢è¦è®¾ç½®çš„jaråŒ…è·¯å¾„ï¼‰\rCMD java -jar /test.jar\r# è®¾ç½®å¯¹å¤–ç«¯å£ä¸º 8080\rEXPOSE 8080 åˆ›å»ºé•œåƒ # åé¢æœ‰ä¸ªç‚¹ï¼ŒæŒ‡å®šè·¯å¾„ä¸ºå½“å‰è·¯å¾„çš„Dockerfileæ–‡ä»¶ docker build -t test . è¿è¡ŒjaråŒ… -dä»£è¡¨åå°è¿è¡Œ -p 8082:8082 ç«¯å£æ˜ å°„ï¼Œåä¸€ä¸ª8082æ˜¯é•œåƒçš„ç«¯å£ -v ä»£è¡¨æŒ‚è½½ä¸€ä¸ªå®¿ä¸»æœºç›®å½•åˆ°å®¹å™¨ç›®å½•ä¸­ï¼Œç¬¬ä¸€ä¸ªæ˜¯å®¿ä¸»æœºç›®å½•ï¼Œç¬¬äºŒä¸ªæ˜¯å®¹å™¨ç›®å½• ç¬¬ä¸€ä¸ªtest/javaä»£è¡¨æ˜¯ç»™å®¹å™¨çš„åå­— ç¬¬äºŒä¸ªtestæ˜¯ä¸Šé¢åˆ›å»ºé•œåƒçš„åå­— docker run -d -p 8080:8080 -v /opt/java:/opt/java --name test/java test æŸ¥çœ‹å®¹å™¨ docker ps -a è½¯ä»¶å®‰è£… å®‰è£…Mysql mkdir -p /opt/data/mysql/data mkdir -p /opt/data/mysql/conf.d docker run -di -p 3307:3306 -v /opt/data/mysql/conf.d:/etc/mysql/conf.d -v /opt/data/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=å¯†ç  --name mysql mysql å®‰è£…Redis mkdir -p /opt/data/redis/data mkdir -p /opt/data/redis/conf vim /opt/data/redis/conf/redis.conf docker run -d -p 6379:6379 --name redis -v /opt/data/redis/redis.conf:/etc/redis/redis.conf -v /opt/data/redis/data:/data redis redis-server /etc/redis/redis.conf --requirepass \u0026#34;å¯†ç \u0026#34; --appendonly yes redis.conf protected-mode yes\rport 6379\rtcp-backlog 511\rtimeout 0\rdaemonize yes\rsupervised no\rpidfile /var/run/redis_6379.pid\rloglevel notice\rlogfile /var/log/redis/redis.log\rdatabases 16\rsave 900 1\rsave 300 10\rsave 60 10000\rstop-writes-on-bgsave-error yes\rrdbcompression yes\rrdbchecksum yes\rdbfilename dump.rdb\rdir /var/lib/redis\rslave-serve-stale-data yes\rslave-read-only yes\rrepl-diskless-sync no\rrepl-diskless-sync-delay 5\rrepl-disable-tcp-nodelay no\rslave-priority 100\rrequirepass å¯†ç \rappendonly no\rappendfilename \u0026#34;appendonly.aof\u0026#34;\rappendfsync everysec\rno-appendfsync-on-rewrite no\rauto-aof-rewrite-percentage 100\rauto-aof-rewrite-min-size 64mb\raof-load-truncated yes\rlua-time-limit 5000\rslowlog-log-slower-than 10000\rslowlog-max-len 128\rlatency-monitor-threshold 0\rnotify-keyspace-events \u0026#34;\u0026#34;\rhash-max-ziplist-entries 512\rhash-max-ziplist-value 64\rlist-max-ziplist-size -2\rlist-compress-depth 0\rset-max-intset-entries 512\rzset-max-ziplist-entries 128\rzset-max-ziplist-value 64\rhll-sparse-max-bytes 3000\ractiverehashing yes\rclient-output-buffer-limit normal 0 0 0\rclient-output-buffer-limit slave 256mb 64mb 60\rclient-output-buffer-limit pubsub 32mb 8mb 60\rhz 10\raof-rewrite-incremental-fsync yes å®‰è£…nginx mkdir -p /opt/data/nginx/{conf,html,logs} vim /usr/nginx/conf/nginx.conf docker run --name nginx -d -p 80:80 -p 443:443 -v /opt/data/nginx/html:/usr/share/nginx/html:ro -v /opt/data/nginx/conf/nginx.conf:/etc/nginx/nginx.conf:ro -v /opt/data/nginx/conf.d:/etc/nginx/conf.d:ro -v /opt/data/nginx/logs:/var/log/nginx nginx nginx.conf user nginx;\rworker_processes auto;\rerror_log /var/log/nginx/error.log;\rpid /run/nginx.pid;\rinclude /usr/share/nginx/modules/*.conf;\revents {\rworker_connections 1024;\r}\rhttp {\rlog_format main \u0026#39;$remote_addr - $remote_user [$time_local] \u0026#34;$request\u0026#34; \u0026#39;\r\u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39;\r\u0026#39;\u0026#34;$http_user_agent\u0026#34; \u0026#34;$http_x_forwarded_for\u0026#34;\u0026#39;;\raccess_log /var/log/nginx/access.log main;\rsendfile on;\rtcp_nopush on;\rtcp_nodelay on;\rkeepalive_timeout 65;\rtypes_hash_max_size 2048;\rinclude /etc/nginx/mime.types;\rdefault_type application/octet-stream;\rserver {\rlisten 80 default_server;\rlisten [::]:80 default_server;\rserver_name _;\rroot /usr/share/nginx/html;\rinclude /etc/nginx/default.d/*.conf;\rlocation / {\r}\rerror_page 404 /404.html;\rlocation = /40x.html {\r}\rerror_page 500 502 503 504 /50x.html;\rlocation = /50x.html {\r}\r}\r# Settings for a TLS enabled server.\r#\r# server {\r# listen 443 ssl http2 default_server;\r# listen [::]:443 ssl http2 default_server;\r# server_name _;\r# root /usr/share/nginx/html;\r#\r# ssl_certificate \u0026#34;/etc/pki/nginx/server.crt\u0026#34;;\r# ssl_certificate_key \u0026#34;/etc/pki/nginx/private/server.key\u0026#34;;\r# ssl_session_cache shared:SSL:1m;\r# ssl_session_timeout 10m;\r# ssl_ciphers HIGH:!aNULL:!MD5;\r# ssl_prefer_server_ciphers on;\r#\r# # Load configuration files for the default server block.\r# include /etc/nginx/default.d/*.conf;\r#\r# location / {\r# }\r#\r# error_page 404 /404.html;\r# location = /40x.html {\r# }\r#\r# error_page 500 502 503 504 /50x.html;\r# location = /50x.html {\r# }\r# }\r} å®‰è£…nacos ä½¿ç”¨æŒ‚è½½æ–‡ä»¶çš„æ–¹å¼ mkdir -p /opt/nacos/logs mkdir -p /opt/nacos/conf touch /opt/nacos/conf/application.properties docker run -d --name nacos \\ -v /opt/nacos/conf/application.properties:/home/nacos/conf/application.properties \\ -v /opt/nacos/conf/logs:/home/nacos/conf/logs \\ -p 8848:8848 nacos/nacos-server application.properties server.servlet.contextPath=/nacos server.port=8848 nacos.naming.empty-service.auto-clean=false nacos.naming.empty-service.clean.initial-delay-ms=60000 nacos.naming.empty-service.clean.period-time-ms=20000 management.metrics.export.elastic.enabled=false management.metrics.export.influx.enabled=false server.tomcat.accesslog.enabled=true server.tomcat.accesslog.pattern=%h %l %u %t \u0026#34;%r\u0026#34; %s %b %D %{User-Agent}i server.tomcat.basedir= nacos.security.ignore.urls=/,/error,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.ico,/console-fe/public/**,/v1/auth/**,/v1/console/health/**,/actuator/**,/v1/console/server/** nacos.core.auth.system.type=nacos nacos.core.auth.enabled=false nacos.core.auth.default.token.expire.seconds=18000 nacos.core.auth.default.token.secret.key=SecretKey012345678901234567890123456789012345678901234567890123456789 nacos.core.auth.caching.enabled=false nacos.istio.mcp.server.enabled=false spring.datasource.platform=mysql db.num=1 db.url.0=jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8\u0026amp;connectTimeout=1000\u0026amp;socketTimeout=3000\u0026amp;autoReconnect=true db.user=root db.password=123456 å®‰è£…elasticSearch å®‰è£… docker run -d --name es -p 9200:9200 -p 9300:9300 -e \u0026#34;discovery.type=single-node\u0026#34; docker.elastic.co/elasticsearch/elasticsearch:7.6.2 é…ç½®è·¨åŸŸå’Œå¯†ç  # è¿›å…¥å®¹å™¨ docker exec -it es /bin/bash # ç¼–è¾‘æ–‡ä»¶ vi config/elasticsearch.yml # åç§°ï¼Œä¿è¯å”¯ä¸€ cluster.name: es-1 # ä¸ºæœ¬æœºipåœ°å€,dockerä¸­ä¸º0.0.0.0 network.host: 0.0.0.0 # æ‰“å¼€è·¨åŸŸï¼Œé€‰å¡« http.cors.enabled: true http.cors.allow-origin: \u0026#34;*\u0026#34; http.cors.allow-headers: Authorization # å¼€å¯å®‰å…¨è®¤è¯ï¼Œé€‰å¡« xpack.security.enabled: true xpack.security.transport.ssl.enabled: true # é‡å¯é•œåƒ docker restart es # è®¾ç½®å¯†ç ï¼Œè¿›å…¥binç›®å½• # éœ€è¦ä¸º4ä¸ªç”¨æˆ·åˆ†åˆ«è®¾ç½®å¯†ç ï¼šelasticã€kibanaã€logstash_systemã€beats_system cd /usr/local/kibana-7.6.2-linux-x86_64/bin \u0026amp;\u0026amp; ./elasticsearch-setup-passwords interactive # æµè§ˆå™¨æŸ¥çœ‹ 192.168.0.18:9200 å®‰è£…ä¸­æ–‡åˆ†è¯ GitHubä¸‹è½½ # ä¸‹è½½åè§£å‹ç§»åŠ¨åˆ°/usr/share/elasticsearch/pluginsï¼Œé‡å¯ docker cp elasticsearch-analysis-ik-7.8.0/ es:/usr/share/elasticsearch/plugins docker restart es å®‰è£…Kibana åˆ›å»ºé…ç½®æ–‡ä»¶ server.name: kibana server.host: \u0026#34;0\u0026#34; # elasticSearchåœ°å€ elasticsearch.hosts: [ \u0026#34;http://127.0.0.1:9200\u0026#34; ] xpack.monitoring.ui.container.elasticsearch.enabled: true #æ·»åŠ å¯†ç æ•°æ® elasticsearch.username: \u0026#34;elastic\u0026#34; elasticsearch.password: \u0026#34;xxx\u0026#34; å®‰è£… docker run -d --log-driver json-file --log-opt max-size=100m --log-opt max-file=2 --name kibana -p 5601:5601 -v /opt/kibana/kibana.yml:/usr/share/kibana/config/kibana.yml kibana:7.4.1 # æµè§ˆå™¨æŸ¥çœ‹ 127.0.0.1:5601 å®‰è£…Oracle11g ä¸‹è½½Oracle 11g R2å®‰è£…åŒ… # åˆ›å»ºç›®å½• mkdir -p /opt/oracle/install/database # è§£å‹ä¸‹è½½çš„æ–‡ä»¶ unzip -d linux.x64_11gR2_database_1of2.zip /opt/oracle/install/database unzip -d linux.x64_11gR2_database_2of2.zip /opt/oracle/install/database # å®‰è£…,å®‰è£…è¿‡ç¨‹å¾ˆä¹…ï¼Œå¯èƒ½ä¼šå¡åœ¨ç»ˆç«¯,å¯ä»¥æ–°å¼€ä¸€ä¸ªç»ˆç«¯æŸ¥çœ‹æ˜¯å¦å®‰è£…å®Œæˆ docker run --privileged --name oracle -p 1521:1521 -v /opt/oracle/install/database:/install docker.io/jaspeen/oracle-11g # è¿›å…¥å®¹å™¨ docker exec -it oracle11g /bin/bash # åˆ‡æ¢åˆ°oracleç”¨æˆ· su - oracle # è¿›å…¥æ•°æ®åº“ sqlplus / as sysdba -- åˆ›å»ºä¸€ä¸ªç”¨æˆ· create user username identified by password; -- ç»™ç”¨æˆ·æˆæƒ grant create session,create table,create sequence,unlimited tablespace to username; å‡ºç°æ•°æ®åº“ä¸èƒ½è¿æ¥é”™è¯¯ æ‹·è´å®¹å™¨ä¸­çš„timezoneæ–‡ä»¶åˆ°æœ¬åœ° # ç¬¬ä¸€ä¸ªåå­—æ˜¯å®¹å™¨å’Œè·¯å¾„ï¼Œç¬¬äºŒä¸ªç‚¹ä»£è¡¨æ‹·è´åˆ°å½“å‰ç›®å½•ä¸‹ docker cp test/java:/etc/timezone . ä¿®æ”¹ Etc/CST æ”¾å›åŸä½ # åœ¨æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹æ‹·è´åˆ°å®¹å™¨çš„ /etc/ä¸‹ docker cp timezone å®¹å™¨åç§°:/etc/ Dockerè®¿é—®å®¿ä¸»æœº vim /etc/firewalld/zones/public.xml æ·»åŠ  \u0026lt;rule family=\u0026#34;ipv4\u0026#34;\u0026gt; \u0026lt;source address=\u0026#34;172.17.0.0/16\u0026#34; /\u0026gt; \u0026lt;accept /\u0026gt; \u0026lt;/rule\u0026gt; é‡å¯é˜²ç«å¢™ systemctl restart firewalld Dockerå‘½ä»¤è‡ªåŠ¨è¡¥å…¨ yum install -y bash-completion source /usr/share/bash-completion/bash_completion source /usr/share/bash-completion/completions/docker è®¾ç½®è‡ªå¯ è®¾ç½®è‡ªå¯åŠ¨ docker update --restart=always å®¹å™¨id å…³é—­è‡ªå¯åŠ¨ docker update --restart=no å®¹å™¨id å…³é—­æ‰€æœ‰è‡ªå¯åŠ¨ docker update --restart=no $(docker ps -q) ","permalink":"https://www.chenzqi.cn/posts/2020/20200325_docker%E9%A1%B9%E7%9B%AE%E5%AE%89%E8%A3%85%E8%AE%B0%E5%BD%95%E9%9B%86/","tags":["Docker"],"title":"Dockeré¡¹ç›®å®‰è£…è®°å½•é›†"},{"categories":[2019,"æŠ€æœ¯"],"contents":":::tip è§£å†³æŸè€ƒç ”æŸ¥è¯¢æŸå°ç¨‹åºjwtæƒé™è®¤è¯ä¸é‡‡é›† ::: å‰è¨€ æ—¥å¸¸é‡‡é›†æ•°æ®æ—¶, æœ‰å¾ˆå¤šéœ€è¦ç™»å½•æ‰èƒ½è·å–çš„æ•°æ®, ä¸èƒ½è§£å†³æƒé™è®¤è¯è¿™ä¸ªé—®é¢˜, å°±æ— æ³•è·å–åˆ°æƒ³è¦é‡‡é›†çš„æ•°æ®, ç›®ä¸‹æµè¡Œçš„è®¤è¯æœºåˆ¶æœ‰session, token ä¸ JWT, æœ€è¿‘å†™çˆ¬è™«é‡åˆ°è¿™ä¸ªé—®é¢˜, è®°å½•ä¸‹è§£å†³æ–¹æ³• çˆ¬è™«éœ€æ±‚ å¦‚å›¾: è·å–æ¯ä¸ªé«˜æ ¡è¯¦æƒ…é¡µçš„ä¸Š ä¸­ ä¸‹ ä¸‰éƒ¨åˆ†ç±»å®¹ åˆ—è¡¨é¡µ è¯¦æƒ…é¡µ é¡¹ç›®é€»è¾‘ ä½¿ç”¨FiddleræŠ“åŒ…, æŸ¥çœ‹å“åº”æ•°æ®ç»“æ„ å¯¹åº”å­—æ®µåˆ›å»ºæ•°æ®åº“è¡¨ ç¼–å†™çˆ¬è™«ä»£ç  è§£å†³æƒé™è®¤è¯é—®é¢˜ è§£ææ•°æ®, ä¿å­˜æ•°æ® æŠ“åŒ… è®¤è¯ ç¬¬ä¸€æ¬¡è¿›å°ç¨‹åºæ˜¯, ä¸€èˆ¬éƒ½ä¼šå¼¹å‡ºå¾®ä¿¡æˆæƒ, è¿™ä¸ªä¹Ÿå°±æ˜¯æœåŠ¡åç«¯ç”¨æ¥ç™»å½•çš„æ¥å£, æŠ“åŒ…å‘ç°è¿”å›ç™»å½•æˆåŠŸçš„æ•°æ®, tokenç»“æ„æ˜¯æ— ç–‘é—®åç«¯é‡‡é›†çš„æ˜¯ JWT è®¤è¯æœºåˆ¶, æœ‰äº†ç™»å½•æ¥å£, é‡‡é›†å°±å¥½åŠäº†, è€ŒJWTçš„ä½¿ç”¨åœ¨è¯·æ±‚æ—¶Headersä¸­å¸¦ä¸ŠAuthorizationå‚æ•° åˆ—è¡¨é¡µ è¯¦æƒ…é¡µ ::: tip æ€»ç»“ åœ¨è¯·æ±‚æ¥å£æ—¶, å…¨ç¨‹æºå¸¦è®¤è¯ä»¤ç‰Œä¸”ä¿è¯ä»¤ç‰Œæœ‰æ•ˆ, å¦åˆ™æ— æ³•è·å–æ•°æ® ::: å»ºè¡¨ çˆ¬è™« ä½¿ç”¨scrapyæ¡†æ¶å¼€å‘ èµ·å§‹å‡½æ•° è¯¦æƒ…é¡µå‡½æ•° å†™å…¥æ•°æ®åº“ ä¸‹è½½ä¸­é—´ä»¶ è¿™æ­¥å°±æ˜¯å®ç°æºå¸¦ä»¤ç‰Œè®¿é—®çš„ä»£ç , éœ€è¦åœ¨é…ç½®å¼€å¯æ­¤ä¸­é—´ä»¶ åŠ äº†éšæœºè¯·æ±‚å¤´åŠŸèƒ½, ä»£ç†ipä¹Ÿå¯åœ¨æ­¤ä¸­é—´ä»¶åŠ å…¥ é…ç½®æ–‡ä»¶ é…ç½®æ•°æ®åº“ä¿¡æ¯ ç»“æœ è¾“å‡º æ•°æ® 20åˆ†é’Ÿé‡‡é›†äº†1ä¸‡æ¡æ•°æ® ","permalink":"https://www.chenzqi.cn/posts/2019/20190620_xxx%E8%80%83%E7%A0%94%E6%9F%A5%E8%AF%A2%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%88%AC%E8%99%AB/","tags":["æ¡†æ¶","scrapy","çˆ¬è™«"],"title":"æŸè€ƒç ”æŸ¥è¯¢å¾®ä¿¡å°ç¨‹åºçˆ¬è™«"},{"categories":[2019,"æŠ€æœ¯"],"contents":"ç®€ä»‹ åˆ†å¸ƒå¼çš„å®æ—¶æ–‡æ¡£å­˜å‚¨ï¼Œæ¯ä¸ªå­—æ®µå¯ä»¥è¢«ç´¢å¼•ä¸æœç´¢ åˆ†å¸ƒå¼å®æ—¶åˆ†ææœç´¢å¼•æ“ èƒœä»»ä¸Šç™¾ä¸ªæœåŠ¡èŠ‚ç‚¹çš„æ‰©å±•ï¼Œæ”¯æŒ PB çº§åˆ«çš„ç»“æ„åŒ–æˆ–è€…éç»“æ„åŒ–æ•°æ® Elasticsearch çš„å®‰è£… Elasticsearchå®˜æ–¹ç½‘ç«™ã€‚ ä¸‹è½½å®‰è£…åŒ…å¹¶è§£å‹ï¼Œç„¶åè¿è¡Œ bin/elasticsearchï¼ˆMac æˆ– Linuxï¼‰ æˆ–è€… bin\\elasticsearch.bat (Windows) å³å¯å¯åŠ¨ Elasticsearchã€‚ Mac ä¸‹æ¨èä½¿ç”¨ Homebrew å®‰è£…ï¼š å®‰è£…Homebrewé—®é¢˜ brew install elasticsearch Elasticsearch é»˜è®¤ä¼šåœ¨ 9200 ç«¯å£ä¸Šè¿è¡Œï¼Œæˆ‘ä»¬æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:9200/ å°±å¯ä»¥çœ‹åˆ°ç±»ä¼¼å†…å®¹ { \u0026#34;name\u0026#34;Â :Â \u0026#34;atntrTf\u0026#34;, \u0026#34;cluster_name\u0026#34;Â :Â \u0026#34;elasticsearch\u0026#34;, \u0026#34;cluster_uuid\u0026#34;Â :Â \u0026#34;e64hkjGtTp6_G2h1Xxdv5g\u0026#34;, \u0026#34;version\u0026#34;Â :Â { \u0026#34;number\u0026#34;:Â \u0026#34;6.2.4\u0026#34;, \u0026#34;build_hash\u0026#34;:Â \u0026#34;ccec39f\u0026#34;, \u0026#34;build_date\u0026#34;:Â \u0026#34;2018-04-12T20:37:28.497551Z\u0026#34;, \u0026#34;build_snapshot\u0026#34;:Â false, \u0026#34;lucene_version\u0026#34;:Â \u0026#34;7.2.1\u0026#34;, \u0026#34;minimum_wire_compatibility_version\u0026#34;:Â \u0026#34;5.6.0\u0026#34;, \u0026#34;minimum_index_compatibility_version\u0026#34;:Â \u0026#34;5.0.0\u0026#34; }, \u0026#34;tagline\u0026#34;Â :Â \u0026#34;YouÂ Know,Â forÂ Search\u0026#34; } ç‰ˆæœ¬å¾ˆé‡è¦ï¼Œä»¥åå®‰è£…ä¸€äº›æ’ä»¶éƒ½è¦åšåˆ°ç‰ˆæœ¬å¯¹åº”æ‰å¯ä»¥ã€‚ Elasticsearch ç›¸å…³æ¦‚å¿µ åœ¨ Elasticsearch ä¸­æœ‰å‡ ä¸ªåŸºæœ¬çš„æ¦‚å¿µï¼Œå¦‚èŠ‚ç‚¹ã€ç´¢å¼•ã€æ–‡æ¡£ç­‰ã€‚ Node å’Œ Cluster Elasticsearch æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œå…è®¸å¤šå°æœåŠ¡å™¨ååŒå·¥ä½œï¼Œæ¯å°æœåŠ¡å™¨å¯ä»¥è¿è¡Œå¤šä¸ª Elasticsearch å®ä¾‹ã€‚ å•ä¸ª Elasticsearch å®ä¾‹ç§°ä¸ºä¸€ä¸ªèŠ‚ç‚¹ï¼ˆNodeï¼‰ã€‚ä¸€ç»„èŠ‚ç‚¹æ„æˆä¸€ä¸ªé›†ç¾¤ï¼ˆClusterï¼‰ã€‚ Index Elasticsearch ä¼šç´¢å¼•æ‰€æœ‰å­—æ®µï¼Œç»è¿‡å¤„ç†åå†™å…¥ä¸€ä¸ªåå‘ç´¢å¼•ï¼ˆInverted Indexï¼‰ã€‚æŸ¥æ‰¾æ•°æ®çš„æ—¶å€™ï¼Œç›´æ¥æŸ¥æ‰¾è¯¥ç´¢å¼•ã€‚ æ‰€ä»¥ï¼ŒElasticsearch æ•°æ®ç®¡ç†çš„é¡¶å±‚å•ä½å°±å«åš Indexï¼ˆç´¢å¼•ï¼‰ï¼Œå…¶å®å°±ç›¸å½“äº MySQLã€MongoDB ç­‰é‡Œé¢çš„æ•°æ®åº“çš„æ¦‚å¿µã€‚å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ¯ä¸ª Index ï¼ˆå³æ•°æ®åº“ï¼‰çš„åå­—å¿…é¡»æ˜¯å°å†™ã€‚ Document Index é‡Œé¢å•æ¡çš„è®°å½•ç§°ä¸º Documentï¼ˆæ–‡æ¡£ï¼‰ã€‚è®¸å¤šæ¡ Document æ„æˆäº†ä¸€ä¸ª Indexã€‚ Document ä½¿ç”¨ JSON æ ¼å¼è¡¨ç¤ºï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ åŒä¸€ä¸ª Index é‡Œé¢çš„ Documentï¼Œä¸è¦æ±‚æœ‰ç›¸åŒçš„ç»“æ„ï¼ˆschemeï¼‰ï¼Œä½†æ˜¯æœ€å¥½ä¿æŒç›¸åŒï¼Œè¿™æ ·æœ‰åˆ©äºæé«˜æœç´¢æ•ˆç‡ã€‚ Type Document å¯ä»¥åˆ†ç»„ï¼Œæ¯”å¦‚ weather è¿™ä¸ª Index é‡Œé¢ï¼Œå¯ä»¥æŒ‰åŸå¸‚åˆ†ç»„ï¼ˆåŒ—äº¬å’Œä¸Šæµ·ï¼‰ï¼Œä¹Ÿå¯ä»¥æŒ‰æ°”å€™åˆ†ç»„ï¼ˆæ™´å¤©å’Œé›¨å¤©ï¼‰ã€‚è¿™ç§åˆ†ç»„å°±å«åš Typeï¼Œå®ƒæ˜¯è™šæ‹Ÿçš„é€»è¾‘åˆ†ç»„ï¼Œç”¨æ¥è¿‡æ»¤ Documentï¼Œç±»ä¼¼ MySQL ä¸­çš„æ•°æ®è¡¨ï¼ŒMongoDB ä¸­çš„ Collectionã€‚ ä¸åŒçš„ Type åº”è¯¥æœ‰ç›¸ä¼¼çš„ç»“æ„ï¼ˆSchemaï¼‰ï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œid å­—æ®µä¸èƒ½åœ¨è¿™ä¸ªç»„æ˜¯å­—ç¬¦ä¸²ï¼Œåœ¨å¦ä¸€ä¸ªç»„æ˜¯æ•°å€¼ã€‚è¿™æ˜¯ä¸å…³ç³»å‹æ•°æ®åº“çš„è¡¨çš„ä¸€ä¸ªåŒºåˆ«ã€‚æ€§è´¨å®Œå…¨ä¸åŒçš„æ•°æ®ï¼ˆæ¯”å¦‚ products å’Œ logsï¼‰åº”è¯¥å­˜æˆä¸¤ä¸ª Indexï¼Œè€Œä¸æ˜¯ä¸€ä¸ª Index é‡Œé¢çš„ä¸¤ä¸ª Typeï¼ˆè™½ç„¶å¯ä»¥åšåˆ°ï¼‰ã€‚ æ ¹æ®è§„åˆ’ï¼ŒElastic 6.x ç‰ˆåªå…è®¸æ¯ä¸ª Index åŒ…å«ä¸€ä¸ª Typeï¼Œ7.x ç‰ˆå°†ä¼šå½»åº•ç§»é™¤ Typeã€‚ Fields å³å­—æ®µï¼Œæ¯ä¸ª Document éƒ½ç±»ä¼¼ä¸€ä¸ª JSON ç»“æ„ï¼Œå®ƒåŒ…å«äº†è®¸å¤šå­—æ®µï¼Œæ¯ä¸ªå­—æ®µéƒ½æœ‰å…¶å¯¹åº”çš„å€¼ï¼Œå¤šä¸ªå­—æ®µç»„æˆäº†ä¸€ä¸ª Documentï¼Œå…¶å®å°±å¯ä»¥ç±»æ¯” MySQL æ•°æ®è¡¨ä¸­çš„å­—æ®µã€‚ åœ¨ Elasticsearch ä¸­ï¼Œæ–‡æ¡£å½’å±äºä¸€ç§ç±»å‹ï¼ˆTypeï¼‰ï¼Œè€Œè¿™äº›ç±»å‹å­˜åœ¨äºç´¢å¼•ï¼ˆIndexï¼‰ä¸­ï¼Œäº›ç®€å•çš„å¯¹æ¯”å›¾æ¥ç±»æ¯”ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ï¼š Relational DB -\u0026gt; Databases -\u0026gt; Tables -\u0026gt; Rows -\u0026gt; Columns Elasticsearch -\u0026gt; Indices -\u0026gt; Types -\u0026gt; Documents -\u0026gt; Fields Python å¯¹æ¥ Elasticsearch Elasticsearch æä¾›äº†ä¸€ç³»åˆ— Restful API æ¥è¿›è¡Œå­˜å–å’ŒæŸ¥è¯¢æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ curl ç­‰å‘½ä»¤æ¥è¿›è¡Œæ“ä½œã€‚è¿™é‡Œç›´æ¥åˆ©ç”¨ Python æ¥å¯¹æ¥ Elasticsearch çš„ç›¸å…³æ–¹æ³•ã€‚ Python ä¸­å¯¹æ¥ Elasticsearch ä½¿ç”¨çš„å°±æ˜¯ä¸€ä¸ªåŒåçš„åº“ï¼š pip3 install elasticsearch å®˜æ–¹æ–‡æ¡£ï¼Œåé¢çš„å†…å®¹ä¹Ÿæ˜¯åŸºäºå®˜æ–¹æ–‡æ¡£ã€‚ åˆ›å»º Index åˆ›å»ºä¸€ä¸ªåä¸º news çš„ç´¢å¼•ï¼š from elasticsearch import Elasticsearch es = Elasticsearch() result = es.indices.create(index=\u0026#39;news\u0026#39;, ignore=400) print(result) åˆ›å»ºæˆåŠŸï¼Œä¼šè¿”å›å¦‚ä¸‹ç»“æœï¼š {\u0026#39;acknowledged\u0026#39;: True, \u0026#39;shards_acknowledged\u0026#39;: True, \u0026#39;index\u0026#39;: \u0026#39;news\u0026#39;} è¿”å›ç»“æœæ˜¯ JSON æ ¼å¼ï¼Œå…¶ä¸­çš„ acknowledged å­—æ®µè¡¨ç¤ºåˆ›å»ºæ“ä½œæ‰§è¡ŒæˆåŠŸã€‚ å¦‚æœæŠŠä»£ç æ‰§è¡Œä¸€æ¬¡çš„è¯ï¼Œå°±ä¼šè¿”å›å¦‚ä¸‹ç»“æœï¼š {\u0026#39;error\u0026#39;: {\u0026#39;root_cause\u0026#39;: [{\u0026#39;type\u0026#39;: \u0026#39;resource_already_exists_exception\u0026#39;, \u0026#39;reason\u0026#39;: \u0026#39;index [news/QM6yz2W8QE-bflKhc5oThw] already exists\u0026#39;, \u0026#39;index_uuid\u0026#39;: \u0026#39;QM6yz2W8QE-bflKhc5oThw\u0026#39;, \u0026#39;index\u0026#39;: \u0026#39;news\u0026#39;}], \u0026#39;type\u0026#39;: \u0026#39;resource_already_exists_exception\u0026#39;, \u0026#39;reason\u0026#39;: \u0026#39;index [news/QM6yz2W8QE-bflKhc5oThw] already exists\u0026#39;, \u0026#39;index_uuid\u0026#39;: \u0026#39;QM6yz2W8QE-bflKhc5oThw\u0026#39;, \u0026#39;index\u0026#39;: \u0026#39;news\u0026#39;}, \u0026#39;status\u0026#39;: 400} å®ƒæç¤ºåˆ›å»ºå¤±è´¥ï¼Œstatus çŠ¶æ€ç æ˜¯ 400ï¼Œé”™è¯¯åŸå› æ˜¯ Index å·²ç»å­˜åœ¨äº†ã€‚ æ³¨æ„è¿™é‡Œä»£ç é‡Œé¢ä½¿ç”¨äº† ignore å‚æ•°ä¸º 400ï¼Œè¿™è¯´æ˜å¦‚æœè¿”å›ç»“æœæ˜¯ 400 çš„è¯ï¼Œå°±å¿½ç•¥è¿™ä¸ªé”™è¯¯ä¸ä¼šæŠ¥é”™ï¼Œç¨‹åºä¸ä¼šæ‰§è¡ŒæŠ›å‡ºå¼‚å¸¸ã€‚ å‡å¦‚ä¸åŠ  ignore è¿™ä¸ªå‚æ•°çš„è¯ï¼š es = Elasticsearch() result = es.indices.create(index=\u0026#39;news\u0026#39;) print(result) å†æ¬¡æ‰§è¡Œå°±ä¼šæŠ¥é”™äº†ï¼š raise HTTP_EXCEPTIONS.get(status_code, TransportError)(status_code, error_message, additional_info) elasticsearch.exceptions.RequestError: TransportError(400, \u0026#39;resource_already_exists_exception\u0026#39;, \u0026#39;index [news/QM6yz2W8QE-bflKhc5oThw] already exists\u0026#39;) è¿™æ ·ç¨‹åºçš„æ‰§è¡Œå°±ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦å–„ç”¨ ignore å‚æ•°ï¼ŒæŠŠä¸€äº›æ„å¤–æƒ…å†µæ’é™¤ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ç¨‹åºçš„æ­£å¸¸æ‰§è¡Œè€Œä¸ä¼šä¸­æ–­ã€‚ åˆ é™¤ Index åˆ é™¤ Index ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š from elasticsearch import Elasticsearch es = Elasticsearch() result = es.indices.delete(index=\u0026#39;news\u0026#39;, ignore=[400, 404]) print(result) è¿™é‡Œä¹Ÿæ˜¯ä½¿ç”¨äº† ignore å‚æ•°ï¼Œæ¥å¿½ç•¥ Index ä¸å­˜åœ¨è€Œåˆ é™¤å¤±è´¥å¯¼è‡´ç¨‹åºä¸­æ–­çš„é—®é¢˜ã€‚ å¦‚æœåˆ é™¤æˆåŠŸï¼Œä¼šè¾“å‡ºå¦‚ä¸‹ç»“æœï¼š {\u0026#39;acknowledged\u0026#39;: True} å¦‚æœ Index å·²ç»è¢«åˆ é™¤ï¼Œå†æ‰§è¡Œåˆ é™¤åˆ™ä¼šè¾“å‡ºå¦‚ä¸‹ç»“æœï¼š {\u0026#39;error\u0026#39;: {\u0026#39;root_cause\u0026#39;: [{\u0026#39;type\u0026#39;: \u0026#39;index_not_found_exception\u0026#39;, \u0026#39;reason\u0026#39;: \u0026#39;no such index\u0026#39;, \u0026#39;resource.type\u0026#39;: \u0026#39;index_or_alias\u0026#39;, \u0026#39;resource.id\u0026#39;: \u0026#39;news\u0026#39;, \u0026#39;index_uuid\u0026#39;: \u0026#39;_na_\u0026#39;, \u0026#39;index\u0026#39;: \u0026#39;news\u0026#39;}], \u0026#39;type\u0026#39;: \u0026#39;index_not_found_exception\u0026#39;, \u0026#39;reason\u0026#39;: \u0026#39;no such index\u0026#39;, \u0026#39;resource.type\u0026#39;: \u0026#39;index_or_alias\u0026#39;, \u0026#39;resource.id\u0026#39;: \u0026#39;news\u0026#39;, \u0026#39;index_uuid\u0026#39;: \u0026#39;_na_\u0026#39;, \u0026#39;index\u0026#39;: \u0026#39;news\u0026#39;}, \u0026#39;status\u0026#39;: 404} è¿™ä¸ªç»“æœè¡¨æ˜å½“å‰ Index ä¸å­˜åœ¨ï¼Œåˆ é™¤å¤±è´¥ï¼Œè¿”å›çš„ç»“æœåŒæ ·æ˜¯ JSONï¼ŒçŠ¶æ€ç æ˜¯ 400ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬æ·»åŠ äº† ignore å‚æ•°ï¼Œå¿½ç•¥äº† 400 çŠ¶æ€ç ï¼Œå› æ­¤ç¨‹åºæ­£å¸¸æ‰§è¡Œè¾“å‡º JSON ç»“æœï¼Œè€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸ã€‚ æ’å…¥æ•°æ® Elasticsearch å°±åƒ MongoDB ä¸€æ ·ï¼Œåœ¨æ’å…¥æ•°æ®çš„æ—¶å€™å¯ä»¥ç›´æ¥æ’å…¥ç»“æ„åŒ–å­—å…¸æ•°æ®ï¼Œæ’å…¥æ•°æ®å¯ä»¥è°ƒç”¨ create() æ–¹æ³•ï¼Œæ’å…¥ä¸€æ¡æ–°é—»æ•°æ®ï¼š from elasticsearch import Elasticsearch es = Elasticsearch() es.indices.create(index=\u0026#39;news\u0026#39;, ignore=400) data = {\u0026#39;title\u0026#39;: \u0026#39;ç¾å›½ç•™ç»™ä¼Šæ‹‰å…‹çš„æ˜¯ä¸ªçƒ‚æ‘Šå­å—\u0026#39;, \u0026#39;url\u0026#39;: \u0026#39;http://view.news.qq.com/zt2011/usa_iraq/index.htm\u0026#39;} result = es.create(index=\u0026#39;news\u0026#39;, doc_type=\u0026#39;politics\u0026#39;, id=1, body=data) print(result) è¿™é‡Œé¦–å…ˆå£°æ˜äº†ä¸€æ¡æ–°é—»æ•°æ®ï¼ŒåŒ…æ‹¬æ ‡é¢˜å’Œé“¾æ¥ï¼Œç„¶åé€šè¿‡è°ƒç”¨ create() æ–¹æ³•æ’å…¥äº†è¿™æ¡æ•°æ®ï¼Œåœ¨è°ƒç”¨ create() æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ä¼ å…¥äº†å››ä¸ªå‚æ•°ï¼Œindex å‚æ•°ä»£è¡¨äº†ç´¢å¼•åç§°ï¼Œdoc_type ä»£è¡¨äº†æ–‡æ¡£ç±»å‹ï¼Œbody åˆ™ä»£è¡¨äº†æ–‡æ¡£å…·ä½“å†…å®¹ï¼Œid åˆ™æ˜¯æ•°æ®çš„å”¯ä¸€æ ‡è¯† IDã€‚ è¿è¡Œç»“æœå¦‚ä¸‹ï¼š {\u0026#39;_index\u0026#39;: \u0026#39;news\u0026#39;, \u0026#39;_type\u0026#39;: \u0026#39;politics\u0026#39;, \u0026#39;_id\u0026#39;: \u0026#39;1\u0026#39;, \u0026#39;_version\u0026#39;: 1, \u0026#39;result\u0026#39;: \u0026#39;created\u0026#39;, \u0026#39;_shards\u0026#39;: {\u0026#39;total\u0026#39;: 2, \u0026#39;successful\u0026#39;: 1, \u0026#39;failed\u0026#39;: 0}, \u0026#39;_seq_no\u0026#39;: 0, \u0026#39;_primary_term\u0026#39;: 1} ç»“æœä¸­ result å­—æ®µä¸º createdï¼Œä»£è¡¨è¯¥æ•°æ®æ’å…¥æˆåŠŸã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨ index() æ–¹æ³•æ¥æ’å…¥æ•°æ®ï¼Œä½†ä¸ create() ä¸åŒçš„æ˜¯ï¼Œcreate() æ–¹æ³•éœ€è¦æŒ‡å®š id å­—æ®µæ¥å”¯ä¸€æ ‡è¯†è¯¥æ¡æ•°æ®ï¼Œè€Œ index() æ–¹æ³•åˆ™ä¸éœ€è¦ï¼Œå¦‚æœä¸æŒ‡å®š idï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª idï¼Œè°ƒç”¨ index() æ–¹æ³•çš„å†™æ³•å¦‚ä¸‹ï¼š es.index(index=\u0026#39;news\u0026#39;, doc_type=\u0026#39;politics\u0026#39;, body=data) create() æ–¹æ³•å†…éƒ¨å…¶å®ä¹Ÿæ˜¯è°ƒç”¨äº† index() æ–¹æ³•ï¼Œæ˜¯å¯¹ index() æ–¹æ³•çš„å°è£…ã€‚ æ›´æ–°æ•°æ® æ›´æ–°æ•°æ®åŒæ ·éœ€è¦æŒ‡å®šæ•°æ®çš„ id å’Œå†…å®¹ï¼Œè°ƒç”¨ update() æ–¹æ³•å³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š from elasticsearch import Elasticsearch es = Elasticsearch() data = { \u0026#39;title\u0026#39;: \u0026#39;ç¾å›½ç•™ç»™ä¼Šæ‹‰å…‹çš„æ˜¯ä¸ªçƒ‚æ‘Šå­å—\u0026#39;, \u0026#39;url\u0026#39;: \u0026#39;http://view.news.qq.com/zt2011/usa_iraq/index.htm\u0026#39;, \u0026#39;date\u0026#39;: \u0026#39;2011-12-16\u0026#39; } result = es.update(index=\u0026#39;news\u0026#39;, doc_type=\u0026#39;politics\u0026#39;, body=data, id=1) print(result) ä¸ºæ•°æ®å¢åŠ äº†ä¸€ä¸ªæ—¥æœŸå­—æ®µï¼Œç„¶åè°ƒç”¨äº† update() æ–¹æ³•ï¼Œç»“æœå¦‚ä¸‹ï¼š {\u0026#39;_index\u0026#39;: \u0026#39;news\u0026#39;, \u0026#39;_type\u0026#39;: \u0026#39;politics\u0026#39;, \u0026#39;_id\u0026#39;: \u0026#39;1\u0026#39;, \u0026#39;_version\u0026#39;: 2, \u0026#39;result\u0026#39;: \u0026#39;updated\u0026#39;, \u0026#39;_shards\u0026#39;: {\u0026#39;total\u0026#39;: 2, \u0026#39;successful\u0026#39;: 1, \u0026#39;failed\u0026#39;: 0}, \u0026#39;_seq_no\u0026#39;: 1, \u0026#39;_primary_term\u0026#39;: 1} è¿”å›ç»“æœä¸­ï¼Œresult å­—æ®µä¸º updatedï¼Œå³è¡¨ç¤ºæ›´æ–°æˆåŠŸï¼Œæ³¨æ„å­—æ®µ _versionï¼Œè¿™ä»£è¡¨æ›´æ–°åçš„ç‰ˆæœ¬å·æ•°ï¼Œ2 ä»£è¡¨è¿™æ˜¯ç¬¬äºŒä¸ªç‰ˆæœ¬ï¼Œå› ä¸ºä¹‹å‰å·²ç»æ’å…¥è¿‡ä¸€æ¬¡æ•°æ®ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡æ’å…¥çš„æ•°æ®æ˜¯ç‰ˆæœ¬ 1ï¼Œå¯ä»¥å‚è§ä¸Šä¾‹çš„è¿è¡Œç»“æœï¼Œè¿™æ¬¡æ›´æ–°ä¹‹åç‰ˆæœ¬å·å°±å˜æˆäº† 2ï¼Œä»¥åæ¯æ›´æ–°ä¸€æ¬¡ï¼Œç‰ˆæœ¬å·éƒ½ä¼šåŠ  1ã€‚ å¦å¤–æ›´æ–°æ“ä½œå…¶å®åˆ©ç”¨ index() æ–¹æ³•åŒæ ·å¯ä»¥åšåˆ°ï¼Œå†™æ³•å¦‚ä¸‹ï¼š es.index(index=\u0026#39;news\u0026#39;, doc_type=\u0026#39;politics\u0026#39;, body=data, id=1) index() æ–¹æ³•å¯ä»¥ä»£å®Œæˆä¸¤ä¸ªæ“ä½œï¼Œå¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œé‚£å°±æ‰§è¡Œæ’å…¥æ“ä½œï¼Œå¦‚æœå·²ç»å­˜åœ¨ï¼Œé‚£å°±æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œéå¸¸æ–¹ä¾¿ã€‚ åˆ é™¤æ•°æ® å¦‚æœæƒ³åˆ é™¤ä¸€æ¡æ•°æ®å¯ä»¥è°ƒç”¨ delete() æ–¹æ³•ï¼ŒæŒ‡å®šéœ€è¦åˆ é™¤çš„æ•°æ® id å³å¯ï¼Œå†™æ³•å¦‚ä¸‹ï¼š from elasticsearch import Elasticsearch es = Elasticsearch() result = es.delete(index=\u0026#39;news\u0026#39;, doc_type=\u0026#39;politics\u0026#39;, id=1) print(result) è¿è¡Œç»“æœå¦‚ä¸‹ï¼š {\u0026#39;_index\u0026#39;: \u0026#39;news\u0026#39;, \u0026#39;_type\u0026#39;: \u0026#39;politics\u0026#39;, \u0026#39;_id\u0026#39;: \u0026#39;1\u0026#39;, \u0026#39;_version\u0026#39;: 3, \u0026#39;result\u0026#39;: \u0026#39;deleted\u0026#39;, \u0026#39;_shards\u0026#39;: {\u0026#39;total\u0026#39;: 2, \u0026#39;successful\u0026#39;: 1, \u0026#39;failed\u0026#39;: 0}, \u0026#39;_seq_no\u0026#39;: 2, \u0026#39;_primary_term\u0026#39;: 1} å¯ä»¥çœ‹åˆ°è¿è¡Œç»“æœä¸­ result å­—æ®µä¸º deletedï¼Œä»£è¡¨åˆ é™¤æˆåŠŸï¼Œ_version å˜æˆäº† 3ï¼Œåˆå¢åŠ äº† 1ã€‚ æŸ¥è¯¢æ•°æ® ä¸Šé¢çš„å‡ ä¸ªæ“ä½œéƒ½æ˜¯éå¸¸ç®€å•çš„æ“ä½œï¼Œæ™®é€šçš„æ•°æ®åº“å¦‚ MongoDB éƒ½æ˜¯å¯ä»¥å®Œæˆçš„ï¼ŒElasticsearch æ›´ç‰¹æ®Šçš„åœ°æ–¹åœ¨äºå…¶å¼‚å¸¸å¼ºå¤§çš„æ£€ç´¢åŠŸèƒ½ã€‚ å¯¹äºä¸­æ–‡æ¥è¯´ï¼Œéœ€è¦å®‰è£…ä¸€ä¸ªåˆ†è¯æ’ä»¶ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ elasticsearch-analysis-ikï¼ŒGitHub é“¾æ¥ä¸ºï¼šelasticsearch-analysis-ikï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ Elasticsearch çš„å¦ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…· elasticsearch-plugin æ¥å®‰è£…ï¼Œè¿™é‡Œå®‰è£…çš„ç‰ˆæœ¬æ˜¯ 6.2.4ï¼Œè¯·ç¡®ä¿å’Œ Elasticsearch çš„ç‰ˆæœ¬å¯¹åº”èµ·æ¥ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.2.4/elasticsearch-analysis-ik-6.2.4.zip è¿™é‡Œçš„ç‰ˆæœ¬å·è¯·æ›¿æ¢æˆä½ çš„ Elasticsearch çš„ç‰ˆæœ¬å·ã€‚ å®‰è£…ä¹‹åé‡æ–°å¯åŠ¨ Elasticsearch å°±å¯ä»¥äº†ï¼Œå®ƒä¼šè‡ªåŠ¨åŠ è½½å®‰è£…å¥½çš„æ’ä»¶ã€‚ é¦–å…ˆæ–°å»ºä¸€ä¸ªç´¢å¼•å¹¶æŒ‡å®šéœ€è¦åˆ†è¯çš„å­—æ®µï¼Œä»£ç å¦‚ä¸‹ï¼š from elasticsearch import Elasticsearch es = Elasticsearch() mapping = { \u0026#39;properties\u0026#39;: { \u0026#39;title\u0026#39;: { \u0026#39;type\u0026#39;: \u0026#39;text\u0026#39;, \u0026#39;analyzer\u0026#39;: \u0026#39;ik_max_word\u0026#39;, \u0026#39;search_analyzer\u0026#39;: \u0026#39;ik_max_word\u0026#39; } } } es.indices.delete(index=\u0026#39;news\u0026#39;, ignore=[400, 404]) es.indices.create(index=\u0026#39;news\u0026#39;, ignore=400) result = es.indices.put_mapping(index=\u0026#39;news\u0026#39;, doc_type=\u0026#39;politics\u0026#39;, body=mapping) print(result) è¿™é‡Œå…ˆå°†ä¹‹å‰çš„ç´¢å¼•åˆ é™¤äº†ï¼Œç„¶åæ–°å»ºäº†ä¸€ä¸ªç´¢å¼•ï¼Œç„¶åæ›´æ–°äº†å®ƒçš„ mapping ä¿¡æ¯ï¼Œmapping ä¿¡æ¯ä¸­æŒ‡å®šäº†åˆ†è¯çš„å­—æ®µï¼ŒæŒ‡å®šäº†å­—æ®µçš„ç±»å‹ type ä¸º textï¼Œåˆ†è¯å™¨ analyzer å’Œ æœç´¢åˆ†è¯å™¨ search_analyzer ä¸º ik_max_wordï¼Œå³ä½¿ç”¨æˆ‘ä»¬åˆšæ‰å®‰è£…çš„ä¸­æ–‡åˆ†è¯æ’ä»¶ã€‚å¦‚æœä¸æŒ‡å®šçš„è¯åˆ™ä½¿ç”¨é»˜è®¤çš„è‹±æ–‡åˆ†è¯å™¨ã€‚ æ’å…¥å‡ æ¡æ–°çš„æ•°æ®ï¼š datas = [ { \u0026#39;title\u0026#39;: \u0026#39;ç¾å›½ç•™ç»™ä¼Šæ‹‰å…‹çš„æ˜¯ä¸ªçƒ‚æ‘Šå­å—\u0026#39;, \u0026#39;url\u0026#39;: \u0026#39;http://view.news.qq.com/zt2011/usa_iraq/index.htm\u0026#39;, \u0026#39;date\u0026#39;: \u0026#39;2011-12-16\u0026#39; }, { \u0026#39;title\u0026#39;: \u0026#39;å…¬å®‰éƒ¨ï¼šå„åœ°æ ¡è½¦å°†äº«æœ€é«˜è·¯æƒ\u0026#39;, \u0026#39;url\u0026#39;: \u0026#39;http://www.chinanews.com/gn/2011/12-16/3536077.shtml\u0026#39;, \u0026#39;date\u0026#39;: \u0026#39;2011-12-16\u0026#39; }, { \u0026#39;title\u0026#39;: \u0026#39;ä¸­éŸ©æ¸”è­¦å†²çªè°ƒæŸ¥ï¼šéŸ©è­¦å¹³å‡æ¯å¤©æ‰£1è‰˜ä¸­å›½æ¸”èˆ¹\u0026#39;, \u0026#39;url\u0026#39;: \u0026#39;https://news.qq.com/a/20111216/001044.htm\u0026#39;, \u0026#39;date\u0026#39;: \u0026#39;2011-12-17\u0026#39; }, { \u0026#39;title\u0026#39;: \u0026#39;ä¸­å›½é©»æ´›æ‰çŸ¶é¢†äº‹é¦†é­äºšè£”ç”·å­æªå‡» å«ŒçŠ¯å·²è‡ªé¦–\u0026#39;, \u0026#39;url\u0026#39;: \u0026#39;http://news.ifeng.com/world/detail_2011_12/16/11372558_0.shtml\u0026#39;, \u0026#39;date\u0026#39;: \u0026#39;2011-12-18\u0026#39; } ] for data in datas: es.index(index=\u0026#39;news\u0026#39;, doc_type=\u0026#39;politics\u0026#39;, body=data) æŒ‡å®šäº†å››æ¡æ•°æ®ï¼Œéƒ½å¸¦æœ‰ titleã€urlã€date å­—æ®µï¼Œç„¶åé€šè¿‡ index() æ–¹æ³•å°†å…¶æ’å…¥ Elasticsearch ä¸­ï¼Œç´¢å¼•åç§°ä¸º newsï¼Œç±»å‹ä¸º politicsã€‚ æ ¹æ®å…³é”®è¯æŸ¥è¯¢ä¸€ä¸‹ç›¸å…³å†…å®¹ï¼š result = es.search(index=\u0026#39;news\u0026#39;, doc_type=\u0026#39;politics\u0026#39;) print(result) æŸ¥è¯¢å‡ºäº†æ‰€æœ‰æ’å…¥çš„å››æ¡æ•°æ®ï¼š { \u0026#34;took\u0026#34;: 0, \u0026#34;timed_out\u0026#34;: false, \u0026#34;_shards\u0026#34;: { \u0026#34;total\u0026#34;: 5, \u0026#34;successful\u0026#34;: 5, \u0026#34;skipped\u0026#34;: 0, \u0026#34;failed\u0026#34;: 0 }, \u0026#34;hits\u0026#34;: { \u0026#34;total\u0026#34;: 4, \u0026#34;max_score\u0026#34;: 1.0, \u0026#34;hits\u0026#34;: [ { \u0026#34;_index\u0026#34;: \u0026#34;news\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;politics\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;c05G9mQBD9BuE5fdHOUT\u0026#34;, \u0026#34;_score\u0026#34;: 1.0, \u0026#34;_source\u0026#34;: { \u0026#34;title\u0026#34;: \u0026#34;ç¾å›½ç•™ç»™ä¼Šæ‹‰å…‹çš„æ˜¯ä¸ªçƒ‚æ‘Šå­å—\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;http://view.news.qq.com/zt2011/usa_iraq/index.htm\u0026#34;, \u0026#34;date\u0026#34;: \u0026#34;2011-12-16\u0026#34; } }, { \u0026#34;_index\u0026#34;: \u0026#34;news\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;politics\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;dk5G9mQBD9BuE5fdHOUm\u0026#34;, \u0026#34;_score\u0026#34;: 1.0, \u0026#34;_source\u0026#34;: { \u0026#34;title\u0026#34;: \u0026#34;ä¸­å›½é©»æ´›æ‰çŸ¶é¢†äº‹é¦†é­äºšè£”ç”·å­æªå‡»ï¼Œå«ŒçŠ¯å·²è‡ªé¦–\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;http://news.ifeng.com/world/detail_2011_12/16/11372558_0.shtml\u0026#34;, \u0026#34;date\u0026#34;: \u0026#34;2011-12-18\u0026#34; } }, { \u0026#34;_index\u0026#34;: \u0026#34;news\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;politics\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;dU5G9mQBD9BuE5fdHOUj\u0026#34;, \u0026#34;_score\u0026#34;: 1.0, \u0026#34;_source\u0026#34;: { \u0026#34;title\u0026#34;: \u0026#34;ä¸­éŸ©æ¸”è­¦å†²çªè°ƒæŸ¥ï¼šéŸ©è­¦å¹³å‡æ¯å¤©æ‰£1è‰˜ä¸­å›½æ¸”èˆ¹\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://news.qq.com/a/20111216/001044.htm\u0026#34;, \u0026#34;date\u0026#34;: \u0026#34;2011-12-17\u0026#34; } }, { \u0026#34;_index\u0026#34;: \u0026#34;news\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;politics\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;dE5G9mQBD9BuE5fdHOUf\u0026#34;, \u0026#34;_score\u0026#34;: 1.0, \u0026#34;_source\u0026#34;: { \u0026#34;title\u0026#34;: \u0026#34;å…¬å®‰éƒ¨ï¼šå„åœ°æ ¡è½¦å°†äº«æœ€é«˜è·¯æƒ\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;http://www.chinanews.com/gn/2011/12-16/3536077.shtml\u0026#34;, \u0026#34;date\u0026#34;: \u0026#34;2011-12-16\u0026#34; } } ] } } è¿”å›ç»“æœä¼šå‡ºç°åœ¨ hits å­—æ®µé‡Œé¢ï¼Œç„¶åå…¶ä¸­æœ‰ total å­—æ®µæ ‡æ˜äº†æŸ¥è¯¢çš„ç»“æœæ¡ç›®æ•°ï¼Œè¿˜æœ‰ max_score ä»£è¡¨äº†æœ€å¤§åŒ¹é…åˆ†æ•°ã€‚ å…¨æ–‡æ£€ç´¢ï¼ŒElasticsearch æœç´¢å¼•æ“ç‰¹æ€§çš„åœ°æ–¹ï¼š dsl = { \u0026#39;query\u0026#39;: { \u0026#39;match\u0026#39;: { \u0026#39;title\u0026#39;: \u0026#39;ä¸­å›½ é¢†äº‹é¦†\u0026#39; } } } es = Elasticsearch() result = es.search(index=\u0026#39;news\u0026#39;, doc_type=\u0026#39;politics\u0026#39;, body=dsl) print(json.dumps(result, indent=2, ensure_ascii=False)) ä½¿ç”¨ Elasticsearch æ”¯æŒçš„ DSL è¯­å¥æ¥è¿›è¡ŒæŸ¥è¯¢ï¼Œä½¿ç”¨ match æŒ‡å®šå…¨æ–‡æ£€ç´¢ï¼Œæ£€ç´¢çš„å­—æ®µæ˜¯ titleï¼Œå†…å®¹æ˜¯â€œä¸­å›½é¢†äº‹é¦†â€ï¼Œæœç´¢ç»“æœå¦‚ä¸‹ï¼š { \u0026#34;took\u0026#34;: 1, \u0026#34;timed_out\u0026#34;: false, \u0026#34;_shards\u0026#34;: { \u0026#34;total\u0026#34;: 5, \u0026#34;successful\u0026#34;: 5, \u0026#34;skipped\u0026#34;: 0, \u0026#34;failed\u0026#34;: 0 }, \u0026#34;hits\u0026#34;: { \u0026#34;total\u0026#34;: 2, \u0026#34;max_score\u0026#34;: 2.546152, \u0026#34;hits\u0026#34;: [ { \u0026#34;_index\u0026#34;: \u0026#34;news\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;politics\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;dk5G9mQBD9BuE5fdHOUm\u0026#34;, \u0026#34;_score\u0026#34;: 2.546152, \u0026#34;_source\u0026#34;: { \u0026#34;title\u0026#34;: \u0026#34;ä¸­å›½é©»æ´›æ‰çŸ¶é¢†äº‹é¦†é­äºšè£”ç”·å­æªå‡»ï¼Œå«ŒçŠ¯å·²è‡ªé¦–\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;http://news.ifeng.com/world/detail_2011_12/16/11372558_0.shtml\u0026#34;, \u0026#34;date\u0026#34;: \u0026#34;2011-12-18\u0026#34; } }, { \u0026#34;_index\u0026#34;: \u0026#34;news\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;politics\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;dU5G9mQBD9BuE5fdHOUj\u0026#34;, \u0026#34;_score\u0026#34;: 0.2876821, \u0026#34;_source\u0026#34;: { \u0026#34;title\u0026#34;: \u0026#34;ä¸­éŸ©æ¸”è­¦å†²çªè°ƒæŸ¥ï¼šéŸ©è­¦å¹³å‡æ¯å¤©æ‰£1è‰˜ä¸­å›½æ¸”èˆ¹\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://news.qq.com/a/20111216/001044.htm\u0026#34;, \u0026#34;date\u0026#34;: \u0026#34;2011-12-17\u0026#34; } } ] } } åŒ¹é…çš„ç»“æœæœ‰ä¸¤æ¡ï¼Œç¬¬ä¸€æ¡çš„åˆ†æ•°ä¸º 2.54ï¼Œç¬¬äºŒæ¡çš„åˆ†æ•°ä¸º 0.28ï¼Œè¿™æ˜¯å› ä¸ºç¬¬ä¸€æ¡åŒ¹é…çš„æ•°æ®ä¸­å«æœ‰â€œä¸­å›½â€å’Œâ€œé¢†äº‹é¦†â€ä¸¤ä¸ªè¯ï¼Œç¬¬äºŒæ¡åŒ¹é…çš„æ•°æ®ä¸­ä¸åŒ…å«â€œé¢†äº‹é¦†â€ï¼Œä½†æ˜¯åŒ…å«äº†â€œä¸­å›½â€è¿™ä¸ªè¯ï¼Œæ‰€ä»¥ä¹Ÿè¢«æ£€ç´¢å‡ºæ¥äº†ï¼Œä½†æ˜¯åˆ†æ•°æ¯”è¾ƒä½ã€‚ æ£€ç´¢æ—¶ä¼šå¯¹å¯¹åº”çš„å­—æ®µå…¨æ–‡æ£€ç´¢ï¼Œç»“æœè¿˜ä¼šæŒ‰ç…§æ£€ç´¢å…³é”®è¯çš„ç›¸å…³æ€§è¿›è¡Œæ’åºï¼Œè¿™å°±æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æœç´¢å¼•æ“é›å½¢ã€‚ Elasticsearch æ”¯æŒéå¸¸å¤šçš„æŸ¥è¯¢æ–¹å¼ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒ å®˜æ–¹æ–‡æ¡£ ","permalink":"https://www.chenzqi.cn/posts/2019/20190610_elasticsearch%E4%BB%8B%E7%BB%8D%E4%B8%8Epython%E5%AE%9E%E7%8E%B0/","tags":["web","python"],"title":"Elasticsearchä»‹ç»ä¸Pythonå®ç°"},{"categories":[2019,"æŠ€æœ¯"],"contents":":::tip Dockerfile å‘½ä»¤ ::: Dockerfile æŒ‡ä»¤è¯¦è§£ 1 FROM æŒ‡å®šåŸºç¡€é•œåƒ FROM æŒ‡ä»¤ç”¨äºæŒ‡å®šå…¶åæ„å»ºæ–°é•œåƒæ‰€ä½¿ç”¨çš„åŸºç¡€é•œåƒã€‚FROM æŒ‡ä»¤å¿…æ˜¯ Dockerfile æ–‡ä»¶ä¸­çš„é¦–æ¡å‘½ä»¤ï¼Œå¯åŠ¨æ„å»ºæµç¨‹åï¼ŒDocker å°†ä¼šåŸºäºè¯¥é•œåƒæ„å»ºæ–°é•œåƒï¼ŒFROM åçš„å‘½ä»¤ä¹Ÿä¼šåŸºäºè¿™ä¸ªåŸºç¡€é•œåƒã€‚ FROMè¯­æ³•æ ¼å¼ä¸ºï¼š FROM \u0026lt;image\u0026gt;\rOR\rFROM \u0026lt;image\u0026gt;:\u0026lt;tag\u0026gt;\rOR\rFROM \u0026lt;image\u0026gt;:\u0026lt;digest\u0026gt; é€šè¿‡ FROM æŒ‡å®šçš„é•œåƒï¼Œå¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„åŸºç¡€é•œåƒã€‚FROM æœ‰ä»¥ä¸‹é™åˆ¶ï¼š FROM å¿…é¡» æ˜¯ Dockerfile ä¸­ç¬¬ä¸€æ¡éæ³¨é‡Šå‘½ä»¤ åœ¨ä¸€ä¸ª Dockerfile æ–‡ä»¶ä¸­åˆ›å»ºå¤šä¸ªé•œåƒæ—¶ï¼ŒFROM å¯ä»¥å¤šæ¬¡å‡ºç°ã€‚åªéœ€åœ¨æ¯ä¸ªæ–°å‘½ä»¤ FROM ä¹‹å‰ï¼Œè®°å½•æäº¤ä¸Šæ¬¡çš„é•œåƒ IDã€‚ tag æˆ– digest æ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸ä½¿ç”¨è¿™ä¸¤ä¸ªå€¼æ—¶ï¼Œä¼šä½¿ç”¨ latest ç‰ˆæœ¬çš„åŸºç¡€é•œåƒ 2 RUN æ‰§è¡Œå‘½ä»¤ åœ¨é•œåƒçš„æ„å»ºè¿‡ç¨‹ä¸­æ‰§è¡Œç‰¹å®šçš„å‘½ä»¤ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªä¸­é—´é•œåƒã€‚æ ¼å¼: # shellæ ¼å¼ RUN \u0026lt;command\u0026gt; # execæ ¼å¼ RUN [\u0026#34;executable\u0026#34;, \u0026#34;param1\u0026#34;, \u0026#34;param2\u0026#34;] RUN å‘½ä»¤å°†åœ¨å½“å‰ image ä¸­æ‰§è¡Œä»»æ„åˆæ³•å‘½ä»¤å¹¶æäº¤æ‰§è¡Œç»“æœã€‚å‘½ä»¤æ‰§è¡Œæäº¤åï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡Œ Dockerfile ä¸­çš„ä¸‹ä¸€ä¸ªæŒ‡ä»¤ã€‚ å±‚çº§ RUN æŒ‡ä»¤å’Œç”Ÿæˆæäº¤æ˜¯ç¬¦åˆ Docker æ ¸å¿ƒç†å¿µçš„åšæ³•ã€‚å®ƒå…è®¸åƒç‰ˆæœ¬æ§åˆ¶é‚£æ ·ï¼Œåœ¨ä»»æ„ä¸€ä¸ªç‚¹ï¼Œå¯¹ image é•œåƒè¿›è¡Œå®šåˆ¶åŒ–æ„å»ºã€‚ RUN æŒ‡ä»¤åˆ›å»ºçš„ä¸­é—´é•œåƒä¼šè¢«ç¼“å­˜ï¼Œå¹¶ä¼šåœ¨ä¸‹æ¬¡æ„å»ºä¸­ä½¿ç”¨ã€‚å¦‚æœä¸æƒ³ä½¿ç”¨è¿™äº›ç¼“å­˜é•œåƒï¼Œå¯ä»¥åœ¨æ„å»ºæ—¶æŒ‡å®š \u0026ndash;no-cache å‚æ•°ï¼Œå¦‚ï¼šdocker build \u0026ndash;no-cacheã€‚ 3 COPY å¤åˆ¶æ–‡ä»¶ æ ¼å¼ï¼š COPY \u0026lt;æºè·¯å¾„\u0026gt;... \u0026lt;ç›®æ ‡è·¯å¾„\u0026gt; COPY [\u0026#34;\u0026lt;æºè·¯å¾„1\u0026gt;\u0026#34;,... \u0026#34;\u0026lt;ç›®æ ‡è·¯å¾„\u0026gt;\u0026#34;] å’Œ RUN æŒ‡ä»¤ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸¤ç§æ ¼å¼ï¼Œä¸€ç§ç±»ä¼¼äºå‘½ä»¤è¡Œï¼Œä¸€ç§ç±»ä¼¼äºå‡½æ•°è°ƒç”¨ã€‚COPY æŒ‡ä»¤å°†ä»æ„å»ºä¸Šä¸‹æ–‡ç›®å½•ä¸­ \u0026lt;æºè·¯å¾„\u0026gt; çš„æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°æ–°çš„ä¸€å±‚çš„é•œåƒå†…çš„\u0026lt;ç›®æ ‡è·¯å¾„\u0026gt;ä½ç½®ã€‚æ¯”å¦‚ï¼š COPY package.json /usr/src/app/ \u0026lt;æºè·¯å¾„\u0026gt;å¯ä»¥æ˜¯å¤šä¸ªï¼Œç”šè‡³å¯ä»¥æ˜¯é€šé…ç¬¦ï¼Œå…¶é€šé…ç¬¦è§„åˆ™è¦æ»¡è¶³ Go çš„ filepath.Match è§„åˆ™ï¼Œå¦‚ï¼š COPY hom* /mydir/ COPY hom?.txt /mydir/ \u0026lt;ç›®æ ‡è·¯å¾„\u0026gt;å¯ä»¥æ˜¯å®¹å™¨å†…çš„ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹äºå·¥ä½œç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼ˆå·¥ä½œç›®å½•å¯ä»¥ç”¨ WORKDIR æŒ‡ä»¤æ¥æŒ‡å®šï¼‰ã€‚ç›®æ ‡è·¯å¾„ä¸éœ€è¦äº‹å…ˆåˆ›å»ºï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨ä¼šåœ¨å¤åˆ¶æ–‡ä»¶å‰å…ˆè¡Œåˆ›å»ºç¼ºå¤±ç›®å½•ã€‚ æ­¤å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œä½¿ç”¨ COPY æŒ‡ä»¤ï¼Œæºæ–‡ä»¶çš„å„ç§å…ƒæ•°æ®éƒ½ä¼šä¿ç•™ã€‚æ¯”å¦‚è¯»ã€å†™ã€æ‰§è¡Œæƒé™ã€æ–‡ä»¶å˜æ›´æ—¶é—´ç­‰ã€‚è¿™ä¸ªç‰¹æ€§å¯¹äºé•œåƒå®šåˆ¶å¾ˆæœ‰ç”¨ã€‚ç‰¹åˆ«æ˜¯æ„å»ºç›¸å…³æ–‡ä»¶éƒ½åœ¨ä½¿ç”¨ Git è¿›è¡Œç®¡ç†çš„æ—¶å€™ã€‚ 4 ADD æ›´é«˜çº§çš„å¤åˆ¶æ–‡ä»¶ ADD æŒ‡ä»¤å’Œ COPY çš„æ ¼å¼å’Œæ€§è´¨åŸºæœ¬ä¸€è‡´ã€‚ä½†æ˜¯åœ¨ COPY åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›åŠŸèƒ½ã€‚æ¯”å¦‚\u0026lt;æºè·¯å¾„\u0026gt;å¯ä»¥æ˜¯ä¸€ä¸ª URLï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒDocker å¼•æ“ä¼šè¯•å›¾å»ä¸‹è½½è¿™ä¸ªé“¾æ¥çš„æ–‡ä»¶æ”¾åˆ°\u0026lt;ç›®æ ‡è·¯å¾„\u0026gt;å»ã€‚ åœ¨æ„å»ºé•œåƒæ—¶ï¼Œå¤åˆ¶ä¸Šä¸‹æ–‡ä¸­çš„æ–‡ä»¶åˆ°é•œåƒå†…ï¼Œæ ¼å¼ï¼š ADD \u0026lt;æºè·¯å¾„\u0026gt;... \u0026lt;ç›®æ ‡è·¯å¾„\u0026gt; ADD [\u0026#34;\u0026lt;æºè·¯å¾„\u0026gt;\u0026#34;,... \u0026#34;\u0026lt;ç›®æ ‡è·¯å¾„\u0026gt;\u0026#34;] æ³¨æ„ å¦‚æœ docker å‘ç°æ–‡ä»¶å†…å®¹è¢«æ”¹å˜ï¼Œåˆ™æ¥ä¸‹æ¥çš„æŒ‡ä»¤éƒ½ä¸ä¼šå†ä½¿ç”¨ç¼“å­˜ã€‚å…³äºå¤åˆ¶æ–‡ä»¶æ—¶éœ€è¦å¤„ç†çš„/ï¼ŒåŸºæœ¬è·Ÿæ­£å¸¸çš„ copy ä¸€è‡´ 5 ENV è®¾ç½®ç¯å¢ƒå˜é‡ æ ¼å¼æœ‰ä¸¤ç§ï¼š ENV \u0026lt;key\u0026gt; \u0026lt;value\u0026gt; ENV \u0026lt;key1\u0026gt;=\u0026lt;value1\u0026gt; \u0026lt;key2\u0026gt;=\u0026lt;value2\u0026gt;... è¿™ä¸ªæŒ‡ä»¤å¾ˆç®€å•ï¼Œå°±æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡è€Œå·²ï¼Œæ— è®ºæ˜¯åé¢çš„å…¶å®ƒæŒ‡ä»¤ï¼Œå¦‚ RUNï¼Œè¿˜æ˜¯è¿è¡Œæ—¶çš„åº”ç”¨ï¼Œéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™é‡Œå®šä¹‰çš„ç¯å¢ƒå˜é‡ã€‚ ENV VERSION=1.0 DEBUG=on \\ NAME=\u0026#34;Happy Feet\u0026#34; è¿™ä¸ªä¾‹å­ä¸­æ¼”ç¤ºäº†å¦‚ä½•æ¢è¡Œï¼Œä»¥åŠå¯¹å«æœ‰ç©ºæ ¼çš„å€¼ç”¨åŒå¼•å·æ‹¬èµ·æ¥çš„åŠæ³•ï¼Œè¿™å’Œ Shell ä¸‹çš„è¡Œä¸ºæ˜¯ä¸€è‡´çš„ã€‚ 6 EXPOSE ä¸ºæ„å»ºçš„é•œåƒè®¾ç½®ç›‘å¬ç«¯å£ï¼Œä½¿å®¹å™¨åœ¨è¿è¡Œæ—¶ç›‘å¬ã€‚æ ¼å¼ï¼š EXPOSE \u0026lt;port\u0026gt; [\u0026lt;port\u0026gt;...] EXPOSE æŒ‡ä»¤å¹¶ä¸ä¼šè®©å®¹å™¨ç›‘å¬ host çš„ç«¯å£ï¼Œå¦‚æœéœ€è¦ï¼Œéœ€è¦åœ¨ docker run æ—¶ä½¿ç”¨ -pã€-P å‚æ•°æ¥å‘å¸ƒå®¹å™¨ç«¯å£åˆ° host çš„æŸä¸ªç«¯å£ä¸Šã€‚ 7 VOLUME å®šä¹‰åŒ¿åå· VOLUMEç”¨äºåˆ›å»ºæŒ‚è½½ç‚¹ï¼Œå³å‘åŸºäºæ‰€æ„å»ºé•œåƒåˆ›å§‹çš„å®¹å™¨æ·»åŠ å·ï¼š VOLUME [\u0026#34;/data\u0026#34;] ä¸€ä¸ªå·å¯ä»¥å­˜åœ¨äºä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨çš„æŒ‡å®šç›®å½•ï¼Œè¯¥ç›®å½•å¯ä»¥ç»•è¿‡è”åˆæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶å…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š å·å¯ä»¥å®¹å™¨é—´å…±äº«å’Œé‡ç”¨ å®¹å™¨å¹¶ä¸ä¸€å®šè¦å’Œå…¶å®ƒå®¹å™¨å…±äº«å· ä¿®æ”¹å·åä¼šç«‹å³ç”Ÿæ•ˆ å¯¹å·çš„ä¿®æ”¹ä¸ä¼šå¯¹é•œåƒäº§ç”Ÿå½±å“ å·ä¼šä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•å®¹å™¨åœ¨ä½¿ç”¨å®ƒ VOLUME è®©æˆ‘ä»¬å¯ä»¥å°†æºä»£ç ã€æ•°æ®æˆ–å…¶å®ƒå†…å®¹æ·»åŠ åˆ°é•œåƒä¸­ï¼Œè€Œåˆä¸å¹¶æäº¤åˆ°é•œåƒä¸­ï¼Œå¹¶ä½¿æˆ‘ä»¬å¯ä»¥å¤šä¸ªå®¹å™¨é—´å…±äº«è¿™äº›å†…å®¹ã€‚ 8 WORKDIR æŒ‡å®šå·¥ä½œç›®å½• WORKDIRç”¨äºåœ¨å®¹å™¨å†…è®¾ç½®ä¸€ä¸ªå·¥ä½œç›®å½•ï¼š WORKDIR /path/to/workdir é€šè¿‡WORKDIRè®¾ç½®å·¥ä½œç›®å½•åï¼ŒDockerfile ä¸­å…¶åçš„å‘½ä»¤ RUNã€CMDã€ENTRYPOINTã€ADDã€COPY ç­‰å‘½ä»¤éƒ½ä¼šåœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œã€‚ å¦‚ï¼Œä½¿ç”¨WORKDIRè®¾ç½®å·¥ä½œç›®å½•ï¼š WORKDIR /a WORKDIR b WORKDIR c RUN pwd åœ¨ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œpwd æœ€ç»ˆå°†ä¼šåœ¨ /a/b/c ç›®å½•ä¸­æ‰§è¡Œã€‚åœ¨ä½¿ç”¨ docker run è¿è¡Œå®¹å™¨æ—¶ï¼Œå¯ä»¥é€šè¿‡-wå‚æ•°è¦†ç›–æ„å»ºæ—¶æ‰€è®¾ç½®çš„å·¥ä½œç›®å½•ã€‚ 9 USER æŒ‡å®šå½“å‰ç”¨æˆ· USER ç”¨äºæŒ‡å®šè¿è¡Œé•œåƒæ‰€ä½¿ç”¨çš„ç”¨æˆ·ï¼š USER daemon ä½¿ç”¨USERæŒ‡å®šç”¨æˆ·æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç”¨æˆ·åã€UID æˆ– GIDï¼Œæˆ–æ˜¯ä¸¤è€…çš„ç»„åˆã€‚ä»¥ä¸‹éƒ½æ˜¯åˆæ³•çš„æŒ‡å®šè¯•ï¼š USER user\rUSER user:group\rUSER uid\rUSER uid:gid\rUSER user:gid\rUSER uid:group ä½¿ç”¨USERæŒ‡å®šç”¨æˆ·åï¼ŒDockerfile ä¸­å…¶åçš„å‘½ä»¤ RUNã€CMDã€ENTRYPOINT éƒ½å°†ä½¿ç”¨è¯¥ç”¨æˆ·ã€‚ é•œåƒæ„å»ºå®Œæˆåï¼Œé€šè¿‡ docker run è¿è¡Œå®¹å™¨æ—¶ï¼Œå¯ä»¥é€šè¿‡ -u å‚æ•°æ¥è¦†ç›–æ‰€æŒ‡å®šçš„ç”¨æˆ·ã€‚ 10 CMD CMDç”¨äºæŒ‡å®šåœ¨å®¹å™¨å¯åŠ¨æ—¶æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚CMD æœ‰ä»¥ä¸‹ä¸‰ç§æ ¼å¼ï¼š CMD [\u0026#34;executable\u0026#34;,\u0026#34;param1\u0026#34;,\u0026#34;param2\u0026#34;] CMD [\u0026#34;param1\u0026#34;,\u0026#34;param2\u0026#34;] CMD command param1 param2 çœç•¥å¯æ‰§è¡Œæ–‡ä»¶çš„ exec æ ¼å¼ï¼Œè¿™ç§å†™æ³•ä½¿ CMD ä¸­çš„å‚æ•°å½“åš ENTRYPOINT çš„é»˜è®¤å‚æ•°ï¼Œæ­¤æ—¶ ENTRYPOINT ä¹Ÿåº”è¯¥æ˜¯ exec æ ¼å¼ï¼Œå…·ä½“ä¸ ENTRYPOINT çš„ç»„åˆä½¿ç”¨ï¼Œå‚è€ƒ ENTRYPOINTã€‚ æ³¨æ„ä¸ RUN æŒ‡ä»¤çš„åŒºåˆ«ï¼š RUN åœ¨æ„å»ºçš„æ—¶å€™æ‰§è¡Œï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªæ–°çš„é•œåƒï¼ŒCMD åœ¨å®¹å™¨è¿è¡Œçš„æ—¶å€™æ‰§è¡Œï¼Œåœ¨æ„å»ºæ—¶ä¸è¿›è¡Œä»»ä½•æ“ä½œã€‚ 11 ENTRYPOINT ENTRYPOINT ç”¨äºç»™å®¹å™¨é…ç½®ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡ä½¿ç”¨é•œåƒåˆ›å»ºå®¹å™¨æ—¶ï¼Œé€šè¿‡ ENTRYPOINT æŒ‡å®šçš„ç¨‹åºéƒ½ä¼šè¢«è®¾ç½®ä¸ºé»˜è®¤ç¨‹åºã€‚ENTRYPOINT æœ‰ä»¥ä¸‹ä¸¤ç§å½¢å¼ï¼š ENTRYPOINT [\u0026#34;executable\u0026#34;, \u0026#34;param1\u0026#34;, \u0026#34;param2\u0026#34;] ENTRYPOINT command param1 param2 ENTRYPOINT ä¸ CMD éå¸¸ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯é€šè¿‡docker runæ‰§è¡Œçš„å‘½ä»¤ä¸ä¼šè¦†ç›– ENTRYPOINTï¼Œè€Œdocker runå‘½ä»¤ä¸­æŒ‡å®šçš„ä»»ä½•å‚æ•°ï¼Œéƒ½ä¼šè¢«å½“åšå‚æ•°å†æ¬¡ä¼ é€’ç»™ ENTRYPOINTã€‚ Dockerfile ä¸­åªå…è®¸æœ‰ä¸€ä¸ª ENTRYPOINT å‘½ä»¤ï¼Œå¤šæŒ‡å®šæ—¶ä¼šè¦†ç›–å‰é¢çš„è®¾ç½®ï¼Œè€Œåªæ‰§è¡Œæœ€åçš„ ENTRYPOINT æŒ‡ä»¤ã€‚ docker runè¿è¡Œå®¹å™¨æ—¶æŒ‡å®šçš„å‚æ•°éƒ½ä¼šè¢«ä¼ é€’ç»™ ENTRYPOINT ï¼Œä¸”ä¼šè¦†ç›– CMD å‘½ä»¤æŒ‡å®šçš„å‚æ•°ã€‚ å¦‚ï¼Œæ‰§è¡Œdocker run \u0026lt;image\u0026gt; -dæ—¶ï¼Œ-d å‚æ•°å°†è¢«ä¼ é€’ç»™å…¥å£ç‚¹ã€‚ ä¹Ÿå¯ä»¥é€šè¿‡docker run --entrypointé‡å†™ ENTRYPOINT å…¥å£ç‚¹ã€‚ å¦‚ï¼šå¯ä»¥åƒä¸‹é¢è¿™æ ·æŒ‡å®šä¸€ä¸ªå®¹å™¨æ‰§è¡Œç¨‹åºï¼š ENTRYPOINT [\u0026#34;/usr/bin/nginx\u0026#34;] å®Œæ•´æ„å»ºä»£ç ï¼š # Version: 0.0.3 FROM ubuntu:16.04 MAINTAINER ä½•æ°‘ä¸‰ \u0026#34;cn.liuht@gmail.com\u0026#34; RUN apt-get update RUN apt-get install -y nginx RUN echo \u0026#39;Hello World, æˆ‘æ˜¯ä¸ªå®¹å™¨\u0026#39; \\ \u0026gt; /var/www/html/index.html ENTRYPOINT [\u0026#34;/usr/sbin/nginx\u0026#34;] EXPOSE 80 ä½¿ç”¨docker buildæ„å»ºé•œåƒï¼Œå¹¶å°†é•œåƒæŒ‡å®šä¸º itbilu/testï¼š docker build -t=\u0026#34;itbilu/test\u0026#34; . æ„å»ºå®Œæˆåï¼Œä½¿ç”¨itbilu/testå¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼š docker run -i -t itbilu/test -g \u0026#34;daemon off;\u0026#34; åœ¨è¿è¡Œå®¹å™¨æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† -g \u0026ldquo;daemon off;\u0026quot;ï¼Œè¿™ä¸ªå‚æ•°å°†ä¼šè¢«ä¼ é€’ç»™ ENTRYPOINTï¼Œæœ€ç»ˆåœ¨å®¹å™¨ä¸­æ‰§è¡Œçš„å‘½ä»¤ä¸º /usr/sbin/nginx -g \u0026ldquo;daemon off;\u0026quot;ã€‚ 12 LABEL LABELç”¨äºä¸ºé•œåƒæ·»åŠ å…ƒæ•°æ®ï¼Œå…ƒæ•°ä»¥é”®å€¼å¯¹çš„å½¢å¼æŒ‡å®šï¼š LABEL \u0026lt;key\u0026gt;=\u0026lt;value\u0026gt; \u0026lt;key\u0026gt;=\u0026lt;value\u0026gt; \u0026lt;key\u0026gt;=\u0026lt;value\u0026gt; ... ä½¿ç”¨LABELæŒ‡å®šå…ƒæ•°æ®æ—¶ï¼Œä¸€æ¡LABELæŒ‡å®šå¯ä»¥æŒ‡å®šä¸€æˆ–å¤šæ¡å…ƒæ•°æ®ï¼ŒæŒ‡å®šå¤šæ¡å…ƒæ•°æ®æ—¶ä¸åŒå…ƒæ•°æ®ä¹‹é—´é€šè¿‡ç©ºæ ¼åˆ†éš”ã€‚æ¨èå°†æ‰€æœ‰çš„å…ƒæ•°æ®é€šè¿‡ä¸€æ¡LABELæŒ‡ä»¤æŒ‡å®šï¼Œä»¥å…ç”Ÿæˆè¿‡å¤šçš„ä¸­é—´é•œåƒã€‚ å¦‚ï¼Œé€šè¿‡LABELæŒ‡å®šä¸€äº›å…ƒæ•°æ®ï¼š LABEL version=\u0026#34;1.0\u0026#34; description=\u0026#34;è¿™æ˜¯ä¸€ä¸ªWebæœåŠ¡å™¨\u0026#34; by=\u0026#34;ITç¬”å½•\u0026#34; æŒ‡å®šåå¯ä»¥é€šè¿‡docker inspectæŸ¥çœ‹ï¼š docker inspect itbilu/test \u0026#34;Labels\u0026#34;: { \u0026#34;version\u0026#34;: \u0026#34;1.0\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;è¿™æ˜¯ä¸€ä¸ªWebæœåŠ¡å™¨\u0026#34;, \u0026#34;by\u0026#34;: \u0026#34;ITç¬”å½•\u0026#34; }, 13 ARG ARGç”¨äºæŒ‡å®šä¼ é€’ç»™æ„å»ºè¿è¡Œæ—¶çš„å˜é‡ï¼š ARG \u0026lt;name\u0026gt;[=\u0026lt;default value\u0026gt;] å¦‚ï¼Œé€šè¿‡ARGæŒ‡å®šä¸¤ä¸ªå˜é‡ï¼š ARG site\rARG build_user=ITç¬”å½• ä»¥ä¸Šæˆ‘ä»¬æŒ‡å®šäº† site å’Œ build_user ä¸¤ä¸ªå˜é‡ï¼Œå…¶ä¸­ build_user æŒ‡å®šäº†é»˜è®¤å€¼ã€‚åœ¨ä½¿ç”¨ docker build æ„å»ºé•œåƒæ—¶ï¼Œå¯ä»¥é€šè¿‡ \u0026ndash;build-arg = å‚æ•°æ¥æŒ‡å®šæˆ–é‡è®¾ç½®è¿™äº›å˜é‡çš„å€¼ã€‚ docker build --build-arg site=itiblu.com -t itbilu/test . è¿™æ ·æˆ‘ä»¬æ„å»ºäº† itbilu/test é•œåƒï¼Œå…¶ä¸­siteä¼šè¢«è®¾ç½®ä¸º itbilu.comï¼Œç”±äºæ²¡æœ‰æŒ‡å®š build_userï¼Œå…¶å€¼å°†æ˜¯é»˜è®¤å€¼ IT ç¬”å½•ã€‚ 14 ONBUILD ONBUILDç”¨äºè®¾ç½®é•œåƒè§¦å‘å™¨ï¼š ONBUILD [INSTRUCTION] å½“æ‰€æ„å»ºçš„é•œåƒè¢«ç”¨åšå…¶å®ƒé•œåƒçš„åŸºç¡€é•œåƒï¼Œè¯¥é•œåƒä¸­çš„è§¦å‘å™¨å°†ä¼šè¢«é’¥è§¦å‘ã€‚ å¦‚ï¼Œå½“é•œåƒè¢«ä½¿ç”¨æ—¶ï¼Œå¯èƒ½éœ€è¦åšä¸€äº›å¤„ç†ï¼š [...]\rONBUILD ADD . /app/src\rONBUILD RUN /usr/local/bin/python-build --dir /app/src\r[...] 15 STOPSIGNAL STOPSIGNALç”¨äºè®¾ç½®åœæ­¢å®¹å™¨æ‰€è¦å‘é€çš„ç³»ç»Ÿè°ƒç”¨ä¿¡å·ï¼š STOPSIGNAL signal æ‰€ä½¿ç”¨çš„ä¿¡å·å¿…é¡»æ˜¯å†…æ ¸ç³»ç»Ÿè°ƒç”¨è¡¨ä¸­çš„åˆæ³•çš„å€¼ï¼Œå¦‚ï¼šSIGKILLã€‚ 16 SHELL SHELLç”¨äºè®¾ç½®æ‰§è¡Œå‘½ä»¤ï¼ˆshellå¼ï¼‰æ‰€ä½¿ç”¨çš„çš„é»˜è®¤ shell ç±»å‹ï¼š SHELL [\u0026#34;executable\u0026#34;, \u0026#34;parameters\u0026#34;] SHELLåœ¨Windowsç¯å¢ƒä¸‹æ¯”è¾ƒæœ‰ç”¨ï¼ŒWindows ä¸‹é€šå¸¸ä¼šæœ‰ cmd å’Œ powershell ä¸¤ç§ shellï¼Œå¯èƒ½è¿˜ä¼šæœ‰ shã€‚è¿™æ—¶å°±å¯ä»¥é€šè¿‡ SHELL æ¥æŒ‡å®šæ‰€ä½¿ç”¨çš„ shell ç±»å‹ï¼š FROM microsoft/windowsservercore\r# Executed as cmd /S /C echo default\rRUN echo default\r# Executed as cmd /S /C powershell -command Write-Host default\rRUN powershell -command Write-Host default\r# Executed as powershell -command Write-Host hello\rSHELL [\u0026#34;powershell\u0026#34;, \u0026#34;-command\u0026#34;]\rRUN Write-Host hello\r# Executed as cmd /S /C echo hello\rSHELL [\u0026#34;cmd\u0026#34;, \u0026#34;/S\u0026#34;\u0026#34;, \u0026#34;/C\u0026#34;]\rRUN echo hello Dockerfile ç¤ºä¾‹ æ„å»ºNginxè¿è¡Œç¯å¢ƒ # æŒ‡å®šåŸºç¡€é•œåƒ\rFROM sameersbn/ubuntu:14.04.20161014\r# ç»´æŠ¤è€…ä¿¡æ¯\rMAINTAINER sameer@damagehead.com\r# è®¾ç½®ç¯å¢ƒ\rENV RTMP_VERSION=1.1.10 \\\rNPS_VERSION=1.11.33.4 \\\rLIBAV_VERSION=11.8 \\\rNGINX_VERSION=1.10.1 \\\rNGINX_USER=www-data \\\rNGINX_SITECONF_DIR=/etc/nginx/sites-enabled \\\rNGINX_LOG_DIR=/var/log/nginx \\\rNGINX_TEMP_DIR=/var/lib/nginx \\\rNGINX_SETUP_DIR=/var/cache/nginx\r# è®¾ç½®æ„å»ºæ—¶å˜é‡ï¼Œé•œåƒå»ºç«‹å®Œæˆåå°±å¤±æ•ˆ\rARG BUILD_LIBAV=false\rARG WITH_DEBUG=false\rARG WITH_PAGESPEED=true\rARG WITH_RTMP=true\r# å¤åˆ¶æœ¬åœ°æ–‡ä»¶åˆ°å®¹å™¨ç›®å½•ä¸­\rCOPY setup/ ${NGINX_SETUP_DIR}/\rRUN bash ${NGINX_SETUP_DIR}/install.sh\r# å¤åˆ¶æœ¬åœ°é…ç½®æ–‡ä»¶åˆ°å®¹å™¨ç›®å½•ä¸­\rCOPY nginx.conf /etc/nginx/nginx.conf\rCOPY entrypoint.sh /sbin/entrypoint.sh\r# è¿è¡ŒæŒ‡ä»¤\rRUN chmod 755 /sbin/entrypoint.sh\r# å…è®¸æŒ‡å®šçš„ç«¯å£\rEXPOSE 80/tcp 443/tcp 1935/tcp\r# æŒ‡å®šç½‘ç«™ç›®å½•æŒ‚è½½ç‚¹\rVOLUME [\u0026#34;${NGINX_SITECONF_DIR}\u0026#34;]\rENTRYPOINT [\u0026#34;/sbin/entrypoint.sh\u0026#34;]\rCMD [\u0026#34;/usr/sbin/nginx\u0026#34;] æ„å»ºtomcat ç¯å¢ƒ # æŒ‡å®šåŸºäºçš„åŸºç¡€é•œåƒ\rFROM ubuntu:13.10 # ç»´æŠ¤è€…ä¿¡æ¯\rMAINTAINER zhangjiayang \u0026#34;zhangjiayang@sczq.com.cn\u0026#34; # é•œåƒçš„æŒ‡ä»¤æ“ä½œ\r# è·å–APTæ›´æ–°çš„èµ„æºåˆ—è¡¨\rRUN echo \u0026#34;deb http://archive.ubuntu.com/ubuntu precise main universe\u0026#34;\u0026gt; /etc/apt/sources.list\r# æ›´æ–°è½¯ä»¶\rRUN apt-get update # Install curl RUN apt-get -y install curl # Install JDK 7 RUN cd /tmp \u0026amp;\u0026amp; curl -L \u0026#39;http://download.oracle.com/otn-pub/java/jdk/7u65-b17/jdk-7u65-linux-x64.tar.gz\u0026#39; -H \u0026#39;Cookie: oraclelicense=accept-securebackup-cookie; gpw_e24=Dockerfile\u0026#39; | tar -xz RUN mkdir -p /usr/lib/jvm RUN mv /tmp/jdk1.7.0_65/ /usr/lib/jvm/java-7-oracle/ # Set Oracle JDK 7 as default Java RUN update-alternatives --install /usr/bin/java java /usr/lib/jvm/java-7-oracle/bin/java 300 RUN update-alternatives --install /usr/bin/javac javac /usr/lib/jvm/java-7-oracle/bin/javac 300 # è®¾ç½®ç³»ç»Ÿç¯å¢ƒ\rENV JAVA_HOME /usr/lib/jvm/java-7-oracle/ # Install tomcat7 RUN cd /tmp \u0026amp;\u0026amp; curl -L \u0026#39;http://archive.apache.org/dist/tomcat/tomcat-7/v7.0.8/bin/apache-tomcat-7.0.8.tar.gz\u0026#39; | tar -xz RUN mv /tmp/apache-tomcat-7.0.8/ /opt/tomcat7/ ENV CATALINA_HOME /opt/tomcat7 ENV PATH $PATH:$CATALINA_HOME/bin # å¤ä»¶tomcat7.shåˆ°å®¹å™¨ä¸­çš„ç›®å½• ADD tomcat7.sh /etc/init.d/tomcat7 RUN chmod 755 /etc/init.d/tomcat7 # Expose ports. æŒ‡å®šæš´éœ²çš„ç«¯å£\rEXPOSE 8080 # Define default command. ENTRYPOINT service tomcat7 start \u0026amp;\u0026amp; tail -f /opt/tomcat7/logs/catalina.out ç»“å°¾ å®¹å™¨è½»é‡åŒ–ã€‚ä»é•œåƒä¸­äº§ç”Ÿçš„å®¹å™¨åº”è¯¥å°½é‡è½»é‡åŒ–ï¼Œèƒ½åœ¨è¶³å¤ŸçŸ­çš„æ—¶é—´å†…åœæ­¢ã€é”€æ¯ã€é‡æ–°ç”Ÿæˆå¹¶æ›¿æ¢åŸæ¥çš„å®¹å™¨ã€‚ ä½¿ç”¨ .gitignoreã€‚åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒDockerfile ä¼šå’Œæ„å»ºæ‰€éœ€çš„æ–‡ä»¶æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸­ï¼Œä¸ºäº†æé«˜æ„å»ºçš„æ€§èƒ½ï¼Œåº”è¯¥ä½¿ç”¨ .gitignore æ¥è¿‡æ»¤æ‰ä¸éœ€è¦çš„æ–‡ä»¶å’Œç›®å½•ã€‚ ä¸ºäº†å‡å°‘é•œåƒçš„å¤§å°ï¼Œå‡å°‘ä¾èµ–ï¼Œä»…å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…ã€‚ ä¸€ä¸ªå®¹å™¨åªåšä¸€ä»¶äº‹ã€‚è§£è€¦å¤æ‚çš„åº”ç”¨ï¼Œåˆ†æˆå¤šä¸ªå®¹å™¨ï¼Œè€Œä¸æ˜¯æ‰€æœ‰ä¸œè¥¿éƒ½æ”¾åœ¨ä¸€ä¸ªå®¹å™¨å†…è¿è¡Œã€‚å¦‚ä¸€ä¸ª Python Web åº”ç”¨ï¼Œå¯èƒ½éœ€è¦ Serverã€DBã€Cacheã€MQã€Log ç­‰å‡ ä¸ªå®¹å™¨ã€‚ä¸€ä¸ªæ›´åŠ æç«¯çš„è¯´æ³•ï¼šOne process per containerã€‚ å‡å°‘é•œåƒçš„å›¾å±‚ã€‚ä¸è¦å¤šä¸ª Labelã€ENV ç­‰æ ‡ç­¾ã€‚ å¯¹ç»­è¡Œçš„å‚æ•°æŒ‰ç…§å­—æ¯è¡¨æ’åºï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨apt-get install -yå®‰è£…åŒ…çš„æ—¶å€™ã€‚ ä½¿ç”¨æ„å»ºç¼“å­˜ã€‚å¦‚æœä¸æƒ³ä½¿ç”¨ç¼“å­˜ï¼Œå¯ä»¥åœ¨æ„å»ºçš„æ—¶å€™ä½¿ç”¨å‚æ•°\u0026ndash;no-cache=trueæ¥å¼ºåˆ¶é‡æ–°ç”Ÿæˆä¸­é—´é•œåƒã€‚ ","permalink":"https://www.chenzqi.cn/posts/2019/20190605_dockerfile-%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/","tags":["Docker","è®°å½•"],"title":"Dockerfile å‘½ä»¤è®°å½•"},{"categories":[2019,"æŠ€æœ¯"],"contents":"å‡†å¤‡å·¥ä½œ å®‰è£…seleniumm pip install selenium ä¸‹è½½æµè§ˆå™¨é©±åŠ¨ Firefoxæµè§ˆå™¨é©±åŠ¨ï¼šgeckodriver Chromeæµè§ˆå™¨é©±åŠ¨ï¼šchromedriver , taobaoå¤‡ç”¨åœ°å€ IEæµè§ˆå™¨é©±åŠ¨ï¼šIEDriverServer Edgeæµè§ˆå™¨é©±åŠ¨ï¼šMicrosoftWebDriver Operaæµè§ˆå™¨é©±åŠ¨ï¼šoperadriver PhantomJSæµè§ˆå™¨é©±åŠ¨ï¼šphantomjs éœ€è¦æŠŠæµè§ˆå™¨é©±åŠ¨æ”¾å…¥ç³»ç»Ÿè·¯å¾„ä¸­ï¼Œæˆ–è€…ç›´æ¥å‘ŠçŸ¥selenuimçš„é©±åŠ¨è·¯å¾„ å¯åŠ¨æµè§ˆå™¨ï¼Œå¯ä»¥è®¾ç½®ä¸€äº›å‚æ•°ï¼Œæ¯”å¦‚æ— ç•Œé¢ä¹‹ç±»çš„ï¼Œè¯¦ç»†å‚è€ƒï¼šé…ç½®å‚æ•° å¯ä»¥æµ‹è¯•æ˜¯å¦æ­£å¸¸ä½¿ç”¨: from selenium import webdriver driver = webdriver.Firefox() # Firefoxæµè§ˆå™¨ # driver = webdriver.Firefox(\u0026#34;é©±åŠ¨è·¯å¾„\u0026#34;) driver = webdriver.Chrome() # Chromeæµè§ˆå™¨ driver = webdriver.Ie() # Internet Exploreræµè§ˆå™¨ driver = webdriver.Edge() # Edgeæµè§ˆå™¨ driver = webdriver.Opera() # Operaæµè§ˆå™¨ driver = webdriver.PhantomJS() # PhantomJS å…ƒç´ å®šä½ find_element_by_id() find_element_by_name() find_element_by_class_name() find_element_by_tag_name() find_element_by_link_text() find_element_by_partial_link_text() find_element_by_xpath() find_element_by_css_selector() åœ¨elementå˜æˆelementså°±æ˜¯æ‰¾æ‰€æœ‰æ»¡è¶³çš„æ¡ä»¶ï¼Œè¿”å›æ•°ç»„ã€‚ æ§åˆ¶æµè§ˆå™¨æ“ä½œ æ§åˆ¶æµè§ˆå™¨çª—å£å¤§å° driver.set_window_size(480, 800) åé€€ driver.back() å‰è¿› driver.forward() åˆ·æ–° driver.refresh() Webelementå¸¸ç”¨æ–¹æ³• ç‚¹å‡»å’Œè¾“å…¥ driver.find_element_by_id(\u0026#34;kw\u0026#34;).clear() # æ¸…é™¤æ–‡æœ¬ driver.find_element_by_id(\u0026#34;kw\u0026#34;).send_keys(\u0026#34;selenium\u0026#34;) # æ¨¡æ‹ŸæŒ‰é”®è¾“å…¥ driver.find_element_by_id(\u0026#34;su\u0026#34;).click() # å•æœºå…ƒç´  æäº¤ å¯ä»¥åœ¨æœç´¢æ¡†æ¨¡æ‹Ÿå›è½¦æ“ä½œ search_text = driver.find_element_by_id(\u0026#39;kw\u0026#39;) search_text.send_keys(\u0026#39;selenium\u0026#39;) search_text.submit() å…¶ä»– size: è¿”å›å…ƒç´ çš„å°ºå¯¸ã€‚ text: è·å–å…ƒç´ çš„æ–‡æœ¬ã€‚ get_attribute(name): è·å¾—å±æ€§å€¼ã€‚ is_displayed(): è®¾ç½®è¯¥å…ƒç´ æ˜¯å¦ç”¨æˆ·å¯è§ã€‚ é¼ æ ‡æ“ä½œ åœ¨ WebDriver ä¸­ï¼Œ å°†è¿™äº›å…³äºé¼ æ ‡æ“ä½œçš„æ–¹æ³•å°è£…åœ¨ ActionChains ç±»æä¾›ã€‚ ActionChains ç±»æä¾›äº†é¼ æ ‡æ“ä½œçš„å¸¸ç”¨æ–¹æ³•ï¼š perform()ï¼š æ‰§è¡Œæ‰€æœ‰ ActionChains ä¸­å­˜å‚¨çš„è¡Œä¸ºï¼› context_click()ï¼š å³å‡»ï¼› double_click()ï¼š åŒå‡»ï¼› drag_and_drop()ï¼š æ‹–åŠ¨ï¼› move_to_element()ï¼šé¼ æ ‡æ‚¬åœã€‚ ä¸¾ä¸ªä¾‹å­ï¼š from selenium import webdriver # å¼•å…¥ ActionChains ç±» from selenium.webdriver.common.action_chains import ActionChains driver = webdriver.Chrome() driver.get(\u0026#34;https://www.baidu.cn\u0026#34;) # å®šä½åˆ°è¦æ‚¬åœçš„å…ƒç´  above = driver.find_element_by_link_text(\u0026#34;è®¾ç½®\u0026#34;) # å¯¹å®šä½åˆ°çš„å…ƒç´ æ‰§è¡Œé¼ æ ‡æ‚¬åœæ“ä½œ ActionChains(driver).move_to_element(above).perform() é”®ç›˜äº‹ä»¶ ä»¥ä¸‹ä¸ºå¸¸ç”¨çš„é”®ç›˜æ“ä½œï¼š send_keys(Keys.BACK_SPACE) åˆ é™¤é”®ï¼ˆBackSpaceï¼‰ send_keys(Keys.SPACE) ç©ºæ ¼é”®(Space) send_keys(Keys.TAB) åˆ¶è¡¨é”®(Tab) send_keys(Keys.ESCAPE) å›é€€é”®ï¼ˆEscï¼‰ send_keys(Keys.ENTER) å›è½¦é”®ï¼ˆEnterï¼‰ send_keys(Keys.CONTROL,\u0026#39;a\u0026#39;) å…¨é€‰ï¼ˆCtrl+Aï¼‰ send_keys(Keys.CONTROL,\u0026#39;c\u0026#39;) å¤åˆ¶ï¼ˆCtrl+Cï¼‰ send_keys(Keys.CONTROL,\u0026#39;x\u0026#39;) å‰ªåˆ‡ï¼ˆCtrl+Xï¼‰ send_keys(Keys.CONTROL,\u0026#39;v\u0026#39;) ç²˜è´´ï¼ˆCtrl+Vï¼‰ send_keys(Keys.F1) é”®ç›˜ F1 send_keys(Keys.F12) é”®ç›˜ F12 # è¾“å…¥æ¡†è¾“å…¥å†…å®¹ driver.find_element_by_id(\u0026#34;kw\u0026#34;).send_keys(\u0026#34;seleniumm\u0026#34;) # åˆ é™¤å¤šè¾“å…¥çš„ä¸€ä¸ª m driver.find_element_by_id(\u0026#34;kw\u0026#34;).send_keys(Keys.BACK_SPACE) è·å–æ–­è¨€ä¿¡æ¯ title = driver.title # æ‰“å°å½“å‰é¡µé¢title now_url = driver.current_url # æ‰“å°å½“å‰é¡µé¢URL user = driver.find_element_by_class_name(\u0026#39;nums\u0026#39;).text # è·å–ç»“æœæ•°ç›® ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ æ˜¾æ€§ç­‰å¾… æ˜¾å¼ç­‰å¾…ä½¿WebdDriverç­‰å¾…æŸä¸ªæ¡ä»¶æˆç«‹æ—¶ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™åœ¨è¾¾åˆ°æœ€å¤§æ—¶é•¿æ—¶æŠ›å‡ºè¶…æ—¶å¼‚å¸¸ï¼ˆTimeoutExceptionï¼‰ã€‚ from selenium import webdriver from selenium.webdriver.common.by import By from selenium.webdriver.support.ui import WebDriverWait from selenium.webdriver.support import expected_conditions as EC driver = webdriver.Firefox() driver.get(\u0026#34;http://www.baidu.com\u0026#34;) element = WebDriverWait(driver, 5, 0.5).until( EC.presence_of_element_located((By.ID, \u0026#34;kw\u0026#34;)) ) element.send_keys(\u0026#39;selenium\u0026#39;) driver.quit() WebDriverWaitç±»æ˜¯ç”±WebDirver æä¾›çš„ç­‰å¾…æ–¹æ³•ã€‚åœ¨è®¾ç½®æ—¶é—´å†…ï¼Œé»˜è®¤æ¯éš”ä¸€æ®µæ—¶é—´æ£€æµ‹ä¸€æ¬¡å½“å‰é¡µé¢å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœè¶…è¿‡è®¾ç½®æ—¶é—´æ£€æµ‹ä¸åˆ°åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹ï¼š WebDriverWait(driver, timeout, poll_frequency=0.5, ignored_exceptions=None) driverï¼šæµè§ˆå™¨é©±åŠ¨ã€‚ timeoutï¼šæœ€é•¿è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä»¥ç§’ä¸ºå•ä½ã€‚ poll_frequencyï¼šæ£€æµ‹çš„é—´éš”ï¼ˆæ­¥é•¿ï¼‰æ—¶é—´ï¼Œé»˜è®¤ä¸º0.5Sã€‚ ignored_exceptionsï¼šè¶…æ—¶åçš„å¼‚å¸¸ä¿¡æ¯ï¼Œé»˜è®¤æƒ…å†µä¸‹æŠ›NoSuchElementExceptionå¼‚å¸¸ã€‚ WebDriverWait()ï¼šä¸€èˆ¬ç”±until()æˆ–until_not()æ–¹æ³•é…åˆä½¿ç”¨ ä¸‹é¢æ˜¯until()å’Œuntil_not()æ–¹æ³•çš„è¯´æ˜ until(method, message=â€˜â€™) è°ƒç”¨è¯¥æ–¹æ³•æä¾›çš„é©±åŠ¨ç¨‹åºä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œç›´åˆ°è¿”å›å€¼ä¸ºTrueã€‚ until_not(method, message=â€˜â€™) è°ƒç”¨è¯¥æ–¹æ³•æä¾›çš„é©±åŠ¨ç¨‹åºä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œç›´åˆ°è¿”å›å€¼ä¸ºFalseã€‚ åœ¨æœ¬ä¾‹ä¸­ï¼Œé€šè¿‡aså…³é”®å­—å°†expected_conditions é‡å‘½åä¸ºECï¼Œå¹¶è°ƒç”¨**presence_of_element_located()**æ–¹æ³•åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨ã€‚ éšå¼ç­‰å¾… å¦‚æœæŸäº›å…ƒç´ ä¸æ˜¯ç«‹å³å¯ç”¨çš„ï¼Œéšå¼ç­‰å¾…æ˜¯å‘Šè¯‰WebDriverå»ç­‰å¾…ä¸€å®šçš„æ—¶é—´åå»æŸ¥æ‰¾å…ƒç´ ã€‚ é»˜è®¤ç­‰å¾…æ—¶é—´æ˜¯0ç§’ï¼Œä¸€æ—¦è®¾ç½®è¯¥å€¼ï¼Œéšå¼ç­‰å¾…æ˜¯è®¾ç½®è¯¥WebDriverçš„å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸã€‚ from selenium import webdriver driver = webdriver.Firefox() driver.implicitly_wait(10) # seconds driver.get(\u0026#34;http://somedomain/url_that_delays_loading\u0026#34;) myDynamicElement = driver.find_element_by_id(\u0026#34;myDynamicElement\u0026#34;) åœ¨ä¸åŒçš„çª—å£å’Œæ¡†æ¶ä¹‹é—´ç§»åŠ¨ driver.switch_to_window(\u0026#34;windowName\u0026#34;) driver.switch_to_frame(\u0026#34;frameName\u0026#34;) ä»¥ç›´æ¥å–è¡¨å•çš„id æˆ–nameå±æ€§ã€‚å¦‚æœiframeæ²¡æœ‰å¯ç”¨çš„idå’Œnameå±æ€§ï¼Œåˆ™å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼è¿›è¡Œå®šä½ã€‚ #å…ˆé€šè¿‡xpthå®šä½åˆ°iframe\rxf = driver.find_element_by_xpath(\u0026#39;//*[@id=\u0026#34;x-URS-iframe\u0026#34;]\u0026#39;)\r#å†å°†å®šä½å¯¹è±¡ä¼ ç»™switch_to_frame()æ–¹æ³•\rdriver.switch_to_frame(xf) ä¸€æ—¦æˆ‘ä»¬å®Œæˆäº†frameä¸­çš„å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è¿”å›çˆ¶frame: driver.switch_to_default_content() è­¦å‘Šæ¡†å¤„ç† alert = driver.switch_to_alert() textï¼šè¿”å› alert/confirm/prompt ä¸­çš„æ–‡å­—ä¿¡æ¯ã€‚ accept()ï¼šæ¥å—ç°æœ‰è­¦å‘Šæ¡†ã€‚ dismiss()ï¼šè§£æ•£ç°æœ‰è­¦å‘Šæ¡†ã€‚ send_keys(keysToSend)ï¼šå‘é€æ–‡æœ¬è‡³è­¦å‘Šæ¡†ã€‚keysToSendï¼šå°†æ–‡æœ¬å‘é€è‡³è­¦å‘Šæ¡†ã€‚ ä¸‹æ‹‰æ¡†é€‰æ‹© from selenium import webdriver from selenium.webdriver.support.select import Select from time import sleep driver = webdriver.Chrome() driver.implicitly_wait(10) driver.get(\u0026#39;http://www.baidu.com\u0026#39;) sel = driver.find_element_by_xpath(\u0026#34;//select[@id=\u0026#39;nr\u0026#39;]\u0026#34;) Select(sel).select_by_value(\u0026#39;50\u0026#39;) # æ˜¾ç¤º50æ¡ æ–‡ä»¶ä¸Šä¼  # å®šä½ä¸Šä¼ æŒ‰é’®ï¼Œæ·»åŠ æœ¬åœ°æ–‡ä»¶ driver.find_element_by_name(\u0026#34;file\u0026#34;).send_keys(\u0026#39;D:\\\\upload_file.txt\u0026#39;) cookieæ“ä½œ WebDriveræ“ä½œcookieçš„æ–¹æ³•ï¼š get_cookies()ï¼š è·å¾—æ‰€æœ‰cookieä¿¡æ¯ã€‚ get_cookie(name)ï¼š è¿”å›å­—å…¸çš„keyä¸ºâ€œnameâ€çš„cookieä¿¡æ¯ã€‚ add_cookie(cookie_dict) ï¼š æ·»åŠ cookieã€‚â€œcookie_dictâ€æŒ‡å­—å…¸å¯¹è±¡ï¼Œå¿…é¡»æœ‰name å’Œvalue å€¼ã€‚ delete_cookie(name,optionsString)ï¼šåˆ é™¤cookieä¿¡æ¯ã€‚â€œnameâ€æ˜¯è¦åˆ é™¤çš„cookieçš„åç§°ï¼Œâ€œoptionsStringâ€æ˜¯è¯¥cookieçš„é€‰é¡¹ï¼Œç›®å‰æ”¯æŒçš„é€‰é¡¹åŒ…æ‹¬â€œè·¯å¾„â€ï¼Œâ€œåŸŸâ€ã€‚ delete_all_cookies()ï¼š åˆ é™¤æ‰€æœ‰cookieä¿¡æ¯ è°ƒç”¨JavaScriptä»£ç  é€šè¿‡**execute_script()**æ–¹æ³•æ‰§è¡ŒJavaScriptsä»£ç æ¥ç§»åŠ¨æ»šåŠ¨æ¡çš„ä½ç½®ã€‚ js=\u0026#34;window.scrollTo(100,450);\u0026#34; driver.execute_script(js) # é€šè¿‡javascriptè®¾ç½®æµè§ˆå™¨çª—å£çš„æ»šåŠ¨æ¡ä½ç½® çª—å£æˆªå›¾ driver.get_screenshot_as_file(\u0026#34;D:\\\\baidu_img.jpg\u0026#34;) # æˆªå–å½“å‰çª—å£ï¼Œå¹¶æŒ‡å®šæˆªå›¾å›¾ç‰‡çš„ä¿å­˜ä½ç½® å…³é—­æµè§ˆå™¨ close() å…³é—­å•ä¸ªçª—å£ quit() å…³é—­æ‰€æœ‰çª—å£ ç›´æ¥ç”¨cookieç™»å½•æ–¹æ³• æ‰‹åŠ¨è·å–ç½‘é¡µçš„cookieï¼Œå°†å…¶åºåˆ—åŒ–å¹¶å­˜å‚¨åœ¨æœ¬åœ° å†™å…¥ä»£ç  for item in cookies: driver.add_cookie(item) ","permalink":"https://www.chenzqi.cn/posts/2019/20190530_selenium-python-%E8%87%AA%E5%8A%A8%E5%8C%96/","tags":["python","å·¥å…·"],"title":"Selenium Python è‡ªåŠ¨åŒ–"},{"categories":[2019,"æŠ€æœ¯"],"contents":":::tip seleniumé…ç½® ::: æ¯æ¬¡å½“seleniumå¯åŠ¨chromeæµè§ˆå™¨çš„æ—¶å€™ï¼Œchromeæµè§ˆå™¨å¾ˆå¹²å‡€ï¼Œæ²¡æœ‰æ’ä»¶ã€æ²¡æœ‰æ”¶è—ã€æ²¡æœ‰å†å²è®°å½•ï¼Œè¿™æ˜¯å› ä¸ºseleniumåœ¨å¯åŠ¨chromeæ—¶ä¸ºäº†ä¿è¯æœ€å¿«çš„è¿è¡Œæ•ˆç‡ï¼Œå¯åŠ¨äº†ä¸€ä¸ªè£¸æµè§ˆå™¨ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦é…ç½®å‚æ•°çš„åŸå› ï¼Œä½†æ˜¯æœ‰äº›æ—¶å€™æˆ‘ä»¬éœ€è¦çš„ä¸ä»…æ˜¯ä¸€ä¸ªè£¸æµè§ˆå™¨ã€‚ seleniumå¯åŠ¨é…ç½®å‚æ•°æ¥æ”¶æ˜¯ChromeOptionsç±»ï¼Œåˆ›å»ºæ–¹å¼å¦‚ä¸‹ï¼š from selenium import webdriver option = webdriver.ChromeOptions() åˆ›å»ºäº†ChromeOptionsç±»ä¹‹åå°±æ˜¯æ·»åŠ å‚æ•°ï¼Œæ·»åŠ å‚æ•°æœ‰å‡ ä¸ªç‰¹å®šçš„æ–¹æ³•ï¼Œåˆ†åˆ«å¯¹åº”æ·»åŠ ä¸åŒç±»å‹çš„é…ç½®é¡¹ç›®ã€‚ è®¾ç½® chrome äºŒè¿›åˆ¶æ–‡ä»¶ä½ç½® (binary_location) from selenium import webdriver option = webdriver.ChromeOptions() # æ·»åŠ å¯åŠ¨å‚æ•° option.add_argument() # æ·»åŠ æ‰©å±•åº”ç”¨ option.add_extension() option.add_encoded_extension() # æ·»åŠ å®éªŒæ€§è´¨çš„è®¾ç½®å‚æ•° option.add_experimental_option() # è®¾ç½®è°ƒè¯•å™¨åœ°å€ option.debugger_address() å¸¸ç”¨é…ç½®å‚æ•° from selenium import webdriver option = webdriver.ChromeOptions() # æ·»åŠ UA options.add_argument(\u0026#39;user-agent=\u0026#34;MQQBrowser/26 Mozilla/5.0 (Linux; U; Android 2.3.7; zh-cn; MB200 Build/GRJ22; CyanogenMod-7) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1\u0026#34;\u0026#39;) # æŒ‡å®šæµè§ˆå™¨åˆ†è¾¨ç‡ options.add_argument(\u0026#39;window-size=1920x3000\u0026#39;) # è°·æ­Œæ–‡æ¡£æåˆ°éœ€è¦åŠ ä¸Šè¿™ä¸ªå±æ€§æ¥è§„é¿bug chrome_options.add_argument(\u0026#39;--disable-gpu\u0026#39;) # éšè—æ»šåŠ¨æ¡, åº”å¯¹ä¸€äº›ç‰¹æ®Šé¡µé¢ options.add_argument(\u0026#39;--hide-scrollbars\u0026#39;) # ä¸åŠ è½½å›¾ç‰‡, æå‡é€Ÿåº¦ options.add_argument(\u0026#39;blink-settings=imagesEnabled=false\u0026#39;) # æµè§ˆå™¨ä¸æä¾›å¯è§†åŒ–é¡µé¢. linuxä¸‹å¦‚æœç³»ç»Ÿä¸æ”¯æŒå¯è§†åŒ–ä¸åŠ è¿™æ¡ä¼šå¯åŠ¨å¤±è´¥ options.add_argument(\u0026#39;--headless\u0026#39;) # ä»¥æœ€é«˜æƒé™è¿è¡Œ options.add_argument(\u0026#39;--no-sandbox\u0026#39;) # æ‰‹åŠ¨æŒ‡å®šä½¿ç”¨çš„æµè§ˆå™¨ä½ç½® options.binary_location = r\u0026#34;C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\u0026#34; #æ·»åŠ crxæ’ä»¶ option.add_extension(\u0026#39;d:\\crx\\AdBlock_v2.17.crx\u0026#39;) # ç¦ç”¨JavaScript option.add_argument(\u0026#34;--disable-javascript\u0026#34;) # è®¾ç½®å¼€å‘è€…æ¨¡å¼å¯åŠ¨ï¼Œè¯¥æ¨¡å¼ä¸‹webdriverå±æ€§ä¸ºæ­£å¸¸å€¼ options.add_experimental_option(\u0026#39;excludeSwitches\u0026#39;, [\u0026#39;enable-automation\u0026#39;]) # ç¦ç”¨æµè§ˆå™¨å¼¹çª— prefs = { \u0026#39;profile.default_content_setting_values\u0026#39; : { \u0026#39;notifications\u0026#39; : 2 } } options.add_experimental_option(\u0026#39;prefs\u0026#39;,prefs) driver=webdriver.Chrome(chrome_options=chrome_options) æµè§ˆå™¨åœ°å€æ å‚æ•° åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ä¸‹åˆ—å‘½ä»¤å¾—åˆ°ç›¸åº”çš„ä¿¡æ¯ about:version - æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬ about:memory - æ˜¾ç¤ºæœ¬æœºæµè§ˆå™¨å†…å­˜ä½¿ç”¨çŠ¶å†µ about:plugins - æ˜¾ç¤ºå·²å®‰è£…æ’ä»¶ about:histograms - æ˜¾ç¤ºå†å²è®°å½• about:dns - æ˜¾ç¤ºDNSçŠ¶æ€ about:cache - æ˜¾ç¤ºç¼“å­˜é¡µé¢ about:gpu -æ˜¯å¦æœ‰ç¡¬ä»¶åŠ é€Ÿ chrome://extensions/ - æŸ¥çœ‹å·²ç»å®‰è£…çš„æ‰©å±• å…¶ä»–é…ç½®é¡¹ç›®å‚æ•° â€“user-data-dir=â€[PATH]â€ # æŒ‡å®šç”¨æˆ·æ–‡ä»¶å¤¹User Dataè·¯å¾„ï¼Œå¯ä»¥æŠŠä¹¦ç­¾è¿™æ ·çš„ç”¨æˆ·æ•°æ®ä¿å­˜åœ¨ç³»ç»Ÿåˆ†åŒºä»¥å¤–çš„åˆ†åŒº â€“disk-cache-dir=â€[PATH]â€œ # æŒ‡å®šç¼“å­˜Cacheè·¯å¾„ â€“disk-cache-size= # æŒ‡å®šCacheå¤§å°ï¼Œå•ä½Byte â€“first run # é‡ç½®åˆ°åˆå§‹çŠ¶æ€ï¼Œç¬¬ä¸€æ¬¡è¿è¡Œ â€“incognito # éšèº«æ¨¡å¼å¯åŠ¨ â€“disable-javascript # ç¦ç”¨Javascript --omnibox-popup-count=\u0026#34;num\u0026#34; # å°†åœ°å€æ å¼¹å‡ºçš„æç¤ºèœå•æ•°é‡æ”¹ä¸ºnumä¸ª --user-agent=\u0026#34;xxxxxxxx\u0026#34; # ä¿®æ”¹HTTPè¯·æ±‚å¤´éƒ¨çš„Agentå­—ç¬¦ä¸²ï¼Œå¯ä»¥é€šè¿‡about:versioné¡µé¢æŸ¥çœ‹ä¿®æ”¹æ•ˆæœ --disable-plugins # ç¦æ­¢åŠ è½½æ‰€æœ‰æ’ä»¶ï¼Œå¯ä»¥å¢åŠ é€Ÿåº¦ã€‚å¯ä»¥é€šè¿‡about:pluginsé¡µé¢æŸ¥çœ‹æ•ˆæœ --disable-javascript # ç¦ç”¨JavaScriptï¼Œå¦‚æœè§‰å¾—é€Ÿåº¦æ…¢åœ¨åŠ ä¸Šè¿™ä¸ª --disable-java # ç¦ç”¨java --start-maximized # å¯åŠ¨å°±æœ€å¤§åŒ– --no-sandbox # å–æ¶ˆæ²™ç›’æ¨¡å¼ --single-process # å•è¿›ç¨‹è¿è¡Œ --process-per-tab # æ¯ä¸ªæ ‡ç­¾ä½¿ç”¨å•ç‹¬è¿›ç¨‹ --process-per-site # æ¯ä¸ªç«™ç‚¹ä½¿ç”¨å•ç‹¬è¿›ç¨‹ --in-process-plugins # æ’ä»¶ä¸å¯ç”¨å•ç‹¬è¿›ç¨‹ --disable-popup-blocking # ç¦ç”¨å¼¹å‡ºæ‹¦æˆª --disable-plugins # ç¦ç”¨æ’ä»¶ --disable-images # ç¦ç”¨å›¾åƒ --incognito # å¯åŠ¨è¿›å…¥éšèº«æ¨¡å¼ --enable-udd-profiles # å¯ç”¨è´¦æˆ·åˆ‡æ¢èœå• --proxy-pac-url # ä½¿ç”¨pacä»£ç† [via 1/2] --lang=zh-CN # è®¾ç½®è¯­è¨€ä¸ºç®€ä½“ä¸­æ–‡ --disk-cache-dir # è‡ªå®šä¹‰ç¼“å­˜ç›®å½• --disk-cache-size # è‡ªå®šä¹‰ç¼“å­˜æœ€å¤§å€¼ï¼ˆå•ä½byteï¼‰ --media-cache-size # è‡ªå®šä¹‰å¤šåª’ä½“ç¼“å­˜æœ€å¤§å€¼ï¼ˆå•ä½byteï¼‰ --bookmark-menu # åœ¨å·¥å…· æ å¢åŠ ä¸€ä¸ªä¹¦ç­¾æŒ‰é’® --enable-sync # å¯ç”¨ä¹¦ç­¾åŒæ­¥ ","permalink":"https://www.chenzqi.cn/posts/2019/20190530_selenium%E5%90%AF%E5%8A%A8chrome%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0/","tags":["python","å·¥å…·"],"title":"seleniumå¯åŠ¨Chromeé…ç½®å‚æ•°"},{"categories":[2019,"æŠ€æœ¯"],"contents":"å®ä¾‹ ç®—æœ¯è¿ç®—å’Œæ–‡ä»¶å†™å…¥çš„ä¾‹å­ def process(num1, num2, file): result = num1 / num2 with open(file, \u0026#39;w\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: f.write(str(result)) å®šä¹‰äº†ä¸€ä¸ª process æ–¹æ³•ï¼Œæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œå‰ä¸¤ä¸ªå‚æ•°æ˜¯ num1 å’Œ num2ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ fileã€‚æ–¹æ³•ä¼šé¦–å…ˆå°† num1 é™¤ä»¥ num2ï¼Œç„¶åæŠŠé™¤æ³•çš„ç»“æœå†™å…¥åˆ° file æ–‡ä»¶é‡Œé¢ã€‚ è¿™ä¸ªå®ç°çš„æ¼æ´ï¼š æ²¡æœ‰åˆ¤æ–­ num1ã€num2 çš„ç±»å‹ï¼Œå¦‚æœä¸æ˜¯æ•°å­—ç±»å‹ï¼Œé‚£ä¼šæŠ›å‡º TypeErrorã€‚ æ²¡æœ‰åˆ¤æ–­ num2 æ˜¯ä¸æ˜¯ 0ï¼Œå¦‚æœæ˜¯ 0ï¼Œé‚£ä¹ˆä¼šæŠ›å‡º ZeroDivisionErrorã€‚ æ²¡æœ‰åˆ¤æ–­æ–‡ä»¶è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯å­æ–‡ä»¶å¤¹ä¸‹çš„è·¯å¾„ï¼Œæ–‡ä»¶å¤¹ä¸å­˜åœ¨çš„è¯ï¼Œä¼šæŠ›å‡º FileNotFoundErrorã€‚ ä¸€äº›å¼‚å¸¸æµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹ï¼š process(1, 2, \u0026#39;result/result.txt\u0026#39;) process(1, 0, \u0026#39;result.txt\u0026#39;) process(1, [2], \u0026#39;result.txt\u0026#39;) ç”¨ä¾‹è·‘èµ·æ¥ä¸€å®šä¼šæŠ¥é”™ æœ€å¥½çš„æ–¹å¼æ˜¯é€šè¿‡ä¸€äº›åˆ¤æ–­æ¡ä»¶æŠŠä¸€äº›è¯¥å¤„ç†çš„é—®é¢˜å’Œåˆ¤å®šéƒ½åŠ ä¸Š def process(num1, num2, file): try: result = num1 / num2 with open(file, \u0026#39;w\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: f.write(str(result)) except ZeroDivisionError: print(f\u0026#39;{num2} can not be zero\u0026#39;) except FileNotFoundError: print(f\u0026#39;file {file} not found\u0026#39;) except Exception as e: print(f\u0026#39;exception, {e.args}\u0026#39;) é—®é¢˜: ä»£ç ä¸€ä¸‹å­è‡ƒè‚¿äº†èµ·æ¥ï¼Œè¿™é‡Œçš„å¼‚å¸¸å¤„ç†éƒ½æ²¡æœ‰å®ç°ï¼Œä»…ä»…æ˜¯ print äº†ä¸€äº›é”™è¯¯ä¿¡æ¯ï¼Œä½†ç°åœ¨å¯ä»¥çœ‹åˆ°å¼‚å¸¸å¤„ç†ä»£ç å¯èƒ½æ¯”ä¸»é€»è¾‘è¿˜è¦å¤š ä¸»é€»è¾‘ä»£ç æ•´å—è¢«ç¡¬ç”Ÿç”Ÿåœ°ç¼©è¿›è¿›å»äº†ï¼Œå¦‚æœä¸»é€»è¾‘ä»£ç æ¯”è¾ƒå¤šçš„è¯ï¼Œé‚£ä¹ˆä¼šæœ‰å¤§ç‰‡å¤§ç‰‡çš„ç¼©è¿› å¦‚æœå†æœ‰ç›¸åŒçš„é€»è¾‘çš„ä»£ç ï¼Œè¦å†å†™ä¸€æ¬¡ try except å‡ ç§æ”¹å–„çš„æ–¹æ¡ˆï¼š æœ¬èº«è¿™ä¸ªåœºæ™¯ä¸éœ€è¦è¿™ä¹ˆå¤šå¼‚å¸¸å¤„ç†ï¼Œä½¿ç”¨åˆ¤æ–­æ¡ä»¶æŠŠä¸€äº›æ„å¤–æƒ…å†µå¤„ç†æ‰å°±å¥½ å¼‚å¸¸å¤„ç†æœ¬èº«å°±ä¸åº”è¯¥è¿™ä¹ˆå†™ï¼Œæ¯ä¸ªåŠŸèƒ½åŒºåŸŸåº”è¯¥å’Œå¼‚å¸¸å¤„ç†å•ç‹¬åˆ†å¼€ï¼Œå¦å¤–å„ä¸ªé€»è¾‘æ¨¡å—å»ºè®®å†åˆ†æ–¹æ³•è§£è€¦ ä½¿ç”¨ retrying æ¨¡å—æ£€æµ‹å¼‚å¸¸å¹¶è¿›è¡Œé‡è¯•ã€‚ ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ raise_api_error æ¥å£°æ˜å¼‚å¸¸å¤„ç†ã€‚ ä½†ä¸Šé¢çš„ä¸€äº›è§£å†³æ–¹æ¡ˆå…¶å®è¿˜ä¸èƒ½å½»åº•è§£å†³ä»£ç å¤ç”¨å’Œç¾è§‚ä¸Šçš„é—®é¢˜ï¼Œæ¯”å¦‚æŸä¸€ç±»çš„å¼‚å¸¸å¤„ç†å°±ç»Ÿä¸€åœ¨ä¸€ä¸ªåœ°æ–¹å¤„ç†ï¼Œå¦å¤–ä»»ä½•ä»£ç éƒ½ä¸æƒ³å› ä¸ºå¼‚å¸¸å¤„ç†äº§ç”Ÿç¼©è¿›ã€‚ Merryåº“ Merryåº“æ˜¯ Python çš„ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œéå¸¸å°å·§ï¼Œå®ç°äº†å‡ ä¸ªè£…é¥°å™¨ã€‚é€šè¿‡ä½¿ç”¨ Merry æˆ‘ä»¬å¯ä»¥æŠŠå¼‚å¸¸æ£€æŸ¥å’Œå¼‚å¸¸å¤„ç†çš„ä»£ç åˆ†å¼€ï¼Œå¹¶å¯ä»¥é€šè¿‡è£…é¥°å™¨æ¥å®šä¹‰å¼‚å¸¸æ£€æŸ¥å’Œå¤„ç†çš„é€»è¾‘ã€‚ å®‰è£… pip3 install merry ä½¿ç”¨ from merry import Merry merry = Merry() merry.logger.disabled = True @merry._try def process(num1, num2, file): result = num1 / num2 with open(file, \u0026#39;w\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: f.write(str(result)) @merry._except(ZeroDivisionError) def process_zero_division_error(e): print(\u0026#39;zero_division_error\u0026#39;, e) @merry._except(FileNotFoundError) def process_file_not_found_error(e): print(\u0026#39;file_not_found_error\u0026#39;, e) @merry._except(Exception) def process_exception(e): print(\u0026#39;exception\u0026#39;, type(e), e) if __name__ == \u0026#39;__main__\u0026#39;: process(1, 2, \u0026#39;result/result.txt\u0026#39;) process(1, 0, \u0026#39;result.txt\u0026#39;) process(1, 2, \u0026#39;result.txt\u0026#39;) process(1, [1], \u0026#39;result.txt\u0026#39;) å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é¦–å…ˆå£°æ˜äº†ä¸€ä¸ª Merry å¯¹è±¡ï¼Œç„¶å process æ–¹æ³•åŠ ä¸Š merry å¯¹è±¡çš„ _try æ–¹æ³•çš„è£…é¥°å™¨ï¼Œè¿™æ ·å°±å®ç°äº†å¼‚å¸¸çš„ç›‘å¬ã€‚ æœ‰äº†å¼‚å¸¸ç›‘å¬ä¹‹åï¼Œæ€ä¹ˆæ¥è¿›è¡Œå¼‚å¸¸å¤„ç†å‘¢ï¼Ÿè¿˜æ˜¯é€šè¿‡åŒä¸€ä¸ª merry å¯¹è±¡ï¼Œä½¿ç”¨å…¶ _except æ–¹æ³•ä½œä¸ºè£…é¥°å™¨å³å¯ã€‚æ¯”å¦‚è¿™é‡Œæˆ‘ä»¬å°†å‡ ä¸ªå¼‚å¸¸å¤„ç†æ–¹æ³•åˆ†å¼€äº†ï¼Œå¦‚å¤„ç† ZeroDivisionErrorã€FileNotFoundErrorã€Exception ç­‰å¼‚å¸¸åˆ†åˆ«éƒ½æœ‰ä¸€ä¸ªæ–¹æ³•çš„å£°æ˜ï¼Œåˆ†åˆ«åŠ ä¸Šå¯¹åº”çš„è£…é¥°å™¨å³å¯ã€‚ è¿™æ ·çš„è¯ï¼Œå°±è½»æ¾å®ç°äº†å¼‚å¸¸ç›‘å¬å’Œå¤„ç† å’Œä¸Šé¢ä¸åŒä¹‹å¤„ï¼š ä¸»é€»è¾‘é‡Œé¢ä¸ç”¨é¢å¤–åŠ å¼‚å¸¸å¤„ç†ä»£ç äº†ï¼Œæ˜¾å¾—ç®€æ´ã€‚ ä¸»é€»è¾‘ä¸ç”¨å› ä¸º try except è€Œç¼©è¿›äº†ã€‚ æ¯ä¸ªå¼‚å¸¸å¤„ç†æ–¹æ³•å•ç‹¬åˆ†å¼€äº†ï¼Œå¯ä»¥å®ç°è§£è€¦å’Œé‡ç”¨ã€‚ æ•´ä¸ªå®ç°å°±èˆ’æœå¤šäº†ã€‚ è¿è¡Œä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š file_not_found_error [Errno 2] No such file or directory: \u0026#39;result/result.txt\u0026#39; zero_division_error division by zero exception \u0026lt;class \u0026#39;TypeError\u0026#39;\u0026gt; unsupported operand type(s) for /: \u0026#39;int\u0026#39; and \u0026#39;list\u0026#39; ç±»å®ç° ä¸Šé¢çš„å®ç°æ•´ä¸ªçœ‹èµ·æ¥ç»“æ„æ¯”è¾ƒæ¾æ•£ï¼Œä»£ç ä¸å¥½å¤ç”¨ å¦‚æœå°è£…å¥½äº†ç±»ä¹‹åï¼Œå¯ä»¥ç›´æ¥æŠŠç±»æ‹¿è¿‡æ¥ä½¿ç”¨ï¼Œå®ç°çš„æ—¶å€™ç»§æ‰¿è¿™ä¸ªç±»ï¼Œå°±ä¸ç”¨å†å…³å¿ƒå„ä¸ªå¼‚å¸¸å¤„ç†æ˜¯æ€ä¹ˆå®ç°çš„äº†ã€‚ åœ¨è¿™é‡Œä¸€ä¸ªç®€å•çš„å®ç°å¦‚ä¸‹ï¼š import requests from merry import Merry from requests import ConnectTimeout merry = Merry() merry.logger.disabled = True catch = merry._try class BaseClass(object): @staticmethod @merry._except(ZeroDivisionError) def process_zero_division_error(e): print(\u0026#39;zero_division_error\u0026#39;, e) @staticmethod @merry._except(FileNotFoundError) def process_file_not_found_error(e): print(\u0026#39;file_not_found_error\u0026#39;, e) @staticmethod @merry._except(Exception) def process_exception(e): print(\u0026#39;exception\u0026#39;, type(e), e) @staticmethod @merry._except(ConnectTimeout) def process_connect_timeout(e): print(\u0026#39;connect_timeout\u0026#39;, e) class Calculator(BaseClass): @catch def process(self, num1, num2, file): result = num1 / num2 with open(file, \u0026#39;w\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: f.write(str(result)) class Fetcher(BaseClass): @catch def process(self, url): response = requests.get(url, timeout=1) if response.status_code == 200: print(response.text) if __name__ == \u0026#39;__main__\u0026#39;: c = Calculator() c.process(1, 0, \u0026#39;result.txt\u0026#39;) f = Fetcher() f.process(\u0026#39;http://notfound.com\u0026#39;) å…ˆå®ç°äº†ä¸€ä¸ª BaseClassï¼Œé‡Œé¢é€šè¿‡ merry å®šä¹‰äº†å¥½å¤šä¸ªå¼‚å¸¸å¤„ç†æ–¹æ³•å’Œå¤„ç†æµç¨‹ï¼Œå¼‚å¸¸å¤„ç†æ–¹æ³•å®šä¹‰æˆ staticmethodã€‚ æ¥ç€å®šä¹‰äº†ä¸¤ä¸ªç±»ï¼Œä¸€ä¸ªæ˜¯ Calculatorï¼Œä¸€ä¸ªæ˜¯ Fetcherï¼Œåˆ†åˆ«å®Œæˆä¸åŒçš„åŠŸèƒ½ï¼Œä¸€ä¸ªæ˜¯è®¡ç®—ï¼Œä¸€ä¸ªæ˜¯æŠ“å–ç½‘é¡µã€‚å¦å¤– Merry çš„ _try æ–¹æ³•æˆ‘ä»¬ç»™å®ƒå–äº†ä¸ªåˆ«åï¼Œæ¯”å¦‚å«åš catchï¼Œæ˜¾å¾—æ›´ç®€æ´ã€‚ åœ¨ process æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æˆ‘ä»¬æƒ³è¦è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œé‚£ä¹ˆå°±åŠ ä¸Š @catch è¿™è£…é¥°å™¨å°±å¥½äº†ï¼Œå…¶ä»–çš„ä¸éœ€è¦ç®¡ã€‚ è¿™æ ·ï¼Œåœ¨å®ç°å­ç±»çš„æ—¶å€™ï¼Œåªéœ€è¦é›†æˆ BaseClass ç„¶åå®ç°å¯¹åº”çš„æ–¹æ³•å°±å¥½äº†ï¼Œå¦‚æœæƒ³åŠ ä¸Šå¼‚å¸¸å¤„ç†å°±åŠ ä¸ªè£…é¥°å™¨ï¼Œä¹Ÿæ— éœ€å†å…³å¿ƒ Merry çš„å…·ä½“å®ç°ï¼Œçˆ¶ç±»éƒ½å®ç°å¥½äº†. è¿è¡Œç»“æœå¦‚ä¸‹ï¼š zero_division_error division by zero connect_timeout HTTPConnectionPool(host=\u0026#39;notfound.com\u0026#39;, port=80): Max retries exceeded with url: / (Caused by ConnectTimeoutError(\u0026lt;urllib3.connection.HTTPConnection object at 0x10d5b9310\u0026gt;, \u0026#39;Connection to notfound.com timed out. (connect timeout=1)\u0026#39;)) æ•°æ®ä¼ é€’ åˆ©ç”¨ try except å¯ä»¥ç›´æ¥è·å–å¼‚å¸¸ä»£ç çš„å˜é‡ä¿¡æ¯ï¼Œåˆ†äº†æ–¹æ³•ä¹‹åï¼Œä¸€äº›ä¸Šä¸‹æ–‡çš„å˜é‡ä¸å°±æ‹¿ä¸åˆ°äº† Merry æ˜¯ç”¨äº†ä¸€ä¸ªå…¨å±€çš„å˜é‡æ¥è§£å†³çš„ï¼Œå®ƒä½¿ç”¨äº† merry.g è¿™ä¸ªå¯¹è±¡æ¥å­˜å‚¨ä¸Šä¸‹æ–‡çš„å˜é‡ï¼Œåœ¨ ä¸»é€»è¾‘æ–¹æ³•é‡Œé¢è¦æŠŠæƒ³è¦ä¼ é€’çš„å‚æ•°èµ‹å€¼è¿›å»ï¼Œåœ¨å¼‚å¸¸å¤„ç†çš„æ–¹æ³•é‡Œé¢å†ç”¨ merry.g å–å‡ºæ¥ï¼Œå®˜æ–¹ç¤ºä¾‹å†™æ³•å¦‚ä¸‹ï¼š @merry._try def app_logic(): db = open_database() merry.g.database = db # save it in the error context just in case # do database stuff here @merry._except(Exception) def catch_all(): db = getattr(merry.g, \u0026#39;database\u0026#39;, None) if db is not None and is_database_open(db): close_database(db) print(\u0026#39;Unexpected error, quitting\u0026#39;) sys.exit(1) æºç å‰–æ from functools import wraps import inspect import logging getargspec = None if getattr(inspect, \u0026#39;getfullargspec\u0026#39;, None): getargspec = inspect.getfullargspec else: # this one is deprecated in Python 3, but available in Python 2 getargspec = inspect.getargspec class _Namespace: pass class Merry(object): def __init__(self, logger_name=\u0026#39;merry\u0026#39;, debug=False): self.logger = logging.getLogger(logger_name) self.g = _Namespace() self.debug = debug self.except_ = {} self.force_debug = [] self.force_handle = [] self.else_ = None self.finally_ = None def _try(self, f): @wraps(f) def wrapper(*args, **kwargs): ret = None try: ret = f(*args, **kwargs) # note that if the function returned something, the else clause # will be skipped. This is a similar behavior to a normal # try/except/else block. if ret is not None: return ret except Exception as e: # find the best handler for this exception handler = None for c in self.except_.keys(): if isinstance(e, c): if handler is None or issubclass(c, handler): handler = c # if we don\u0026#39;t have any handler, we let the exception bubble up if handler is None: raise e # log exception self.logger.exception(\u0026#39;[merry] Exception caught\u0026#39;) # if in debug mode, then bubble up to let a debugger handle debug = self.debug if handler in self.force_debug: debug = True elif handler in self.force_handle: debug = False if debug: raise e # invoke handler if len(getargspec(self.except_[handler])[0]) == 0: return self.except_[handler]() else: return self.except_[handler](e) else: # if we have an else handler, call it now if self.else_ is not None: return self.else_() finally: # if we have a finally handler, call it now if self.finally_ is not None: alt_ret = self.finally_() if alt_ret is not None: ret = alt_ret return ret return wrapper def _except(self, *args, **kwargs): def decorator(f): for e in args: self.except_[e] = f d = kwargs.get(\u0026#39;debug\u0026#39;, None) if d: self.force_debug.append(e) elif d is not None: self.force_handle.append(e) return f return decorator def _else(self, f): self.else_ = f return f def _finally(self, f): self.finally_ = f return f ä¸»è¦çš„é€»è¾‘éƒ½åœ¨ _try æ–¹æ³•é‡Œé¢äº†ï¼Œå°±æ˜¯ä»¿ç…§è¿™æ ‡å‡†çš„ tryã€exceptã€elseã€finally æ–¹æ³•æŠŠæµç¨‹å®ç°ä¸‹æ¥äº†ï¼Œåªä¸è¿‡åœ¨å¯¹åº”çš„é€»è¾‘åŒºå—é‡Œé¢è°ƒç”¨äº†è£…é¥°å™¨ä¿®é¥°çš„æ–¹æ³•ã€‚ å…¶ä¸­æœ‰ä¸€ä¸ªåœ°æ–¹æ¯”è¾ƒæœ‰æ„æ€ï¼š handler = None for c in self.except_.keys(): if isinstance(e, c): if handler is None or issubclass(c, handler): handler = c è¿™é‡Œæ˜¯ä¸ºå¼‚å¸¸å¤„ç†æ‰¾å¯»ä¸€ä¸ªæœ€ä½³çš„å¼‚å¸¸å¤„ç†æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œé€šè¿‡å„ä¸ª _except ä¿®é¥°çš„æ–¹æ³•ï¼Œç„¶åé€šè¿‡ issubclass æ–¹æ³•æ¥æ‰¾å¯»æœ€å°èƒ½å¤„ç†çš„å­ç±»ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€ä½³åŒ¹é…æ–¹æ³•. ","permalink":"https://www.chenzqi.cn/posts/2019/20190521_%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%BA%93merry/","tags":["python"],"title":"å¼‚å¸¸å¤„ç†åº“merryçš„ç”¨æ³•"},{"categories":[2019,"æŠ€æœ¯"],"contents":":::tip PyQt5ç¼–ç¨‹ ::: å·¥å…· è®°å½•ä¸ºå…¬å¸äººå‘˜å†™çš„ä¾¿æºæ“ä½œæ•°æ®åº“æˆ¿æºæ•°æ®ç¨‹åº, UIä¸é€»è¾‘å±‚åˆ†ç¦»ï¼Œä½¿ç”¨ Qt Designer + PyQt5å®Œæˆã€‚pycharmé…ç½®PyUICå·¥å…·ï¼ˆuiè½¬pyå·¥å…·ï¼‰ã€‚ UIä»£ç  # -*- coding: utf-8 -*- # Form implementation generated from reading ui file \u0026#39;pyqt5_demo.ui\u0026#39; # # Created by: PyQt5 UI code generator 5.15.0 # # WARNING: Any manual changes made to this file will be lost when pyuic5 is # run again. Do not edit this file unless you know what you are doing. from PyQt5 import QtCore, QtGui, QtWidgets class Ui_MainWindow(object): def setupUi(self, MainWindow): MainWindow.setObjectName(\u0026#34;MainWindow\u0026#34;) MainWindow.resize(944, 633) self.centralwidget = QtWidgets.QWidget(MainWindow) self.centralwidget.setObjectName(\u0026#34;centralwidget\u0026#34;) self.export_button = QtWidgets.QPushButton(self.centralwidget) self.export_button.setGeometry(QtCore.QRect(810, 240, 80, 30)) font = QtGui.QFont() font.setFamily(\u0026#34;Microsoft YaHei UI\u0026#34;) font.setPointSize(12) self.export_button.setFont(font) self.export_button.setStyleSheet(\u0026#34;\u0026#34;) self.export_button.setIconSize(QtCore.QSize(22, 22)) self.export_button.setObjectName(\u0026#34;export_button\u0026#34;) self.select_button = QtWidgets.QPushButton(self.centralwidget) self.select_button.setGeometry(QtCore.QRect(690, 240, 80, 30)) font = QtGui.QFont() font.setFamily(\u0026#34;å¾®è½¯é›…é»‘\u0026#34;) font.setPointSize(12) font.setBold(False) font.setItalic(False) font.setWeight(50) self.select_button.setFont(font) self.select_button.setStyleSheet(\u0026#34;background-color:rgb(85, 170, 127);\\n\u0026#34; \u0026#34;font: 12pt \\\u0026#34;å¾®è½¯é›…é»‘\\\u0026#34;;\\n\u0026#34; \u0026#34;border-radius:3px;\u0026#34;) self.select_button.setIconSize(QtCore.QSize(22, 22)) self.select_button.setAutoRepeat(False) self.select_button.setAutoDefault(False) self.select_button.setDefault(False) self.select_button.setFlat(False) self.select_button.setObjectName(\u0026#34;select_button\u0026#34;) self.groupBox = QtWidgets.QGroupBox(self.centralwidget) self.groupBox.setGeometry(QtCore.QRect(560, 0, 381, 171)) self.groupBox.setStyleSheet(\u0026#34;background-color:#dbfcff\u0026#34;) self.groupBox.setTitle(\u0026#34;\u0026#34;) self.groupBox.setObjectName(\u0026#34;groupBox\u0026#34;) self.label_6 = QtWidgets.QLabel(self.groupBox) self.label_6.setGeometry(QtCore.QRect(253, 90, 110, 20)) font = QtGui.QFont() font.setFamily(\u0026#34;MV Boli\u0026#34;) self.label_6.setFont(font) self.label_6.setObjectName(\u0026#34;label_6\u0026#34;) self.date_name = QtWidgets.QLineEdit(self.groupBox) self.date_name.setGeometry(QtCore.QRect(80, 82, 140, 30)) font = QtGui.QFont() font.setFamily(\u0026#34;å¾®è½¯é›…é»‘\u0026#34;) font.setPointSize(10) self.date_name.setFont(font) self.date_name.setStyleSheet(\u0026#34;background-color:#ffffff;\\n\u0026#34; \u0026#34;border-radius:3px;\u0026#34;) self.date_name.setObjectName(\u0026#34;date_name\u0026#34;) self.city_name = QtWidgets.QComboBox(self.groupBox) self.city_name.setGeometry(QtCore.QRect(250, 20, 91, 31)) font = QtGui.QFont() font.setFamily(\u0026#34;Microsoft YaHei UI\u0026#34;) font.setPointSize(10) self.city_name.setFont(font) self.city_name.setStyleSheet(\u0026#34;background-color:#ffffff;\\n\u0026#34; \u0026#34;border-radius:3px;\u0026#34;) self.city_name.setObjectName(\u0026#34;city_name\u0026#34;) self.city_name.addItem(\u0026#34;\u0026#34;) self.city_name.addItem(\u0026#34;\u0026#34;) self.city_name.addItem(\u0026#34;\u0026#34;) self.city_name.addItem(\u0026#34;\u0026#34;) self.city_name.addItem(\u0026#34;\u0026#34;) self.city_name.addItem(\u0026#34;\u0026#34;) self.city_name.addItem(\u0026#34;\u0026#34;) self.city_name.addItem(\u0026#34;\u0026#34;) self.label_2 = QtWidgets.QLabel(self.groupBox) self.label_2.setGeometry(QtCore.QRect(200, 20, 41, 31)) font = QtGui.QFont() font.setFamily(\u0026#34;å¾®è½¯é›…é»‘\u0026#34;) font.setPointSize(12) font.setBold(False) font.setWeight(50) self.label_2.setFont(font) self.label_2.setObjectName(\u0026#34;label_2\u0026#34;) self.label_5 = QtWidgets.QLabel(self.groupBox) self.label_5.setGeometry(QtCore.QRect(30, 81, 41, 30)) font = QtGui.QFont() font.setFamily(\u0026#34;å¾®è½¯é›…é»‘\u0026#34;) font.setPointSize(12) font.setBold(False) font.setWeight(50) self.label_5.setFont(font) self.label_5.setObjectName(\u0026#34;label_5\u0026#34;) self.label = QtWidgets.QLabel(self.groupBox) self.label.setGeometry(QtCore.QRect(30, 20, 41, 31)) font = QtGui.QFont() font.setFamily(\u0026#34;å¾®è½¯é›…é»‘\u0026#34;) font.setPointSize(12) font.setBold(False) font.setWeight(50) self.label.setFont(font) self.label.setObjectName(\u0026#34;label\u0026#34;) self.status_name = QtWidgets.QComboBox(self.groupBox) self.status_name.setGeometry(QtCore.QRect(80, 20, 91, 31)) font = QtGui.QFont() font.setFamily(\u0026#34;Microsoft YaHei UI\u0026#34;) font.setPointSize(10) self.status_name.setFont(font) self.status_name.setStyleSheet(\u0026#34;background-color:#ffffff;\\n\u0026#34; \u0026#34;border-radius:3px;\u0026#34;) self.status_name.setObjectName(\u0026#34;status_name\u0026#34;) self.status_name.addItem(\u0026#34;\u0026#34;) self.status_name.addItem(\u0026#34;\u0026#34;) self.status_name.addItem(\u0026#34;\u0026#34;) self.status_name.addItem(\u0026#34;\u0026#34;) self.status_name.addItem(\u0026#34;\u0026#34;) self.status_name.addItem(\u0026#34;\u0026#34;) self.tableView = QtWidgets.QTableView(self.centralwidget) self.tableView.setGeometry(QtCore.QRect(0, 30, 560, 560)) font = QtGui.QFont() font.setFamily(\u0026#34;å¾®è½¯é›…é»‘\u0026#34;) font.setPointSize(10) self.tableView.setFont(font) self.tableView.setStyleSheet(\u0026#34;background-color:#f6f8fa;\\n\u0026#34; \u0026#34;border-radius:5px;\u0026#34;) self.tableView.setObjectName(\u0026#34;tableView\u0026#34;) self.tableView.horizontalHeader().setVisible(True) self.tableView.horizontalHeader().setCascadingSectionResizes(False) self.textBrowser = QtWidgets.QTextBrowser(self.centralwidget) self.textBrowser.setGeometry(QtCore.QRect(562, 480, 380, 110)) font = QtGui.QFont() font.setFamily(\u0026#34;å¾®è½¯é›…é»‘\u0026#34;) font.setPointSize(10) self.textBrowser.setFont(font) self.textBrowser.setObjectName(\u0026#34;textBrowser\u0026#34;) self.groupBox_2 = QtWidgets.QGroupBox(self.centralwidget) self.groupBox_2.setGeometry(QtCore.QRect(0, 0, 560, 31)) self.groupBox_2.setStyleSheet(\u0026#34;background-color:#55aa7f;\u0026#34;) self.groupBox_2.setTitle(\u0026#34;\u0026#34;) self.groupBox_2.setObjectName(\u0026#34;groupBox_2\u0026#34;) self.label_4 = QtWidgets.QLabel(self.groupBox_2) self.label_4.setGeometry(QtCore.QRect(240, 6, 80, 20)) font = QtGui.QFont() font.setFamily(\u0026#34;å¾®è½¯é›…é»‘\u0026#34;) font.setPointSize(12) font.setBold(False) font.setWeight(50) self.label_4.setFont(font) self.label_4.setObjectName(\u0026#34;label_4\u0026#34;) self.groupBox_3 = QtWidgets.QGroupBox(self.centralwidget) self.groupBox_3.setGeometry(QtCore.QRect(562, 450, 380, 31)) self.groupBox_3.setStyleSheet(\u0026#34;background-color:#55aa7f;\u0026#34;) self.groupBox_3.setTitle(\u0026#34;\u0026#34;) self.groupBox_3.setObjectName(\u0026#34;groupBox_3\u0026#34;) self.label_7 = QtWidgets.QLabel(self.groupBox_3) self.label_7.setGeometry(QtCore.QRect(160, 3, 80, 20)) font = QtGui.QFont() font.setFamily(\u0026#34;å¾®è½¯é›…é»‘\u0026#34;) font.setPointSize(12) font.setBold(False) font.setWeight(50) self.label_7.setFont(font) self.label_7.setObjectName(\u0026#34;label_7\u0026#34;) MainWindow.setCentralWidget(self.centralwidget) self.menubar = QtWidgets.QMenuBar(MainWindow) self.menubar.setGeometry(QtCore.QRect(0, 0, 944, 23)) self.menubar.setObjectName(\u0026#34;menubar\u0026#34;) self.menu = QtWidgets.QMenu(self.menubar) self.menu.setObjectName(\u0026#34;menu\u0026#34;) MainWindow.setMenuBar(self.menubar) self.statusbar = QtWidgets.QStatusBar(MainWindow) self.statusbar.setObjectName(\u0026#34;statusbar\u0026#34;) MainWindow.setStatusBar(self.statusbar) self.action1 = QtWidgets.QAction(MainWindow) self.action1.setObjectName(\u0026#34;action1\u0026#34;) self.actionhelle1 = QtWidgets.QAction(MainWindow) self.actionhelle1.setCheckable(True) font = QtGui.QFont() font.setFamily(\u0026#34;Microsoft YaHei UI\u0026#34;) font.setPointSize(12) font.setBold(False) font.setWeight(50) font.setStyleStrategy(QtGui.QFont.PreferDefault) self.actionhelle1.setFont(font) self.actionhelle1.setObjectName(\u0026#34;actionhelle1\u0026#34;) self.actionhello2 = QtWidgets.QAction(MainWindow) font = QtGui.QFont() font.setFamily(\u0026#34;Microsoft YaHei UI\u0026#34;) font.setPointSize(11) self.actionhello2.setFont(font) self.actionhello2.setObjectName(\u0026#34;actionhello2\u0026#34;) self.menu.addAction(self.actionhelle1) self.menu.addAction(self.actionhello2) self.menubar.addAction(self.menu.menuAction()) self.retranslateUi(MainWindow) QtCore.QMetaObject.connectSlotsByName(MainWindow) def retranslateUi(self, MainWindow): _translate = QtCore.QCoreApplication.translate MainWindow.setWindowTitle(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;æˆ¿æºæŸ¥è¯¢ï¼ˆèæ˜“æ‹ï¼‰\u0026#34;)) self.export_button.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;å¯¼å‡º\u0026#34;)) self.select_button.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;æœç´¢\u0026#34;)) self.label_6.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;ç¤ºä¾‹ï¼š2020/01/01\u0026#34;)) self.city_name.setItemText(0, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;å…¨éƒ¨\u0026#34;)) self.city_name.setItemText(1, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;ç½—æ¹–\u0026#34;)) self.city_name.setItemText(2, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;ç¦ç”°\u0026#34;)) self.city_name.setItemText(3, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;å—å±±\u0026#34;)) self.city_name.setItemText(4, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;å®å®‰\u0026#34;)) self.city_name.setItemText(5, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;é¾™å²—\u0026#34;)) self.city_name.setItemText(6, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;ç›ç”°\u0026#34;)) self.city_name.setItemText(7, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;é¾™å\u0026#34;)) self.label_2.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;åŒºåŸŸ\u0026#34;)) self.label_5.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;æ—¶é—´\u0026#34;)) self.label.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;çŠ¶æ€\u0026#34;)) self.status_name.setItemText(0, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;å…¨éƒ¨\u0026#34;)) self.status_name.setItemText(1, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;æ­£åœ¨ç«æ‹\u0026#34;)) self.status_name.setItemText(2, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;å³å°†å¼€å§‹\u0026#34;)) self.status_name.setItemText(3, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;æµæ‹\u0026#34;)) self.status_name.setItemText(4, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;æ’¤æ‹\u0026#34;)) self.status_name.setItemText(5, _translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;æˆäº¤\u0026#34;)) self.label_4.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;ç»“æœè¾“å‡º\u0026#34;)) self.label_7.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;æ—¥å¿—è¾“å‡ºæ¡†\u0026#34;)) self.menu.setTitle(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;èœå•\u0026#34;)) self.action1.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;1\u0026#34;)) self.actionhelle1.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;helle1\u0026#34;)) self.actionhello2.setText(_translate(\u0026#34;MainWindow\u0026#34;, \u0026#34;hello2\u0026#34;)) é€»è¾‘å±‚ #!/usr/bin/env python # -*- coding:utf-8 -*- \u0026#34;\u0026#34;\u0026#34; @file: call_pyqt5_demo.py @desc: None @Author: Chenzq @Wechat: 15690833097 @contact: czq181020@gmail.com \u0026#34;\u0026#34;\u0026#34; import PyQt5.sip # å¯¼å…¥ç¨‹åºè¿è¡Œå¿…é¡»æ¨¡å— import sys, os from threading import Thread from time import strftime, localtime, time if hasattr(sys, \u0026#39;frozen\u0026#39;): os.environ[\u0026#39;PATH\u0026#39;] = sys._MEIPASS + \u0026#39;;\u0026#39; + os.environ[\u0026#39;PATH\u0026#39;] # PyQt5ä¸­ä½¿ç”¨çš„åŸºæœ¬æ§ä»¶éƒ½åœ¨PyQt5.QtWidgetsæ¨¡å—ä¸­ from PyQt5.QtWidgets import QApplication, QMainWindow, QDialog, QMessageBox from PyQt5.QtGui import QStandardItemModel, QStandardItem from pandas import DataFrame, ExcelWriter from pymysql import connect # å¯¼å…¥designerå·¥å…·ç”Ÿæˆçš„loginæ¨¡å— from pyqt5_demo import Ui_MainWindow class MyMainForm(QMainWindow, Ui_MainWindow, QDialog): def __init__(self, parent=None): super(MyMainForm, self).__init__(parent) self.setupUi(self) # é“¾æ¥æ•°æ®åº“ self.db = connect( host=\u0026#39;127.0.0.1\u0026#39;, port=3306, user=\u0026#39;root\u0026#39;, passwd=\u0026#39;123456\u0026#39;, db=\u0026#39;dbname\u0026#39;, charset=\u0026#39;utf8\u0026#39; ) self.cursor = self.db.cursor() # æ·»åŠ ç™»å½•æŒ‰é’®ä¿¡å·å’Œæ§½ã€‚æ³¨æ„displayå‡½æ•°ä¸åŠ å°æ‹¬å·() self.select_button.clicked.connect(self.display) # æ·»åŠ é€€å‡ºæŒ‰é’®ä¿¡å·å’Œæ§½ã€‚è°ƒç”¨closeå‡½æ•° self.export_button.clicked.connect(self._export_excel) # ç­›é€‰æˆ¿æºçŠ¶æ€ self.status = \u0026#39;\u0026#39; # åˆ·é€‰æˆ¿æºåŒºåŸŸ self.city = \u0026#39;\u0026#39; # åˆ·é€‰æˆ¿æºæ—¥æœŸ self.date = \u0026#39;\u0026#39; self.datas = [] def display(self): # åˆ©ç”¨line Editæ§ä»¶å¯¹è±¡text()å‡½æ•°è·å–ç•Œé¢è¾“å…¥ # username = self.lineEdit.text() # password = self.lineEdit_2.text() self.status = self.status_name.currentText() self.city = self.city_name.currentText() self.date = self.date_name.text() t = Thread(target=self._select) t.setDaemon(True) t.start() # self._select() def _select(self): # æŸ¥è¯¢ self.export_log(msg=\u0026#39;çŠ¶æ€ï¼š\u0026#39; + self.status + \u0026#39;ï¼Œ\u0026#39; + \u0026#39;åŒºåŸŸï¼š\u0026#39; + self.city + \u0026#39;ï¼Œ\u0026#39; + \u0026#39;æ—¥æœŸï¼š\u0026#39; + self.date) if not self.date: self.date = \u0026#39;0\u0026#39; if not all([self.status, self.city]): self.export_log(\u0026#39;æ—¶é—´ä¸åŒºåŸŸä¸èƒ½ä¸ºç©º?\u0026#39;) v_dict = { \u0026#34;statusName\u0026#34;: repr(self.status), \u0026#34;countyName\u0026#34;: repr(self.city), } if self.status == \u0026#39;å…¨éƒ¨\u0026#39; and self.city == \u0026#39;å…¨éƒ¨\u0026#39;: check_sql = \u0026#34;\u0026#34;\u0026#34; SELECT countyName,statusName,startTime,buildingName,areaSize,currentPrice,startPrice,unitPrice, communityName,bTypeName,taxesName,fzID, jiaofu, biz_tag FROM houselist WHERE startTime LIKE \u0026#39;%{}%\u0026#39; ORDER BY editDate DESC \u0026#34;\u0026#34;\u0026#34;.format(self.date) elif self.status == \u0026#39;å…¨éƒ¨\u0026#39; and self.city != \u0026#39;å…¨éƒ¨\u0026#39;: check_sql = \u0026#34;\u0026#34;\u0026#34; SELECT countyName,statusName,startTime,buildingName,areaSize,currentPrice,startPrice,unitPrice, communityName,bTypeName,taxesName,fzID,jiaofu, biz_tag FROM houselist WHERE countyName={} AND startTime LIKE \u0026#39;%{}%\u0026#39; ORDER BY editDate DESC \u0026#34;\u0026#34;\u0026#34;.format(v_dict.get(\u0026#39;countyName\u0026#39;), self.date) elif self.status != \u0026#39;å…¨éƒ¨\u0026#39; and self.city == \u0026#39;å…¨éƒ¨\u0026#39;: check_sql = \u0026#34;\u0026#34;\u0026#34; SELECT countyName,statusName,startTime,buildingName,areaSize,currentPrice,startPrice,unitPrice, communityName,bTypeName,taxesName,fzID,jiaofu, biz_tag FROM houselist WHERE statusName={} AND startTime LIKE \u0026#39;%{}%\u0026#39; ORDER BY editDate DESC \u0026#34;\u0026#34;\u0026#34;.format(v_dict.get(\u0026#39;statusName\u0026#39;), self.date) elif self.status != \u0026#39;å…¨éƒ¨\u0026#39; and self.city != \u0026#39;å…¨éƒ¨\u0026#39;: check_sql = \u0026#34;\u0026#34;\u0026#34; SELECT countyName,statusName,startTime,buildingName,areaSize,currentPrice,startPrice,unitPrice, communityName,bTypeName,taxesName,fzID,jiaofu, biz_tag FROM houselist WHERE statusName={} AND countyName={} AND startTime LIKE \u0026#39;%{}%\u0026#39; ORDER BY editDate DESC \u0026#34;\u0026#34;\u0026#34;.format(v_dict.get(\u0026#39;statusName\u0026#39;), v_dict.get(\u0026#39;countyName\u0026#39;), self.date) try: self.cursor.execute(check_sql) self.datas = self.cursor.fetchall() except Exception as e: print(e) self.export_log(msg=\u0026#39;è¯·å°è¯•é€€å‡ºé‡å¯?\u0026#39;) else: global data_dict data_dict = { \u0026#34;åŒºåŸŸ\u0026#34;: [], \u0026#34;å¼€å§‹æ—¶é—´\u0026#34;: [], \u0026#34;æ ‡çš„ç‰©\u0026#34;: [], \u0026#34;é¢ç§¯\u0026#34;: [], \u0026#34;ã¡\u0026#34;: [], \u0026#34;èµ·æ‹\u0026#34;: [], \u0026#34;å½“å‰ä»·\u0026#34;: [], \u0026#34;å­¦åŒº\u0026#34;: [], \u0026#34;æ¿å—\u0026#34;: [], \u0026#34;å¸‚åœº\u0026#34;: [], \u0026#34;å¸‚åœºä»·\u0026#34;: [], \u0026#34;æŠ˜æ‰£ç‡\u0026#34;: [], \u0026#34;æ¸…åœºäº¤ä»˜\u0026#34;: [], \u0026#34;å‡ä»·\u0026#34;: [], \u0026#34;URL\u0026#34;: [], # \u0026#34;ç±»å‹\u0026#34;: [], # \u0026#34;çŠ¶æ€\u0026#34;: [], # \u0026#34;è¯„ä¼°ä»·\u0026#34;: [], # \u0026#34;å°åŒº\u0026#34;: [], # \u0026#34;ç¨è´¹\u0026#34;: [], } url = \u0026#34;https://www.51paimaifang.com/detail/{}.html\u0026#34; ali = \u0026#34;https://sf-item.taobao.com/sf_item/{}.htm\u0026#34; jd = \u0026#34;https://paimai.jd.com/{}\u0026#34; self.model = QStandardItemModel(len(self.datas), 3) # è®¾ç½®è¡¨å¤´ self.model.setHorizontalHeaderLabels([\u0026#39;åŒºåŸŸ\u0026#39;, \u0026#39;å°åŒº\u0026#39;, \u0026#39;æ ‡çš„ç‰©\u0026#39;]) for row, data in enumerate(self.datas): data_dict.get(\u0026#39;åŒºåŸŸ\u0026#39;).append(data[0]) data_dict.get(\u0026#39;å¼€å§‹æ—¶é—´\u0026#39;).append(data[2]) data_dict.get(\u0026#39;æ ‡çš„ç‰©\u0026#39;).append(data[3]) data_dict.get(\u0026#39;é¢ç§¯\u0026#39;).append(data[4]) data_dict.get(\u0026#39;ã¡\u0026#39;).append(\u0026#39;ã¡\u0026#39;) data_dict.get(\u0026#39;èµ·æ‹\u0026#39;).append(\u0026#39;èµ·æ‹\u0026#39;) data_dict.get(\u0026#39;å½“å‰ä»·\u0026#39;).append(data[5]) data_dict.get(\u0026#39;å­¦åŒº\u0026#39;).append(\u0026#39; \u0026#39;) data_dict.get(\u0026#39;æ¿å—\u0026#39;).append(data[13]) data_dict.get(\u0026#39;å¸‚åœº\u0026#39;).append(\u0026#39;å¸‚åœº\u0026#39;) data_dict.get(\u0026#39;å¸‚åœºä»·\u0026#39;).append(\u0026#39; \u0026#39;) data_dict.get(\u0026#39;æŠ˜æ‰£ç‡\u0026#39;).append(\u0026#39; \u0026#39;) data_dict.get(\u0026#39;æ¸…åœºäº¤ä»˜\u0026#39;).append(data[12]) data_dict.get(\u0026#39;å‡ä»·\u0026#39;).append(data[7]) fzID = data[11] house_id = fzID[-1] if house_id == \u0026#39;1\u0026#39;: data_dict.get(\u0026#39;URL\u0026#39;).append(ali.format(fzID[:-1])) elif house_id == \u0026#39;2\u0026#39;: data_dict.get(\u0026#39;URL\u0026#39;).append(jd.format(fzID[:-1])) else: data_dict.get(\u0026#39;URL\u0026#39;).append(url.format(data[11])) # data_dict.get(\u0026#39;ç±»å‹\u0026#39;).append(data[9]) # data_dict.get(\u0026#39;çŠ¶æ€\u0026#39;).append(data[1]) # data_dict.get(\u0026#39;è¯„ä¼°ä»·\u0026#39;).append(data[6]) # data_dict.get(\u0026#39;å°åŒº\u0026#39;).append(data[8]) # data_dict.get(\u0026#39;ç¨è´¹\u0026#39;).append(data[10]) for column in range(0, 3): if column == 0: val = data[0] if column == 1: val = data[8] if column == 2: val = data[3] item = QStandardItem(val) # è®¾ç½®æ¯ä¸ªä½ç½®çš„æ–‡æœ¬å€¼ self.model.setItem(row, column, item) # æ°´å¹³æ–¹å‘æ ‡ç­¾æ‹“å±•å‰©ä¸‹çš„çª—å£éƒ¨åˆ†ï¼Œå¡«æ»¡è¡¨æ ¼ self.tableView.horizontalHeader().setStretchLastSection(True) # æ°´å¹³æ–¹å‘ï¼Œè¡¨æ ¼å¤§å°æ‹“å±•åˆ°é€‚å½“çš„å°ºå¯¸ # self.tableView.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch) # å…³è”QTableViewæ§ä»¶å’ŒModel self.tableView.setModel(self.model) self.export_log(\u0026#39;ç»“æœå…±ï¼š\u0026#39; + str(len(self.datas)) + \u0026#39;æ¡\u0026#39;) def _export_excel(self): # å¯¼å‡ºæœç´¢ç»“æœ try: isinstance(data_dict, dict) except NameError as e: self.export_log(msg=\u0026#39;æ— æŸ¥è¯¢ç»“æœ\u0026#39;) else: if data_dict: # urls = data_dict.get(\u0026#39;URL\u0026#39;) # for url in urls: # r = url.rsplit(\u0026#39;/\u0026#39;) # print(r) # try: today_time = strftime(\u0026#39;%Y-%m-%d\u0026#39;, localtime(time())) df1 = DataFrame(data_dict) writer = ExcelWriter(self.city + \u0026#39;\u0026amp;\u0026#39; + self.status + today_time + \u0026#39;.xlsx\u0026#39;) df1.to_excel(writer, sheet_name=\u0026#39;Data1\u0026#39;, startcol=0, index=False) writer.save() self.export_log(msg=\u0026#39;æ–‡ä»¶å \u0026#39; + self.city + \u0026#39;\u0026amp;\u0026#39; + self.status + today_time + \u0026#39;.xlsx\u0026#39;) except PermissionError as e: self.export_log(msg=\u0026#39;è¯·å…³é—­ \u0026#39; + self.city + \u0026#39;\u0026amp;\u0026#39; + self.status + today_time + \u0026#39;.xlsx\u0026#39;) else: self.export_log(msg=\u0026#39;æ— ç»“æœ\u0026#39;) self.export_log(msg=\u0026#39;å¯¼å‡ºå®Œæˆ\u0026#39;) def closeEvent(self, event): \u0026#34;\u0026#34;\u0026#34; é‡å†™closeEventæ–¹æ³•ï¼Œå®ç°dialogçª—ä½“å…³é—­æ—¶æ‰§è¡Œä¸€äº›ä»£ç  :param event: close()è§¦å‘çš„äº‹ä»¶ :return: None \u0026#34;\u0026#34;\u0026#34; reply = QMessageBox.question(self, \u0026#39;å…³é—­ç¨‹åº\u0026#39;, \u0026#34;æ˜¯å¦è¦é€€å‡ºç¨‹åºï¼Ÿ\u0026#34;, QMessageBox.Yes | QMessageBox.No, QMessageBox.No) if reply == QMessageBox.Yes: self.cursor.close() self.db.close() self.export_log(msg=\u0026#39;æ–­å¼€æ•°æ®åº“\u0026#39;) event.accept() else: event.ignore() def export_log(self, msg): # åˆ©ç”¨text Browseræ§ä»¶å¯¹è±¡setText()å‡½æ•°è®¾ç½®ç•Œé¢æ˜¾ç¤º,appendè¿½åŠ è¾“å‡ºæ•°æ® self.textBrowser.append(msg) if __name__ == \u0026#34;__main__\u0026#34;: # å›ºå®šçš„ï¼ŒPyQt5ç¨‹åºéƒ½éœ€è¦QApplicationå¯¹è±¡ã€‚sys.argvæ˜¯å‘½ä»¤è¡Œå‚æ•°åˆ—è¡¨ï¼Œç¡®ä¿ç¨‹åºå¯ä»¥åŒå‡»è¿è¡Œ app = QApplication(sys.argv) # åˆå§‹åŒ– myWin = MyMainForm() # è®¾ç½®çª—å£logoå›¾æ ‡ # myWin.setWindowIcon(QIcon(\u0026#39;fangzi.ico\u0026#39;)) # å°†çª—å£æ§ä»¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Š myWin.show() # ç¨‹åºè¿è¡Œï¼Œsys.exitæ–¹æ³•ç¡®ä¿ç¨‹åºå®Œæ•´é€€å‡ºã€‚ sys.exit(app.exec_()) ç¤ºä¾‹å›¾ ","permalink":"https://www.chenzqi.cn/posts/2019/20190515_pyqt5%E6%A1%8C%E9%9D%A2%E7%A8%8B%E5%BA%8F%E8%AE%B0%E5%BD%95/","tags":["è®°å½•"],"title":"PyQt5æ¡Œé¢ç¨‹åºè®°å½•"},{"categories":[2019,"æŠ€æœ¯"],"contents":"RYPæœ‰é™å…¬å¸ Flask workon flaskvir [root@izwz94gdegum84cnrx9rtoz ~]# cd pythoncode/mysqlinit [root@izwz94gdegum84cnrx9rtoz mysqlinit]# pwd /root/pythoncode/mysqlinit [root@izwz94gdegum84cnrx9rtoz mysqlinit]# ls dump.rdb infos logs manage.py migrations __pycache__ requirements.txt utils [root@izwz94gdegum84cnrx9rtoz mysqlinit]# ps -ef | grep gunicorn root 4319 1 0 Nov18 ? 00:01:39 /root/.env/flaskvir/bin/python3.7 /root/.env/flaskvir/bin/gunicorn -w 20 -b 0.0.0.0:5000 manage:app root 4726 4319 0 Nov18 ? 00:00:21 /root/.env/flaskvir/bin/python3.7 /root/.env/flaskvir/bin/gunicorn -w 20 -b 0.0.0.0:5000 manage:app [root@izwz94gdegum84cnrx9rtoz mysqlinit]# kill PID [root@izwz94gdegum84cnrx9rtoz mysqlinit]# nohup gunicorn -w 20 -b 0.0.0.0:5000 manage:app \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp; å›¾ç‰‡CDN8081 lsof -i:8081 [root@izwz94gdegum84cnrx9rtoz static]# pwd /root/pythoncode/mysqlinit/infos/static [root@izwz94gdegum84cnrx9rtoz static]# ls css dist imgs js pifu.zip xlsx [root@izwz94gdegum84cnrx9rtoz static]# nohup live-server --host=0.0.0.0 --port=8081 \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp; æ³¨å†Œé‚€è¯·é¡µé¢8080 lsof -i:8080 [root@izwz94gdegum84cnrx9rtoz niu]# pwd /root/pythoncode/HTMLshare/niu [root@izwz94gdegum84cnrx9rtoz niu]# ls bak index.html nohup.out static [root@izwz94gdegum84cnrx9rtoz niu]# nohup live-server --host=0.0.0.0 --port=8080 \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp; Redis nohup redis-server \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp; åå°ç®¡ç† nginx é…ç½® proxy_set_header Host $host:$server_port; å¯åŠ¨å‰ç»ˆæ­¢ ps -ef | grep rypsystem kill PID (flask_ryp) [root@iZm5eab8t820b0vmpk5557Z rypadmin]# pwd /root/www/rypadmin (flask_ryp) [root@iZm5eab8t820b0vmpk5557Z rypadmin]# nohup java -jar -Xms2000m -Xmx2000m rypsystem-0.0.1-SNAPSHOT.jar --server.port=8081 \u0026amp; ","permalink":"https://www.chenzqi.cn/posts/2019/20190502_%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%A1%B9%E7%9B%AE%E8%AE%B0%E5%BD%95/","tags":["è®°å½•"],"title":"æœåŠ¡å™¨é¡¹ç›®å‘½ä»¤è®°å½•"},{"categories":[2019,"æŠ€æœ¯"],"contents":":::tip Redisæ­å»ºçˆ¬è™«ä»£ç†IPæ±  ::: # -*- coding: utf-8 -*- \u0026#34;\u0026#34;\u0026#34; @file: proxy.py @desc: çˆ¬è™«IPä»£ç†æ±  @Author: Chenzq @Wechat: 15690833097 @contact: czq181020@gmail.com \u0026#34;\u0026#34;\u0026#34; import json import requests import redis import datetime, time from taobao_sale.settings import (REDIS_HOST, REDIS_PORT, REDIS_PASSWORD, PROXY_POOL_COUNT, PROXY_PULL_COUNT, PROXY_URL) class RedisClient(object): def __init__(self, host=REDIS_HOST, port=REDIS_PORT): if REDIS_PASSWORD: self._db = redis.StrictRedis(host=host, port=port, password=REDIS_PASSWORD) else: # pool = redis.ConnectionPool(host=host, port=port, decode_responses=True) self._db = redis.StrictRedis(host=host, port=port, db=0) def get(self): \u0026#34;\u0026#34;\u0026#34; get proxies from redis self._db.ttl(\u0026#39;http://111.126.76.119:4583\u0026#39;) æŸ¥çœ‹è¿‡æœŸæ—¶é—´ \u0026#34;\u0026#34;\u0026#34; if int(len(self._db.keys())) \u0026lt; PROXY_POOL_COUNT: self.put() # proxie = random.choice(list(self._db.smembers(\u0026#34;proxies\u0026#34;))) proxie = str(self._db.randomkey(), encoding=\u0026#34;utf-8\u0026#34;) return proxie def put(self): \u0026#34;\u0026#34;\u0026#34; add proxy to right top \u0026#34;\u0026#34;\u0026#34; result = requests.get(url=PROXY_URL % (str(PROXY_PULL_COUNT))) rst = json.loads(result.text) datas = rst.get(\u0026#34;data\u0026#34;) if datas: for data in datas: current_time = datetime.datetime.now().strftime(\u0026#34;%Y-%m-%d %H:%M:%S\u0026#34;) expire_time = data.get(\u0026#34;expire_time\u0026#34;) proxie = \u0026#34;http://\u0026#34; + str(data.get(\u0026#39;ip\u0026#39;)) + \u0026#39;:\u0026#39; + str(data.get(\u0026#39;port\u0026#39;)) current_time = int(time.mktime(time.strptime(current_time, \u0026#34;%Y-%m-%d %H:%M:%S\u0026#34;))) expire_time = int(time.mktime(time.strptime(expire_time, \u0026#34;%Y-%m-%d %H:%M:%S\u0026#34;))) expire_time = expire_time - (current_time + 30) # print(\u0026#39;è¿‡æœŸç§’æ•°\u0026#39;, expire_time) # new_proxie_list.append(proxie) self._db.setex(name=proxie, value=1, time=expire_time) print(\u0026#39;add proxies successful\u0026#39;) else: print(\u0026#39;è°ƒç”¨ä»£ç†å¤±è´¥ï¼š\u0026#39;, rst.get(\u0026#34;msg\u0026#34;)) def dele(self, proxie): \u0026#34;\u0026#34;\u0026#34; del proxy from right. \u0026#34;\u0026#34;\u0026#34; dele_rest = self._db.delete(proxie) if dele_rest: print(dele_rest, proxie) pass proxie = self.get() return proxie # @property def queue_len(self): \u0026#34;\u0026#34;\u0026#34; get length from queue. \u0026#34;\u0026#34;\u0026#34; return self._db.scard(\u0026#34;proxies\u0026#34;) def flush(self): \u0026#34;\u0026#34;\u0026#34; flush db \u0026#34;\u0026#34;\u0026#34; self._db.flushall() def tttl(self, proxie): expire_time = self._db.ttl(proxie) return expire_time if __name__ == \u0026#39;__main__\u0026#39;: conn = RedisClient() # conn.get() # outtime = conn.tttl(get) # print(outtime) # conn.dele(get) # conn.flush() ","permalink":"https://www.chenzqi.cn/posts/2019/20190425_redis%E4%BB%A3%E7%90%86ip%E6%B1%A0/","tags":["çˆ¬è™«"],"title":"Redisä»£ç†IPæ± "},{"categories":[2019,"æŠ€æœ¯"],"contents":"æ­¥éª¤ ä½¿ç”¨ Fiddler æŠ“å–å…¬ä¼—å·æ¥å£æ•°æ® ä½¿ç”¨ Python è„šæœ¬è·å–å…¬ä¼—å·æ‰€æœ‰å†å²æ–‡ç« æ•°æ® ä¿å­˜å†å²æ–‡ç«  Fiddler æŠ“åŒ… ä½¿ç”¨å¾®ä¿¡æ¡Œé¢å®¢æˆ·ç«¯ï¼Œæ‰“å¼€æŸä¸ªå…¬ä¼—å·çš„å†å²æ–‡ç« ï¼Œè¿™é‡Œä»¥æˆ‘çš„å…¬ä¼—å·ä¸¾ä¾‹ï¼Œå¦‚ä¸‹å›¾ã€‚ fiddler é…ç½®æ²¡é—®é¢˜ï¼Œèƒ½å¤Ÿçœ‹åˆ°å¦‚ä¸‹å›¾çš„æ•°æ® å›¾ä¸­åŒ…å«æŠ“å–çš„ urlã€ä¸€äº›é‡è¦çš„å‚æ•°å’Œæˆ‘ä»¬æƒ³è¦çš„æ•°æ®ã€‚ è¿™äº›å‚æ•°ä¸­ï¼Œoffset æ§åˆ¶ç€ç¿»é¡µï¼Œå…¶ä»–å‚æ•°åœ¨æ¯ä¸€é¡µä¸­éƒ½æ˜¯å›ºå®šä¸å˜çš„ã€‚ æ¥å£è¿”å›çš„æ•°æ®ç»“æ„å¦‚ä¸‹å›¾ï¼Œå…¶ä¸­ can_msg_continue å­—æ®µæ§åˆ¶ç€èƒ½å¦ç¿»é¡µï¼Œ1 è¡¨ç¤ºè¿˜æœ‰ä¸‹ä¸€é¡µï¼Œ0 è¡¨ç¤ºæ²¡æœ‰å·²ç»æ˜¯æœ€åä¸€é¡µäº†ã€‚ next_offset å­—æ®µå°±æ˜¯ä¸‹ä¸€æ¬¡è¯·æ±‚çš„ offset å‚æ•° æ„é€ è¯·æ±‚ï¼Œè·å–æ•°æ® ä½¿ç”¨ pdfkit å°† æ–‡ç«  url ä¿å­˜ä¸º pdf æ–‡ä»¶ï¼›å¦ä¸€ç§æ˜¯å…ˆä¿å­˜ html æ–‡ä»¶ï¼Œç„¶åå°† html åˆ¶ä½œæˆ chm æ–‡ä»¶ã€‚ä¿å­˜ä¸º pdf æ–‡ä»¶ï¼Œç”¨åˆ°äº† python çš„ç¬¬ä¸‰æ–¹åº“ pdfkit å’Œ wkhtmltopdf å®‰è£…ç¬¬ä¸‰æ–¹å·¥å…·åŒ… å®‰è£… pdfkitï¼š pip install pdfkit å®‰è£… wkhtmltopdf ä¸‹è½½åœ°å€ ç¨‹åº #!/usr/bin/env python # -*- coding:utf-8 -*- import time, json import pdfkit, requests index = 0 can_msg_continue = 1 file_name = \u0026#39;å…¬ä¼—å·PDFæ•°æ®\u0026#39; __biz = \u0026#39;\u0026#39; uin = \u0026#39;\u0026#39; key = \u0026#39;\u0026#39; def parse(): global index print(\u0026#39;ç¬¬ %s é¡µ\u0026#39; % (index)) # urlå‰ç¼€ url = \u0026#34;https://mp.weixin.qq.com/mp/profile_ext\u0026#34; # è¯·æ±‚å¤´ headers = { \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 \u0026#34; \u0026#34;Safari/537.36 MicroMessenger/6.5.2.501 NetType/WIFI WindowsWechat QBCore/3.43.901.400 \u0026#34; \u0026#34;QQBrowser/9.0.2524.400\u0026#34;, } proxies = { \u0026#39;https\u0026#39;: None, \u0026#39;http\u0026#39;: None, } # é‡è¦å‚æ•° param = { \u0026#39;action\u0026#39;: \u0026#39;getmsg\u0026#39;, \u0026#39;__biz\u0026#39;: __biz, \u0026#39;f\u0026#39;: \u0026#39;json\u0026#39;, \u0026#39;offset\u0026#39;: index * 10, \u0026#39;count\u0026#39;: \u0026#39;10\u0026#39;, \u0026#39;is_ok\u0026#39;: \u0026#39;1\u0026#39;, \u0026#39;scene\u0026#39;: \u0026#39;124\u0026#39;, \u0026#39;uin\u0026#39;: uin, \u0026#39;key\u0026#39;: key, \u0026#39;wxtoken\u0026#39;: \u0026#39;\u0026#39;, \u0026#39;x5\u0026#39;: \u0026#39;0\u0026#39;, } # å‘é€è¯·æ±‚ï¼Œè·å–å“åº” response = requests.get(url, headers=headers, params=param, proxies=proxies) response_dict = response.json() next_offset = response_dict[\u0026#39;next_offset\u0026#39;] can_msg_continue = response_dict[\u0026#39;can_msg_continue\u0026#39;] general_msg_list = response_dict[\u0026#39;general_msg_list\u0026#39;] data_list = json.loads(general_msg_list)[\u0026#39;list\u0026#39;] for data in data_list: # æ–‡ç« å‘å¸ƒæ—¶é—´ datetime = data[\u0026#39;comm_msg_info\u0026#39;][\u0026#39;datetime\u0026#39;] date = time.strftime(\u0026#39;%Y-%m-%d\u0026#39;, time.localtime(datetime)) try: msg_info = data.get(\u0026#39;app_msg_ext_info\u0026#39;) msg_list = msg_info.get(\u0026#39;multi_app_msg_item_list\u0026#39;) except Exception as e: print(\u0026#34;ERRMSG:::\u0026#34;, e) else: # æ–‡ç« æ ‡é¢˜ title = msg_info[\u0026#39;title\u0026#39;] # æ–‡ç« é“¾æ¥ url = msg_info[\u0026#39;content_url\u0026#39;] options = { \u0026#39;page-size\u0026#39;: \u0026#39;A4\u0026#39;, \u0026#39;margin-top\u0026#39;: \u0026#39;0mm\u0026#39;, \u0026#39;margin-right\u0026#39;: \u0026#39;0mm\u0026#39;, \u0026#39;margin-bottom\u0026#39;: \u0026#39;0mm\u0026#39;, \u0026#39;margin-left\u0026#39;: \u0026#39;0mm\u0026#39;, # \u0026#39;orientation\u0026#39;:\u0026#39;Landscape\u0026#39;,#æ¨ªå‘ \u0026#39;encoding\u0026#39;: \u0026#34;UTF-8\u0026#34;, \u0026#39;no-outline\u0026#39;: None, # \u0026#39;footer-right\u0026#39;:\u0026#39;[page]\u0026#39; è®¾ç½®é¡µç  } try: # è®¾ç½®wkhtmltopdfçš„è·¯å¾„ config = pdfkit.configuration(wkhtmltopdf=\u0026#39;D:\\\\Program Files\\wkhtmltopdf\\\\bin\\\\wkhtmltopdf.exe\u0026#39;) # è‡ªå·±å®šä¹‰å­˜å‚¨è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ï¼‰ pdfkit.from_url(url, \u0026#39;E:/service/æ•°æ®æ–‡ä»¶/\u0026#39; + file_name + \u0026#39;/\u0026#39; + date + title + \u0026#39;.pdf\u0026#39;, configuration=config) except Exception as e: print(\u0026#39;ERRMSG:::\u0026#39;, e) print(\u0026#34;ä¸æ˜¯å›¾æ–‡æ¶ˆæ¯\u0026#34;) else: print(date + title + \u0026#39;æˆåŠŸ\u0026#39;) # if msg_list: for data in msg_list: title = data[\u0026#39;title\u0026#39;] url = data[\u0026#39;content_url\u0026#39;] try: # è®¾ç½®wkhtmltopdfçš„è·¯å¾„ config = pdfkit.configuration(wkhtmltopdf=\u0026#39;D:\\\\Program Files\\wkhtmltopdf\\\\bin\\\\wkhtmltopdf.exe\u0026#39;) # è‡ªå·±å®šä¹‰å­˜å‚¨è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ï¼‰ pdfkit.from_url(url, \u0026#39;E:/service/æ•°æ®æ–‡ä»¶/\u0026#39; + file_name + \u0026#39;/\u0026#39; + date + title + \u0026#39;.pdf\u0026#39;, configuration=config) except Exception as e: print(\u0026#39;ERRMSG:::\u0026#39;, e) print(\u0026#34;ä¸æ˜¯å›¾æ–‡æ¶ˆæ¯\u0026#34;) else: print(date + title + \u0026#39;æˆåŠŸ\u0026#39;) if can_msg_continue == 1: index += 1 parse() pass else: print(\u0026#39;ç¬¬ %s é¡µçˆ¬å–å®Œæ¯•\u0026#39; % (index)) return False æ•ˆæœ ","permalink":"https://www.chenzqi.cn/posts/2019/20190420_python%E7%88%AC%E5%8F%96%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0/","tags":["çˆ¬è™«"],"title":"çˆ¬å–å¾®ä¿¡å…¬ä¼—å·æ–‡ç« "},{"categories":[2019,"æŠ€æœ¯"],"contents":"::: warning Windowsä¸‹ç¼–è¾‘shellè„šæœ¬ç¼–ç é—®é¢˜ åœ¨windowsä¸‹ç¼–è¾‘çš„æ–‡ä»¶è¿œç¨‹ä¼ é€åˆ°linuxä¸‹çš„æ—¶å€™æ¯è¡Œæœ«å°¾éƒ½ä¼šå‡ºç°^Mï¼Œè¿™å°†å¯¼è‡´shellè„šæœ¬è¿è¡Œé”™è¯¯ï¼Œä¸»è¦æ˜¯å› ä¸ºdosä¸‹çš„ç¼–è¾‘å™¨å’Œlinuxä¸‹çš„ç¼–è¾‘å™¨å¯¹æ–‡ä»¶æœ«è¡Œçš„å›è½¦ç¬¦å¤„ç†ä¸ä¸€è‡´å¯¼è‡´ã€‚ ::: è§£å†³æ–¹æ¡ˆ ç¬¬ä¸€ç§ sed -i 's/\\r//' filename.sh ç¬¬äºŒç§ vim filename.sh å‘½ä»¤æ¨¡å¼ä¸‹ set ff å¦‚æœè¾“å‡º fileformat=dos åœ¨å‘½ä»¤æ¨¡å¼ä¸‹ set ff=unix ","permalink":"https://www.chenzqi.cn/posts/2019/20190406_windows%E4%B8%8B%E7%BC%96%E8%BE%91shell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/","tags":["é—®é¢˜"],"title":"Windowsä¸‹ç¼–è¾‘shellè„šæœ¬ç¼–ç é—®é¢˜"},{"categories":[2019,"æŠ€æœ¯"],"contents":"pipelines.py class MysqlPipeline(): def __init__(self, host, database, user, password, port): self.host = host self.database = database self.user = user self.password = password self.port = port @classmethod def from_crawler(cls, crawler): return cls( host=crawler.settings.get(\u0026#39;MYSQL_HOST\u0026#39;), database=crawler.settings.get(\u0026#39;MYSQL_DATABASE\u0026#39;), user=crawler.settings.get(\u0026#39;MYSQL_USER\u0026#39;), password=crawler.settings.get(\u0026#39;MYSQL_PASSWORD\u0026#39;), port=crawler.settings.get(\u0026#39;MYSQL_PORT\u0026#39;), ) def open_spider(self, spider): self.db = pymysql.connect(self.host, self.user, self.password, self.database, charset=\u0026#39;utf8\u0026#39;, port=self.port) self.cursor = self.db.cursor() def close_spider(self, spider): self.db.close() def process_item(self, item, spider): data = dict(item) # data[\u0026#39;imgs\u0026#39;] = data[\u0026#39;image_paths\u0026#39;][0] # del data[\u0026#39;image_paths\u0026#39;] com_id = data.get(\u0026#39;com_id\u0026#39;) agg_time = data.get(\u0026#39;agg_time\u0026#39;) check_sql = \u0026#34;SELECT com_id FROM itjuzi WHERE com_id={} AND agg_time={}\u0026#34;.format(com_id, repr(agg_time)) count = self.cursor.execute(check_sql) if count: print(\u0026#34;*\u0026#34; * 20, \u0026#34;{} {} å·²å­˜åœ¨\u0026#34;.format(com_id, data.get(\u0026#39;name\u0026#39;))) else: keys = \u0026#39;, \u0026#39;.join(data.keys()) values = \u0026#39;, \u0026#39;.join([\u0026#39;%s\u0026#39;] * len(data)) sql = \u0026#39;INSERT INTO %s (%s) VALUES (%s)\u0026#39; % (\u0026#39;itjuzi\u0026#39;, keys, values) value = tuple([v for v in data.values()]) self.cursor.execute(sql, value) self.db.commit() print(\u0026#34;#\u0026#34; * 20, \u0026#34;{} {} å‚¨å­˜æˆåŠŸ\u0026#34;.format(com_id, data.get(\u0026#39;name\u0026#39;))) return item ","permalink":"https://www.chenzqi.cn/posts/2019/20190401_scrapy-process_item%E6%96%B9%E6%B3%95%E5%86%99%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%B0%E5%BD%95/","tags":["æ¡†æ¶"],"title":"Scrapy process_itemæ–¹æ³•å†™å…¥æ•°æ®åº“è®°å½•"},{"categories":[2019,"æŠ€æœ¯"],"contents":":::tip Flaskè‡ªå®šä¹‰å…¨å±€å“åº”ç±» ::: apiçš„è®¾è®¡ä¸­, æ— è®ºå¼‚å¸¸è¿˜æ˜¯æ­£å¸¸æ•°æ®å‡éœ€è¦æœåŠ¡å™¨ä»¥jsonçš„æ ¼å¼è¿”å›, ä¸ºäº†å¯¹å¼‚å¸¸çš„ç»Ÿä¸€ç®¡ç†, åŒæ—¶ä¸ºäº†åç»­æ›´åŠ æ–¹ä¾¿çš„è¿”å›å’ŒéªŒè¯æ•°æ®, è‡ªå®šä¹‰å¼‚å¸¸è¿”å›ç±». è®¾è®¡å¼‚å¸¸æ•°æ®çš„è¿”å›æ ¼å¼ä¸º: { \u0026#34;error_code\u0026#34;: 999, \u0026#34;msg\u0026#34;: \u0026#34;sorry, we make a mistake\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;POST /v1/client/register\u0026#34; } é‡å†™å¼‚å¸¸ç±» å®šä¹‰ä¸€ä¸ªæœ€åŸºæœ¬çš„ç±», ä¾›å…¶å®ƒç±»ç»§æ‰¿, å–åä¸ºAPIExceptionç»§æ‰¿HTTPException. è¿™ä¸ªåŠŸèƒ½å–ä¸€ä¸ªå•ç‹¬æ–‡ä»¶å­˜æ”¾ï¼Œæ–¹ä¾¿è°ƒç”¨ è¿”å›ç‰¹å®šçš„bodyä¿¡æ¯, éœ€è¦é‡å†™get_body æŒ‡å®šè¿”å›ç±»å‹, éœ€è¦é‡å†™get_headers æ¥æ”¶è‡ªå®šä¹‰çš„å‚æ•°, é‡å†™äº†__init__ åŒæ—¶å®šä¹‰äº†ç±»å˜é‡ä½œä¸ºå‡ ä¸ªé»˜è®¤å‚æ•°(code çŠ¶æ€ç ï¼Œerror_code è‡ªå®šä¹‰é”™è¯¯ç ï¼Œmsg æè¿°ä¿¡æ¯) from flask import request, json from werkzeug.exceptions import HTTPException \u0026#34;\u0026#34;\u0026#34; HTTPException: æ‰€æœ‰HTTPå¼‚å¸¸çš„åŸºç±»ã€‚å¯ä»¥å°†æ­¤å¼‚å¸¸ç§°ä¸ºWSGIåº”ç”¨ç¨‹åºï¼Œ ä»¥å‘ˆç°é»˜è®¤é”™è¯¯é¡µé¢ï¼Œæˆ–è€…æ‚¨å¯ä»¥ç‹¬ç«‹æ•è·å…¶å­ç±»å¹¶å‘ˆç°æ›´å¥½çš„é”™è¯¯æ¶ˆæ¯ã€‚ \u0026#34;\u0026#34;\u0026#34; class APIException(HTTPException): code = 500 msg = \u0026#39;sorry, we made a mistake (*ï¿£ï¸¶ï¿£)!\u0026#39; error_code = 999 def __init__(self, msg=None, code=None, error_code=None, headers=None): if code: self.code = code if error_code: self.error_code = error_code if msg: self.msg = msg super(APIException, self).__init__(msg, None) def get_body(self, environ=None): body = dict( msg=self.msg, error_code=self.error_code, request=request.method + \u0026#39; \u0026#39; + self.get_url_no_param() ) text = json.dumps(body) return text def get_headers(self, environ=None): \u0026#34;\u0026#34;\u0026#34;Get a list of headers.\u0026#34;\u0026#34;\u0026#34; return [(\u0026#39;Content-Type\u0026#39;, \u0026#39;application/json\u0026#39;)] # è·å–è®¿é—®è·¯ç”±ï¼Œåˆ é™¤å‚æ•° @staticmethod def get_url_no_param(): full_path = str(request.full_path) main_path = full_path.split(\u0026#39;?\u0026#39;) return main_path[0] è‡ªå®šä¹‰çŠ¶æ€ç±» from application.libs.error import APIException class Success(APIException): code = 201 msg = \u0026#39;ok\u0026#39; error_code = 0 class DeleteSuccess(Success): code = 202 error_code = -1 class ServerError(APIException): code = 500 msg = \u0026#39;sorry, we made a mistake (*ï¿£ï¸¶ï¿£)!\u0026#39; error_code = 999 class ClientTypeError(APIException): # 400 401 403 404 # 500 # 200 201 204 # 301 302 code = 400 msg = \u0026#39;client is invalid\u0026#39; error_code = 1006 class ParameterException(APIException): code = 400 msg = \u0026#39;invalid parameter\u0026#39; error_code = 1000 class NotFound(APIException): code = 404 msg = \u0026#39;the resource are not found O__O...\u0026#39; error_code = 1001 class AuthFailed(APIException): code = 401 error_code = 1005 msg = \u0026#39;authorization failed\u0026#39; class Forbidden(APIException): code = 403 error_code = 1004 msg = \u0026#39;forbidden, not in scope\u0026#39; class DuplicateGift(APIException): code = 400 error_code = 2001 msg = \u0026#39;the current book has already in gift\u0026#39; ","permalink":"https://www.chenzqi.cn/posts/2019/20190315_flask%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/","tags":["æ¡†æ¶"],"title":"Flaskå…¨å±€å¼‚å¸¸å¤„ç†"},{"categories":[2019,"æŠ€æœ¯"],"contents":":::tip Flaské‡å†™æ¨¡å‹åºåˆ—åŒ– ::: ä½¿ç”¨è¿‡çš„åºåˆ—åŒ–æ–¹å¼ åœ¨æ¨¡å‹å®šä¹‰çš„æ—¶å€™ç»™åºåˆ—åŒ–çš„æ–¹æ³• ç»§æ‰¿ flask é‡Œé¢çš„ JSONEncoderç±»ä»¥åŠdefaultæ–¹æ³• è‡ªå®šä¹‰åºåˆ—åŒ–æ–¹æ³• æ¨¡å‹å®šä¹‰ class User(BaseModel, UserMixin): __tablename__ = \u0026#39;user\u0026#39; id = db.Column(db.Integer, primary_key=True, autoincrement=True, unique=True) nickname = db.Column(db.String(100)) mobile = db.Column(db.String(20), nullable=False) email = db.Column(db.String(100)) sex = db.Column(db.Integer) password_hash = db.Column(db.String(128), nullable=False) status = db.Column(db.Integer) roles = db.relationship(\u0026#39;Role\u0026#39;, secondary=\u0026#39;roles_users\u0026#39;, backref=db.backref(\u0026#39;users\u0026#39;, lazy=\u0026#39;dynamic\u0026#39;)) # è‡ªå®šä¹‰æ¨¡å‹åºåˆ—åŒ– user.test_schema() def test_schema(self): return { \u0026#39;id\u0026#39;: self.id, \u0026#39;nickname\u0026#39;: self.nickname, \u0026#39;mobile\u0026#39;: self.mobile, \u0026#34;creat_time\u0026#34;: str(self.create_time) } viewä½¿ç”¨ class UserView(Resource): def __init__(self): self.reqparse = reqparse.RequestParser() def get(self, id): user = User.query.filter_by(id=id).first() # è°ƒç”¨å®šä¹‰æ–¹æ³• data = user.test_schema() return jsonify(data) é‡å†™JSONEncoder åœ¨è°ƒç”¨json.dumps()æ–¹æ³•æ—¶é»˜è®¤ä¼šä½¿ç”¨JSONEncoderè¿›è¡Œåºåˆ—åŒ–ï¼Œä¼ å…¥clså‚æ•°åå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„åºåˆ—åŒ–æ–¹æ³•ï¼Œæºç è§£æ def dumps(obj, *, skipkeys=False, ensure_ascii=True, check_circular=True, allow_nan=True, cls=None, indent=None, separators=None, default=None, sort_keys=False, **kw): # clså‚æ•°çš„ä½¿ç”¨ä»‹ç» \u0026#34;\u0026#34;\u0026#34; To use a custom ``JSONEncoder`` subclass (e.g. one that overrides the ``.default()`` method to serialize additional types), specify it with the ``cls`` kwarg; otherwise ``JSONEncoder`` is used. å¦‚æœè¦ä½¿ç”¨è‡ªå®šä¹‰çš„â€œJSONEncoderâ€å­ç±» ï¼ˆä¾‹å¦‚ï¼Œé‡å†™ default() æ–¹æ³•æ¥åºåˆ—åŒ–å…¶ä»–ç±»å‹çš„æ•°æ®ï¼‰ï¼Œ è¯·ä½¿ç”¨ä½¿ç”¨â€œclsâ€å…³é”®å­—å‚æ•°ï¼›å¦åˆ™é»˜è®¤ä½¿ç”¨â€œJSONEncoderâ€ã€‚ \u0026#34;\u0026#34;\u0026#34; # éƒ¨åˆ†æºç ï¼šä¼ å…¥äº† cls ï¼Œå°±ä¼šæŒ‰ç…§é‡å†™çš„æ–¹æ³•æ‰§è¡Œ if cls is None: cls = JSONEncoder return cls( skipkeys=skipkeys, ensure_ascii=ensure_ascii, check_circular=check_circular, allow_nan=allow_nan, indent=indent, separators=separators, default=default, sort_keys=sort_keys, **kw).encode(obj) åŸæœ‰JSONEncoderçš„default()æ–¹æ³•æ˜¯ä¸èƒ½å¤Ÿå¯¹å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼Œéœ€è¦é‡å†™default()æ–¹æ³•ï¼Œç„¶ååœ¨è°ƒç”¨json.dumps()æ—¶é€šè¿‡clså‚æ•°ä¼ è¿›å» æ¨¡å‹å®šä¹‰ éœ€è¦åœ¨Userç±»ä¸­å®šä¹‰keyså’Œgetitemæ–¹æ³•ï¼Œç„¶ååœ¨defaultå‡½æ•°ä¸­ä½¿ç”¨dict()å‡½æ•°ã€‚ åŸºæœ¬ä¸Šæ¯ä¸€ä¸ªæ¨¡å‹ç±»éƒ½è¦è¿›è¡Œåºåˆ—åŒ–ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªæ¨¡å‹ç±»é‡Œéƒ½è¦å†™ keysã€__getitem__æ–¹æ³•ã€‚æŠŠä¸€äº›å…¬å…±çš„æ–¹æ³•æå–åˆ°åŸºç±»BaseModelé‡Œé¢å» class BaseModel(db.Model): __abstract__ = True create_time = db.Column(db.DateTime, default=datetime.now) update_time = db.Column(db.DateTime, default=datetime.now, onupdate=datetime.now) def __getitem__(self, item): return getattr(self, item) def keys(self): return self.fields # æ”¯æŒéšè—å­—æ®µ def hide(self, *keys): for key in keys: self.fields.remove(key) return self # æ”¯æŒæ·»åŠ å­—æ®µ def append(self, *keys): for key in keys: self.fields.append(key) return self class User(BaseModel, UserMixin): __tablename__ = \u0026#39;user\u0026#39; id = db.Column(db.Integer, primary_key=True, autoincrement=True, unique=True) nickname = db.Column(db.String(100)) mobile = db.Column(db.String(20), nullable=False) email = db.Column(db.String(100)) sex = db.Column(db.Integer) password_hash = db.Column(db.String(128), nullable=False) status = db.Column(db.Integer) roles = db.relationship(\u0026#39;Role\u0026#39;, secondary=\u0026#39;roles_users\u0026#39;, backref=db.backref(\u0026#39;users\u0026#39;, lazy=\u0026#39;dynamic\u0026#39;)) # SQLALChemyçš„å®ä¾‹åŒ–æ˜¯ä¸ä¼šè°ƒç”¨__init__å‡½æ•°ï¼Œè¦æƒ³è°ƒç”¨éœ€è¦ # from sqlalchemy import orm # @orm.reconstructorè¿™ä¸ªè£…é¥°å™¨ @orm.reconstructor def __init__(self): self.fields = [\u0026#39;id\u0026#39;, \u0026#39;nickname\u0026#39;, \u0026#39;mobile\u0026#39;, \u0026#39;create_time\u0026#39;] é‡å†™JSONEncoder o å¯¹è±¡ from datetime import date from flask import Flask as _Flask, current_app from flask.json import JSONEncoder as _JSONEncoder from application.libs.error_code import ServerError class JSONEncoder(_JSONEncoder): def default(self, o): # åˆ¤æ–­ï¼Œå¦‚æœå¯¹è±¡æ²¡æœ‰è¿™ä¸¤ä¸ªæ–¹æ³•çš„è¯å°±è¿”å› ServerErrorè¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ if hasattr(o, \u0026#39;keys\u0026#39;) and hasattr(o, \u0026#39;__getitem__\u0026#39;): return dict(o) # å…¼å®¹å…¶ä»–çš„åºåˆ—åŒ– if isinstance(o, date): return o.strftime(\u0026#39;%Y-%m-%d %H:%S\u0026#39;) # è‡ªå®šä¹‰ raise ServerError() # ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„ JSONEncoder æ›¿ä»£ Flask åŸæœ‰çš„ JSONEncoder class Flask(_Flask): json_encoder = JSONEncoder ","permalink":"https://www.chenzqi.cn/posts/2019/20190302_flask%E6%A8%A1%E5%9E%8B%E5%BA%8F%E5%88%97%E5%8C%96/","tags":["æ¡†æ¶"],"title":"Flaskæ¨¡å‹åºåˆ—åŒ–"},{"categories":[2019,"æŠ€æœ¯"],"contents":"æŠŠæ—¥å¿—ç›¸å…³çš„é…ç½®å°è£…æˆä¸€ä¸ªæ—¥å¿—åˆå§‹åŒ–å‡½æ•° import logging from logging.handlers import RotatingFileHandler ...... def setup_log(config_name): dir_file = os.path.abspath(__file__) dir_info = os.path.dirname(dir_file) dir_base = os.path.dirname(dir_info) dir_log = os.path.join(dir_base, \u0026#39;logs/log\u0026#39;) # è®¾ç½®æ—¥å¿—çš„è®°å½•ç­‰çº§ logging.basicConfig(level=config_dict[config_name].LOG_LEVEL) # è°ƒè¯•debugçº§ # åˆ›å»ºæ—¥å¿—è®°å½•å™¨ï¼ŒæŒ‡æ˜æ—¥å¿—ä¿å­˜çš„è·¯å¾„ã€æ¯ä¸ªæ—¥å¿—æ–‡ä»¶çš„æœ€å¤§å¤§å°ã€ä¿å­˜çš„æ—¥å¿—æ–‡ä»¶ä¸ªæ•°ä¸Šé™ file_log_handler = RotatingFileHandler(dir_log, maxBytes=1024 * 1024 * 100, backupCount=10) # åˆ›å»ºæ—¥å¿—è®°å½•çš„æ ¼å¼ æ—¥å¿—ç­‰çº§ è¾“å…¥æ—¥å¿—ä¿¡æ¯çš„æ–‡ä»¶å è¡Œæ•° æ—¥å¿—ä¿¡æ¯ formatter = logging.Formatter(\u0026#39;%(levelname)s %(filename)s:%(lineno)d %(message)s\u0026#39;) # ä¸ºåˆšåˆ›å»ºçš„æ—¥å¿—è®°å½•å™¨è®¾ç½®æ—¥å¿—è®°å½•æ ¼å¼ file_log_handler.setFormatter(formatter) # ä¸ºå…¨å±€çš„æ—¥å¿—å·¥å…·å¯¹è±¡ï¼ˆflaskappä½¿ç”¨çš„ï¼‰æ·»åŠ æ—¥å¿—è®°å½•å™¨ logging.getLogger().addHandler(file_log_handler) def create_app(config_str): app = Flask(__name__) app.config.from_object(config_dict.get(config_str)) # å¯ç”¨æ—¥å¿—åŠŸèƒ½ setup_log(config_str) db.init_app(app) Session(app) return app æ‰‹åŠ¨åˆ›å»ºlogsæ–‡ä»¶å¤¹ ","permalink":"https://www.chenzqi.cn/posts/2019/20190220_flask%E9%85%8D%E7%BD%AE%E9%A1%B9%E7%9B%AE%E6%97%A5%E5%BF%97/","tags":["æ¡†æ¶"],"title":"Flaské…ç½®é¡¹ç›®æ—¥å¿—"},{"categories":[2019,"æŠ€æœ¯"],"contents":"å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°çš„é¡¹ç›®ç»“æ„ç¤ºä¾‹ åˆ›å»ºshellè„šæœ¬ ä½¿ç”¨ shell è„šæœ¬å¿«é€Ÿç”Ÿæˆé¡¹ç›®åŸºç¡€éª¨æ¶ è„šæœ¬æ–‡ä»¶ä¸‹è½½ æå–ç ï¼šxjxe å°†ä¸‹é¢çš„è„šæœ¬ä¿å­˜ä¸ºæ–‡ä»¶ generate_flask_boilerplate.sh # !/bin/bash dirname=$1 if [ ! -d \u0026#34;$dirname\u0026#34; ] then mkdir ./$dirname \u0026amp;\u0026amp; cd $dirname mkdir ./application mkdir -p ./application/{controllers,models,static,static/css,static/js,templates} touch {manage.py,requirements.txt} touch ./application/{__init__.py,app.py,configs.py,extensions.py} touch ./application/{controllers/__init__.py,models/__init__.py} touch ./application/{static/css/style.css,templates/404.html,templates/base.html} echo \u0026#34;File created\u0026#34; else echo \u0026#34;File exists\u0026#34; fi ç”Ÿæˆé¡¹ç›®éª¨æ¶ Linux sh generate_flask_boilerplate.sh flask-demo Windows æ–°å»ºé¡¹ç›®ç›®å½•flask-demoå¹¶è¿›å…¥ åŒå‡»shellè„šæœ¬æ–‡ä»¶ ç»“æ„ç¤ºä¾‹ flask-demo\râ”œâ”€â”€ application\râ”‚ â”œâ”€â”€ __init__.py\râ”‚ â”œâ”€â”€ app.py\râ”‚ â”œâ”€â”€ configs.py\râ”‚ â”œâ”€â”€ controllers\râ”‚ â”‚ â”œâ”€â”€ __init__.py\râ”‚ â”œâ”€â”€ extensions.py\râ”‚ â”œâ”€â”€ models\râ”‚ â”‚ â”œâ”€â”€ __init__.py\râ”‚ â”œâ”€â”€ static\râ”‚ â”‚ â”œâ”€â”€ css\râ”‚ â”‚ â”‚ â””â”€â”€ style.css\râ”‚ â”‚ â””â”€â”€ js\râ”‚ â””â”€â”€ templates\râ”‚ â”œâ”€â”€ 404.html\râ”‚ â”œâ”€â”€ base.html\râ”œâ”€â”€ manage.py\râ”œâ”€â”€ requirements.txt éª¨æ¶åŒ…å«ä¸‰ä¸ªé¡¶çº§æ–‡ä»¶(å¤¹)ï¼šapplication ç›®å½•ã€manage.py æ–‡ä»¶å’Œ requirements.txt æ–‡ä»¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯èƒ½è¿˜éœ€è¦ä¸€ä¸ª tests ç›®å½•ã€‚ application Flask ç¨‹åºï¼ŒåŒ…å«ä¸šåŠ¡é€»è¾‘ä»£ç ã€æ•°æ®æ¨¡å‹å’Œé™æ€æ–‡ä»¶ç­‰ configs.py é¡¹ç›®é…ç½® models æ•°æ®æ¨¡å‹æ–‡ä»¶ templates æ¨¡æ¿æ–‡ä»¶ static å­˜æ”¾é™æ€æ–‡ä»¶ï¼Œå¦‚ jsã€css ç­‰æ–‡ä»¶ manage.py å¯åŠ¨ Web ç¨‹åºä»¥åŠå…¶ä»–çš„ç¨‹åºä»»åŠ¡ requirements.txt é¡¹ç›®çš„å®‰è£…ä¾èµ–åŒ… ","permalink":"https://www.chenzqi.cn/posts/2019/20190210_flask%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80%E9%AA%A8%E6%9E%B6/","tags":["æ¡†æ¶"],"title":"Flaské¡¹ç›®ç»“æ„åŸºç¡€éª¨æ¶"},{"categories":[2019,"æŠ€æœ¯"],"contents":"è‡ªå®šä¹‰åŠ¨æ€å‚æ•°ç¼“å­˜é”® 1 def make_cache_key(): args = request.args key = request.path + \u0026#39;?\u0026#39; + urllib.parse.urlencode([ (k, v) for k in sorted(args) for v in sorted(args.getlist(k)) ]) return key å¤æ‚ï¼Œå¥½å¤„æ˜¯å³ä½¿è¡¨å•æ•°æ®é¡ºåºæ‰“ä¹±ï¼Œåœ¨è½¬æ¢ä¸ºcache_keyæ—¶ä¹Ÿsorted()è¿‡çš„ï¼Œä¸ä¼šå‡ºç°å†—ä½™cacheçš„æƒ…å†µ 2 def make_cache_key(*args, **kwargs): args = str(hash(frozenset(request.args.items()))) key = str((request.path + args).encode(\u0026#39;utf-8\u0026#39;)) return key ä½¿ç”¨ @cache.cached(timeout=600, key_prefix=make_cache_key) def è·¯ç”±å‡½æ•°ï¼š return jsonify(status=200, msg=\u0026#34;\u0026#34;, data=\u0026#34;\u0026#34;) ","permalink":"https://www.chenzqi.cn/posts/2019/20190205_flask-cache%E7%BC%93%E5%AD%98%E5%8A%A8%E5%8F%82get%E8%AF%B7%E6%B1%82/","tags":["æ¡†æ¶"],"title":"Flask-Cacheç¼“å­˜åŠ¨å‚GETè¯·æ±‚"},{"categories":[2019,"æŠ€æœ¯"],"contents":"ä¸‹è½½æ‰€éœ€JDKåŒ… å®˜ç½‘ä¸‹è½½ JDKåŒ…ä¸‹è½½ï¼š æå–ç ï¼š2knq åˆ›å»ºå­˜æ”¾JDKåŒ…æ–‡ä»¶å¤¹ é€šè¿‡xftpä¸Šä¼ è‡³æœåŠ¡å™¨æŒ‡å®šè·¯å¾„ [root@ ~]# mkdir /usr/local/java [root@ ~]# cd /usr/local/java [root@ ~]# tar -zxvf ... é…ç½®ç¯å¢ƒå˜é‡ [root@ ~]# vim /etc/profile JAVAHOME=/usr/local/java/è§£å‹ååå­— PATH=$PATH:$JAVAHOME/bin:/usr/bin:/usr/sbin:/bin:/sbin CLASSPATH=.:$JAVAHOME/lib/tools.jar:$JAVAHOME/lib/dt.jar export JAVAHOME PATH CLASSPATH ç”Ÿæ•ˆé…ç½® [root@ ~]# source /etc/profile éªŒè¯ [root@ ~]# java -version ","permalink":"https://www.chenzqi.cn/posts/2019/20190120_centos%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEjdk/","tags":["linux"],"title":"CentOSå®‰è£…é…ç½®jdk"},{"categories":[2019,"æŠ€æœ¯"],"contents":"shè„šæœ¬å¼‚å¸¸ï¼š/bin/sh^M:bad interpreter: No such file or directory åˆ†æï¼šè¿™æ˜¯ä¸åŒç³»ç»Ÿç¼–ç æ ¼å¼å¼•èµ·çš„ï¼šåœ¨windowsç³»ç»Ÿä¸­ç¼–è¾‘çš„.shæ–‡ä»¶å¯èƒ½æœ‰ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥åœ¨Linuxç³»ç»Ÿä¸‹æ‰§è¡Œä¼šæŠ¥ä»¥ä¸Šå¼‚å¸¸ä¿¡æ¯ã€‚ é¦–å…ˆè¦ç¡®ä¿æ–‡ä»¶æœ‰å¯æ‰§è¡Œæƒé™ sh\u0026gt;chmod a+x filename ç„¶åä¿®æ”¹æ–‡ä»¶æ ¼å¼ sh\u0026gt;vi filename åˆ©ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶æ ¼å¼ :**set ff **æˆ– :set fileformat å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ fileformat=dos æˆ– fileformat=unix åˆ©ç”¨å¦‚ä¸‹å‘½ä»¤ä¿®æ”¹æ–‡ä»¶æ ¼å¼ :set ff=unix æˆ– :set fileformat=unix :wq (å­˜ç›˜é€€å‡º) æœ€åå†æ‰§è¡Œæ–‡ä»¶ sh\u0026gt;./filename ","permalink":"https://www.chenzqi.cn/posts/2019/20190111_sh%E8%84%9A%E6%9C%AC%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E5%BC%82%E5%B8%B8/","tags":["linux"],"title":"shè„šæœ¬ç¼–ç å¼‚å¸¸ï¼šbinsh^Mbad interpreter No such file or directory"},{"categories":null,"contents":"","permalink":"https://www.chenzqi.cn/search/","tags":null,"title":"ğŸ”æœç´¢"},{"categories":null,"contents":"å¹´è½»çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½æœ‰ä¸€ä¸ªæ¢¦æƒ³ï¼Œé•¿å¤§ä»¥åè¦å¸¦ç€çˆ¶æ¯ç¯æ¸¸ä¸–ç•Œã€‚ ä½†æ˜¯ç­‰æˆ‘ä»¬çœŸæ­£æˆå¹´æˆ–è€…å¨¶å¦»ç”Ÿå­äº†ï¼Œå´æ€»æ˜¯å¿˜äº†å’Œçˆ¶æ¯è”ç³»ã€‚ ä¸è®°å¾—ä»–ä»¬çš„ç”Ÿæ—¥ï¼Œä¹Ÿä¸å…³å¿ƒä»–ä»¬çš„èº«ä½“ï¼Œå³ä½¿æœ‰æ—¶å€™å›å®¶å’Œä»–ä»¬ååœ¨ä¸€èµ·ï¼Œä¹Ÿæ€»æ˜¯æ„Ÿè§‰å’Œä»–ä»¬èŠä¸åˆ°ä¸€å—ã€‚ æˆ‘ä»¬å¼€å§‹å«Œå¼ƒä»–ä»¬å” å¨ã€ä¸çˆ±å«ç”Ÿã€çˆ±è´ªå°ä¾¿å®œã€ç®¡å¾—å¤ªå¤šâ€¦â€¦æƒ³å’Œä»–ä»¬ä¿æŒè·ç¦»ã€‚ æˆå¹´æˆ–è€…æ˜¯ç‹¬ç«‹ä»¥åï¼Œä¸è¦è¯´å¸¦çˆ¶æ¯å»ç¯æ¸¸ä¸–ç•Œäº†ï¼Œå°±è¿ä»–ä»¬ç”Ÿç—…æˆ–è€…ç¦»å¼€äººä¸–çš„æ—¶å€™ï¼Œ ä¹Ÿè®¸æˆ‘ä»¬éƒ½æ²¡æœ‰é™ªä»–ä»¬å»åŒ»é™¢æˆ–è€…æ˜¯ç•™åœ¨ä»–ä»¬çš„èº«è¾¹ã€‚ æ›¾ç»åœ¨ç½‘ä¸Šçœ‹åˆ°è¿‡ä¸€ä¸ªè§†é¢‘ï¼Œä¸€ä¸ªè€æ¯äº²å› ä¸ºä¸‰ä¸ªå„¿å­ä»æœªå›å®¶æ¢æœ›è¿‡å¥¹ï¼Œä¾¿æŠŠè‡ªå·±çš„ä¸‰ä¸ªå„¿å­å‘Šä¸Šäº†æ³•é™¢ï¼Œè¦æ±‚ä»–ä»¬æ”¯ä»˜ä¹ä¸ªæœˆçš„â€œæˆ¿è´¹â€ã€‚ è¿™ä¸ªè€æ¯äº²å…¶å®å¹¶ä¸å·®é’±ï¼Œå¥¹ä¹‹æ‰€ä»¥è¿™ä¹ˆåšï¼Œæ— éå°±æ˜¯æƒ³æé†’è‡ªå·±çš„å­©å­ä»¬è®°å¾—å¸¸å›å®¶çœ‹çœ‹ï¼Œä¸è¦å¿˜äº†å¥¹ã€‚ ç”Ÿå„¿è‚²å¥³ï¼Œçˆ¶æ¯è¦çš„å…¶å®å¹¶ä¸å¤šï¼Œä»–ä»¬åªæ˜¯å¸Œæœ›åœ¨å‚æš®ä¹‹å¹´æœ‰å„¿å¥³ä»¬çš„æƒ¦å¿µæˆ–è€…æ˜¯é™ªä¼´ï¼Œè¶³çŸ£ã€‚ â€œçˆ¶æ¯åœ¨ï¼Œäººç”Ÿå°šæœ‰æ¥å¤„ï¼›çˆ¶æ¯å»ï¼Œäººç”Ÿåªå‰©å½’é€”ã€‚â€ æœ‰ç€æœªæ¥æƒ³å¸¦çˆ¶æ¯è¿œæ¸¸çš„å¿ƒï¼Œä¸å¦‚å…ˆè¯•ç€å¤šç»™çˆ¶æ¯æ‰“å‡ æ¬¡ç”µè¯ã€‚å¬å¬ä»–ä»¬å” å” å®¶å¸¸ï¼Œè®²è®²è‡ªå·±æœ€è¿‘çš„ç”Ÿæ´»è¿‡å¾—æ€ä¹ˆæ ·ã€‚ ä¸å…¶ç»™æœªæ¥è®¸ä¸‹é™ªä¼´çš„æ¢¦æƒ³ï¼Œä¸å¦‚çæƒœå½“ä¸‹çš„å¹¸ç¦æ—¶å…‰ã€‚ ä¸€å‘³åœ°è§‚æœ›ä¸ç­‰å¾…ï¼Œåªä¼šæ˜¯è™šæ— ä¸­çš„ç²¾å½©ã€‚æœ‹å‹ä¸ç­‰ä½ ï¼Œçˆ±äººä¸ç­‰ä½ ï¼Œçˆ¶æ¯ä¸ç­‰ä½ ï¼Œå­©å­ä¸ç­‰ä½ ï¼Œå³ä½¿æœ‰äº›ä¸œè¥¿åœ¨ç­‰ä½ ï¼Œå¯æ˜¯å…‰é˜´ä¸ç­‰ä½ ã€‚ å½“ä½ å¤±å»äº†ï¼Œåæ‚”äº†ï¼Œè¿˜èƒ½åšä»€ä¹ˆï¼Ÿè¿˜èƒ½å»å“ªé‡Œå‘¢ï¼Ÿ ç”Ÿæ´»ä¸­ï¼Œæœ‰å¤ªå¤šçš„äº‹æƒ…æ˜¯æˆ‘ä»¬ä¸èƒ½æ§åˆ¶çš„ã€‚æ˜æ˜çº¦å®šå¥½äº†çš„äº‹æƒ…ï¼Œæœ¬æ¥ä¿¡å¿ƒæ»¡æ»¡åœ°æœŸå¾…ç€å®ƒçš„å‘ç”Ÿï¼Œç»“æœè·¯èµ°åˆ°ä¸€åŠå°±é­é‡å„è¿ï¼Œæ›¾ç»çº¦å®šå¥½çš„äº‹æƒ…å´éš¾ä»¥ç»´æŒä¸‹å»ã€‚ æˆ‘ä»¬çš„å²æœˆä¸é•¿ï¼Œä¸é•¿ï¼Œå®¹ä¸ä¸‹æ…¢æ…¢åœ°å»ç»†æƒ³ã€‚ æ—¶å…‰å¾ˆæ€¥ï¼Œå¾ˆæ€¥ï¼Œä¸è¦ç­‰åˆ°ä¸€åˆ‡æ¥ä¸åŠã€‚ ","permalink":"https://www.chenzqi.cn/about/%E5%85%B3%E4%BA%8E/","tags":null,"title":"å…³äº"},{"categories":null,"contents":"\rğŸ˜º å°ä¼™ä¼´ æå®¢å°ç¥¥çš„åšå®¢\r\"æ°¸è¿œç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿ\"\rSulv\u0026#39;s Blog\r\"ç®€æ´ã€åŠŸèƒ½é½å…¨ã€å¿«é€Ÿã€æœ‰è¥å…»\"\rğŸ“¦ ä¸ªäººé¡¹ç›® CSAdmin\r\"GVAäºŒå¼€é¡¹ç›®-åå°ç®¡ç†\"\rğŸ“š æ”¶è—ç«™ åœ¨çº¿å·¥å…· çˆ¬è™«å·¥å…·é›†\r\"çˆ¬è™«å·¥å…·é›†\"\riLoveIMG\r\"å¯æ‰¹é‡ç¼–è¾‘å›¾ç‰‡çš„æ‰€æœ‰å·¥å…·\"\rOSCHINA\r\"åœ¨çº¿å·¥å…·å¤§å…¨\"\rå‰ç«¯ å›¾æ ‡å·¥å‚\r\"ç§»åŠ¨åº”ç”¨å›¾æ ‡/å¯åŠ¨å›¾ç”Ÿæˆï¼ŒiOSã€Androidå›¾æ ‡å·¥å…·\"\rFont Awesome\r\"å›¾æ ‡åº“å’Œå·¥å…·åŒ…\"\rEncycolorpedia\r\"RGBé¢œè‰²ä»£ç è¡¨ä¿¡æ¯ï¼Œå›¾æ ‡ï¼Œè°ƒè‰²æ¿\"\r","permalink":"https://www.chenzqi.cn/about/friends/","tags":null,"title":"å‹é“¾å¢™"},{"categories":null,"contents":"éšç€å¿«é—¨ğŸ“¸çš„å¼€å¯ï¼Œæ—¶é—´è¢«å‡å›ºä¸‹æ¥ï¼Œä½œä¸ºâ€æ­¤æ—¶æ­¤åˆ»â€çš„è®°å½•æ˜¯ä¸å¯é‡å¤çš„ï¼Œä¹Ÿå°±æˆä¸ºæ°¸è¿œã€‚ğŸ è¿ªå£«å°¼ è¿ªå£«å°¼ä¹‹æ—… ğŸ¡ğŸ¢ äº¤é€šï¼šğŸš… ğŸš‡ å¤©æ°”ï¼šğŸŒ¦ chatgptï¼šå½“ä½ èµ°è¿›è¿ªå£«å°¼ä¹å›­ï¼Œä½ ä¼šä»¿ä½›è¿›å…¥äº†ä¸€ä¸ªå……æ»¡å¥‡å¹»å’Œæ¢¦æƒ³çš„ä¸–ç•Œã€‚è¿™é‡Œæœ‰æ¬¢å£°ç¬‘è¯­ã€è‰²å½©æ–‘æ–“çš„åœºæ™¯å’Œå¼•äººå…¥èƒœçš„æ¸¸ä¹é¡¹ç›®ï¼Œè®©äººæµè¿å¿˜è¿”ã€‚ åœ¨è¿™é‡Œï¼Œä½ æˆ–è®¸ä¼šçœ‹åˆ°ç«¥è¯æ•…äº‹ä¸­çš„ç»å…¸è§’è‰²ï¼Œåœ¨ç¿»æ»šçš„è¿‡å±±è½¦ä¸Šé¢¤æŠ–ï¼›æˆ–è€…ä½ ä¼šè‡ªå·±å˜æˆç«¥è¯æ•…äº‹ä¸­çš„ä¸»äººå…¬ï¼Œè·Ÿç€éŸ³ä¹å’Œæ²‰æµ¸å¼çš„å‰§åœºè¡¨æ¼”ä¸€åŒèµ·èˆã€‚ åœ¨è¿™é‡Œï¼Œæ—¶é—´ä»¿ä½›å‡å›ºäº†ï¼Œä½ å¯ä»¥å°½æƒ…åœ°é‡Šæ”¾å†…å¿ƒçš„ç«¥å¿ƒï¼Œæ„Ÿå—åˆ°çº¯çœŸå’Œå¿«ä¹çš„æ»‹å‘³ã€‚ä»¿ä½›ä¸€å¥è¯å°±å¯ä»¥æ¦‚æ‹¬ä½ åœ¨è¿ªå£«å°¼ä¹å›­çš„æ—…ç¨‹ï¼Œé‚£å°±æ˜¯ï¼š ç«¥è¯æ•…äº‹åœ¨è¿™é‡ŒæˆçœŸã€‚ \u003c!DOCTYPE html\u003e\rç™¾äº•åŠå··-è¥¿æ¹– ç™¾äº•åŠå··-è¥¿æ¹– ğŸŒ… ğŸŒº äº¤é€šï¼šğŸš‡ ğŸ›µ å¤©æ°”ï¼šğŸŒ¤ chatgptï¼šå½“å¤œå¹•ä½å‚ï¼Œéœå…‰æ˜ çº¢æ¹–é¢ï¼Œä½ ä»¿ä½›ç½®èº«äºä¸€å¹…ç¥ç§˜è¿·äººçš„ç”»å·ä¹‹ä¸­ã€‚è¥¿æ¹–å¤•é˜³ä¸‹çš„ç¾æ™¯ä»¤äººæµè¿å¿˜è¿”ï¼ŒæƒŠè‰³äºæ™šéœçš„çº¢è‰³ã€ æ„Ÿå¹äºæ¾é¼ çš„æœºçµå’Œé¸½å­çš„æ¸©é©¯ã€è¢«é¸³é¸¯çš„æƒ…æ„Ÿæ‰€æ‰“åŠ¨ï¼Œè¢«èŠ±æœµçš„èŠ¬èŠ³æ‰€é™¶é†‰ã€‚è¿™äº›ç’€ç’¨çš„è‡ªç„¶å…ƒç´ ï¼Œèåˆäº†ä¸­å›½ä¼ ç»Ÿæ–‡åŒ–çš„æ„å¢ƒå’ŒéŸµå‘³ï¼Œ åœ¨è¿™é‡Œä¸äººä»¬è‡ªç„¶åœ°èåˆåœ¨ä¸€èµ·ã€‚ä½ æˆ–è®¸ä¼šé‡åˆ°ä¸æµªæ¼«æ‚ é—²çš„çµæ°”å¥³å­é©¾ç€ç”»èˆ«ï¼Œæˆ–æ˜¯è§‚èµä¸€åœºç°ä»£èŠ­è•¾èˆå›¢æ¼”å‡ºçš„å¥‡å¦™æ—¶åˆ»ã€‚ åœ¨è¿™é‡Œï¼Œä½ èƒ½å¤Ÿå°½æƒ…é‡Šæ”¾è‡ªå·±ï¼Œåœ¨è‡ªç„¶ä¹‹ç¾ã€äººæ–‡ä¹‹å…‰ã€ç°ä»£ä¹‹è‰ºäº«å—åˆ°ä¸€ä»½éš¾ä»¥è¨€è¡¨çš„ç¾å¥½ã€‚è¥¿æ¹–æ˜¯èè‡ªç„¶ä¹‹éŸµã€äººæ–‡ä¹‹ç¾ã€ ç°ä»£ä¹‹è‰ºäºä¸€ä½“çš„æ—…æ¸¸èƒœåœ°ï¼Œä¸€æ—¦æ¥è¿‡ï¼Œå°±æ°¸è¿œä¸ä¼šå¿˜è®°è¿™é‡Œçš„ç¾ä¸½ã€‚ \u003c!DOCTYPE html\u003e\rçŒ«ç‹—æ—¥è®° ä¸ƒä¸ƒå’Œåˆåˆ ğŸˆ ğŸ¦® \u003c!DOCTYPE html\u003e\r","permalink":"https://www.chenzqi.cn/about/photo/","tags":null,"title":"ç›¸å†Œ"}]